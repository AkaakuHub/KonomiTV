import{d as M,U as w,P as $,m as H,M as C,u as T,_ as I,r as c,a as A,o,c as d,b as h,e,n as p,f as b,F as m,g as v,w as g,h as f,i as r,t as l,V as L,j as S,k as B,R as y,l as V,p as z,q as N}from"./index-hBZ8inMP.js";import{S as j,a as O}from"./swiper-JEPJ1OD9.js";import{H as R,N as Z}from"./Navigation-A0JyTs5H.js";import{C as q,u as X}from"./ChannelsStore-xVKv7UOc.js";import{V as G}from"./ssrBoot-IgmCGTYb.js";const J=M({name:"TV-Home",components:{HeaderBar:R,Navigation:Z,Swiper:j,SwiperSlide:O},data(){return{Utils:Object.freeze(w),ChannelUtils:Object.freeze(q),ProgramUtils:Object.freeze($),active_tab_index:0,swiper_instance:null,is_loading:!0,interval_ids:[]}},computed:{...H(X,T)},watch:{active_tab_index(){var t,n;(t=this.swiper_instance)==null||t.updateAutoHeight(),(n=this.swiper_instance)==null||n.slideTo(this.active_tab_index,this.is_loading===!0?0:void 0)}},async mounted(){var n,_;this.settingsStore.settings.pinned_channel_ids.length===0&&(this.active_tab_index=1);const t=60-new Date().getSeconds();this.interval_ids.push(window.setTimeout(()=>{this.channelsStore.update(!0),this.interval_ids.push(window.setInterval(()=>this.channelsStore.update(!0),30*1e3))},t*1e3)),await this.channelsStore.update(),((n=this.channelsStore.channels_list_with_pinned.get("ピン留め"))==null?void 0:n.length)===0&&(this.active_tab_index=1),(_=this.swiper_instance)==null||_.updateAutoHeight(),await w.sleep(.01),this.is_loading=!1},beforeUnmount(){for(const t of this.interval_ids)window.clearInterval(t)},methods:{addPinnedChannel(t){this.settingsStore.settings.pinned_channel_ids=[...this.settingsStore.settings.pinned_channel_ids,t.id],C.show(`${t.name}をピン留めしました。`)},removePinnedChannel(t){var n;this.settingsStore.settings.pinned_channel_ids=this.settingsStore.settings.pinned_channel_ids.filter(_=>_!==t.id),((n=this.channelsStore.channels_list_with_pinned.get("ピン留め"))==null?void 0:n.length)===0&&(this.active_tab_index=1),C.show(`${t.name}のピン留めを外しました。`)},isPinnedChannel(t){return this.settingsStore.settings.pinned_channel_ids.includes(t.id)}}}),i=t=>(z("data-v-34b1de73"),t=t(),N(),t),K={class:"route-container"},Q={class:"channels-tab"},W=i(()=>e("div",{class:"channels-tab__highlight"},null,-1)),Y={class:"channel__broadcaster"},ee=["src"],te={class:"channel__broadcaster-content"},se={class:"channel__broadcaster-name"},ne={class:"channel__broadcaster-status"},ie=i(()=>e("svg",{class:"iconify iconify--fa-solid",width:"10.5px",height:"12px",viewBox:"0 0 448 512"},[e("path",{fill:"currentColor",d:"M323.56 51.2c-20.8 19.3-39.58 39.59-56.22 59.97C240.08 73.62 206.28 35.53 168 0C69.74 91.17 0 209.96 0 281.6C0 408.85 100.29 512 224 512s224-103.15 224-230.4c0-53.27-51.98-163.14-124.44-230.4zm-19.47 340.65C282.43 407.01 255.72 416 226.86 416C154.71 416 96 368.26 96 290.75c0-38.61 24.31-72.63 72.79-130.75c6.93 7.98 98.83 125.34 98.83 125.34l58.63-66.88c4.14 6.85 7.91 13.55 11.27 19.97c27.35 52.19 15.81 118.97-33.43 153.42z"})],-1)),ae=i(()=>e("span",{class:"ml-1"},"勢い:",-1)),oe={class:"ml-1"},re=i(()=>e("span",{style:{"margin-left":"3px"}}," コメ/分",-1)),le={class:"channel__broadcaster-status-viewers ml-4"},ce=i(()=>e("svg",{class:"iconify iconify--fa-solid",width:"15.75px",height:"14px",viewBox:"0 0 576 512"},[e("path",{fill:"currentColor",d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144a143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79a47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"})],-1)),de=i(()=>e("span",{class:"ml-1"},"視聴数:",-1)),_e={class:"ml-1"},ue=["onClick"],he=i(()=>e("svg",{class:"iconify iconify--fluent",width:"24px",height:"24px",viewBox:"0 0 20 20"},[e("path",{fill:"currentColor",d:"M13.325 2.617a2 2 0 0 0-3.203.52l-1.73 3.459a1.5 1.5 0 0 1-.784.721l-3.59 1.436a1 1 0 0 0-.335 1.636L6.293 13L3 16.292V17h.707L7 13.706l2.61 2.61a1 1 0 0 0 1.636-.335l1.436-3.59a1.5 1.5 0 0 1 .722-.784l3.458-1.73a2 2 0 0 0 .52-3.203l-4.057-4.057Z"})],-1)),pe=[he],ge={class:"channel__program-present"},me={class:"channel__program-present-title-wrapper"},ve=["innerHTML"],fe={class:"channel__program-present-time"},we=["innerHTML"],Ce={class:"channel__program-following"},be={class:"channel__program-following-title"},Se=i(()=>e("span",{class:"channel__program-following-title-decorate"},"NEXT",-1)),Be=i(()=>e("svg",{class:"channel__program-following-title-icon iconify iconify--fluent",width:"16px",height:"16px",viewBox:"0 0 20 20"},[e("path",{fill:"currentColor",d:"M10.018 5.486a1 1 0 0 1 1.592-.806l5.88 4.311a1.25 1.25 0 0 1 0 2.017l-5.88 4.311a1 1 0 0 1-1.592-.806v-3.16L4.61 15.319a1 1 0 0 1-1.592-.806V5.486A1 1 0 0 1 4.61 4.68l5.408 3.966v-3.16Z"})],-1)),ye=["innerHTML"],Pe={class:"channel__program-following-time"},ke={class:"channel__progressbar"},xe={key:0,class:"pinned-container d-flex justify-center align-center w-100"},De={class:"d-flex justify-center align-center flex-column"},Ee=i(()=>e("h2",null,[r("ピン留めされているチャンネルが"),e("br"),r("ありません。")],-1)),Fe={class:"mt-4 text-text-darken-1"},Ue=i(()=>e("br",null,null,-1)),Me=i(()=>e("div",{class:"mt-2 text-text-darken-1"},[r("チャンネルをピン留めすると、"),e("br"),r("このタブが最初に表示されます。")],-1));function $e(t,n,_,He,Te,Ie){const P=c("HeaderBar"),k=c("Navigation"),x=c("router-link"),D=c("Icon"),E=c("SwiperSlide"),F=c("Swiper"),U=A("tooltip");return o(),d("div",K,[h(P),e("main",null,[h(k),e("div",{class:p(["channels-container channels-container--home",{"channels-container--loading":t.is_loading}])},[e("div",Q,[e("div",{class:"channels-tab__buttons",style:b({"--tab-length":Array.from(t.channelsStore.channels_list_with_pinned).length,"--active-tab-index":t.active_tab_index})},[(o(!0),d(m,null,v(Array.from(t.channelsStore.channels_list_with_pinned),([a],u)=>(o(),f(L,{variant:"flat",class:"channels-tab__button",key:a,onClick:s=>t.active_tab_index=u},{default:g(()=>[r(l(a),1)]),_:2},1032,["onClick"]))),128)),W],4)]),h(F,{class:"channels-list","space-between":32,"auto-height":!0,"touch-start-prevent-default":!1,observer:!0,"observe-parents":!0,onSwiper:n[1]||(n[1]=a=>t.swiper_instance=a),onSlideChange:n[2]||(n[2]=a=>t.active_tab_index=a.activeIndex)},{default:g(()=>[(o(!0),d(m,null,v(Array.from(t.channelsStore.channels_list_with_pinned),([a,u])=>(o(),f(E,{key:a},{default:g(()=>[e("div",{class:p(["channels",`channels--tab-${a} channels--length-${u.length}`])},[(o(!0),d(m,null,v(u,s=>S((o(),f(x,{class:"channel",draggable:"false",key:s.id,to:`/tv/watch/${s.display_channel_id}`},{default:g(()=>[e("div",Y,[e("img",{class:"channel__broadcaster-icon",src:`${t.Utils.api_base_url}/channels/${s.id}/logo`},null,8,ee),e("div",te,[e("span",se,"Ch: "+l(s.channel_number)+" "+l(s.name),1),e("div",ne,[e("div",{class:p(["channel__broadcaster-status-force",`channel__broadcaster-status-force--${t.ChannelUtils.getChannelForceType(s.jikkyo_force)}`])},[ie,ae,e("span",oe,l(s.jikkyo_force??"--"),1),re],2),e("div",le,[ce,de,e("span",_e,l(s.viewer_count),1)])])]),S((o(),d("div",{class:p(["channel__broadcaster-pin",{"channel__broadcaster-pin--pinned":t.isPinnedChannel(s)}]),onClick:B(Ae=>t.isPinnedChannel(s)?t.removePinnedChannel(s):t.addPinnedChannel(s),["prevent","stop"]),onMousedown:n[0]||(n[0]=B(()=>{},["prevent","stop"]))},pe,42,ue)),[[y],[U,t.isPinnedChannel(s)?"ピン留めを外す":"ピン留めする"]])]),e("div",ge,[e("div",me,[e("span",{class:"channel__program-present-title",innerHTML:t.ProgramUtils.decorateProgramInfo(s.program_present,"title")},null,8,ve),e("span",fe,l(t.ProgramUtils.getProgramTime(s.program_present)),1)]),e("span",{class:"channel__program-present-description",innerHTML:t.ProgramUtils.decorateProgramInfo(s.program_present,"description")},null,8,we)]),h(G),e("div",Ce,[e("div",be,[Se,Be,e("span",{class:"channel__program-following-title-text",innerHTML:t.ProgramUtils.decorateProgramInfo(s.program_following,"title")},null,8,ye)]),e("span",Pe,l(t.ProgramUtils.getProgramTime(s.program_following)),1)]),e("div",ke,[e("div",{class:"channel__progressbar-progress",style:b(`width:${t.ProgramUtils.getProgramProgress(s.program_present)}%;`)},null,4)])]),_:2},1032,["to"])),[[y]])),128)),a==="ピン留め"&&u.length===0?(o(),d("div",xe,[e("div",De,[Ee,e("div",Fe,[r("各チャンネルの "),h(D,{style:{position:"relative",bottom:"-5px"},icon:"fluent:pin-20-filled",width:"22px"}),r(" アイコンから、よくみる"),Ue,r("チャンネルをこのタブにピン留めできます。")]),Me])])):V("",!0)],2)]),_:2},1024))),128))]),_:1})],2)])])}const Oe=I(J,[["render",$e],["__scopeId","data-v-34b1de73"]]);export{Oe as default};
