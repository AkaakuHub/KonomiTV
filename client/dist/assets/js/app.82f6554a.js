(function(){"use strict";var t={6960:function(t,e,s){var i=s(2856),a=s(6086),n=s(5742),r=s(144),o=s(2346),l=s(4801),c=s(1797),_=s.n(c),d=s(9652),u=s(998),m=function(){var t=this,e=t._self._c;return e(u.Z,{attrs:{id:"app"}},[e("transition",[e("router-view")],1)],1)},h=[],p=s(1001),g={},v=(0,p.Z)(g,m,h,!1,null,null,null),f=v.exports,w=s(2165),y=w.Z.extend({render(t){return t("transition",{props:{name:this.computedTransition},on:{beforeEnter:this.onBeforeTransition,afterEnter:this.onAfterTransition,enterCancelled:this.onTransitionCancelled,beforeLeave:this.onBeforeTransition,afterLeave:this.onAfterTransition,leaveCancelled:this.onTransitionCancelled,enter:this.onEnter}},[this.genWindowItem()])}}),b=s(5352),C=s(8481),k=s(530),x=k.Z.extend({data(){return{items:[]}},methods:{register(t){const e=this.items[this.internalIndex];this.items.push(t),this.items.sort(((t,e)=>{const s=this.$slots.default.findIndex((e=>t.$vnode.key===e.key)),i=this.$slots.default.findIndex((t=>e.$vnode.key===t.key));return s-i})),t.$on("change",(()=>this.onClick(t))),this.mandatory&&!this.selectedValues.length&&this.updateMandatory(),this.updateItem(t,this.items.indexOf(t)),void 0!==e&&this.updateInternalValue(this.items.indexOf(e))},unregister(t){const e=this.items[this.internalIndex];this.constructor.super.options.methods.unregister.call(this,t),void 0!==e&&this.updateInternalValue(this.items.indexOf(e))}}}),S=C.Z.extend({methods:{genBar(t,e){const s={style:{height:(0,b.kb)(this.height)},props:{activeClass:this.activeClass,centerActive:this.centerActive,dark:this.dark,light:this.light,mandatory:!this.optional,mobileBreakpoint:this.mobileBreakpoint,nextIcon:this.nextIcon,prevIcon:this.prevIcon,showArrows:this.showArrows,value:this.internalValue},on:{"call:slider":this.callSlider,change:t=>{this.internalValue=t}},ref:"items"};return this.setTextColor(this.computedColor,s),this.setBackgroundColor(this.backgroundColor,s),this.$createElement(x,s,[this.genSlider(e),t])}}}),O=s(5085),T=O.Z.extend({data(){return{items:[]}},methods:{register(t){const e=this.items[this.internalIndex];this.items.push(t),this.items.sort(((t,e)=>{const s=this.$slots.default.findIndex((e=>t.$vnode.key===e.key)),i=this.$slots.default.findIndex((t=>e.$vnode.key===t.key));return s-i})),t.$on("change",(()=>this.onClick(t))),this.mandatory&&!this.selectedValues.length&&this.updateMandatory(),this.updateItem(t,this.items.indexOf(t)),void 0!==e&&this.items.indexOf(e)!==this.internalValue&&this.updateInternalValue(this.items.indexOf(e))},unregister(t){const e=this.items[this.internalIndex];this.constructor.super.options.methods.unregister.call(this,t),void 0!==e&&this.updateInternalValue(this.items.indexOf(e))},updateReverse(t,e){const s=this.items.length,i=s-1;return s<=2?t<e:this.continuous?t===i&&0===e||(0!==t||e!==i)&&t<e:t<e}}}),j=s(196),I={success(t){return window.KonomiTVVueInstance.$message.success(t)},info(t){return window.KonomiTVVueInstance.$message.info(t)},warning(t){return window.KonomiTVVueInstance.$message.warning(t)},error(t){return window.KonomiTVVueInstance.$message.error(t)},show(t){return window.KonomiTVVueInstance.$message.show(t)}};s(1703);class P{static async request(t){const e=await ot.request(t).catch((t=>t));return e instanceof j.d7?(console.error(e),e.response?{status:e.response.status,data:null,error:new Error(e.response.data.detail),is_error:!0}:{status:NaN,data:null,error:e,is_error:!0}):{status:e.status,data:e.data,error:null,is_success:!0}}static async get(t,e){const s=Object.assign({url:t,method:"GET"},e);return await P.request(s)}static async post(t,e,s){const i=Object.assign({url:t,method:"POST",data:e},s);return await P.request(i)}static async put(t,e,s){const i=Object.assign({url:t,method:"PUT",data:e},s);return await P.request(i)}static async delete(t,e){const s=Object.assign({url:t,method:"DELETE"},e);return await P.request(s)}static showGenericError(t,e){switch(t.error.message){case"Access token data is invalid":return void I.error(`${e}\nログインセッションが不正です。もう一度ログインしてください。`);case"Access token is invalid":return void I.error(`${e}\nログインセッションの有効期限が切れています。もう一度ログインしてください。`);case"User associated with access token does not exist":return void I.error(`${e}\nログインセッションに紐づくユーザーが存在しないか、削除されています。`);default:return void(t.error.message?Number.isNaN(t.status)?I.error(`${e}(${t.error.message})`):I.error(`${e}(HTTP Error ${t.status} / ${t.error.message})`):I.error(`${e}(HTTP Error ${t.status})`))}}}var Z=P;class ${static async createUser(t){const e=await Z.post("/users",t);if("is_error"in e){switch(e.error.message){case"Specified username is duplicated":I.error("ユーザー名が重複しています。");break;case"Specified username is not accepted due to system limitations":I.error("ユーザー名に token と me は使えません。");break;default:Z.showGenericError(e,"アカウントを作成できませんでした。");break}return null}return e.data}static async createUserAccessToken(t,e){const s=await Z.post("/users/token",new URLSearchParams({username:t,password:e}));if("is_error"in s){switch(s.error.message){case"Incorrect username":I.error("ログインできませんでした。そのユーザー名のアカウントは存在しません。");break;case"Incorrect password":I.error("ログインできませんでした。パスワードを間違えていませんか？");break;default:Z.showGenericError(s,"ログインできませんでした。");break}return null}return s.data}static async fetchUser(){const t=await Z.get("/users/me");return"is_error"in t?(Z.showGenericError(t,"アカウント情報を取得できませんでした。"),null):t.data}static async fetchUserIcon(){const t=await Z.get("/users/me/icon",{responseType:"blob"});return"is_error"in t?(Z.showGenericError(t,"アイコン画像を取得できませんでした。"),null):URL.createObjectURL(t.data)}static async updateUser(t){const e=await Z.put("/users/me",t);if("is_error"in e)switch(e.error.message){case"Specified username is duplicated":I.error("ユーザー名が重複しています。");break;case"Specified username is not accepted due to system limitations":I.error("ユーザー名に token と me は使えません。");break;default:Z.showGenericError(e,"アカウント情報を更新できませんでした。");break}else;}static async updateUserIcon(t){const e=new FormData;e.append("image",t);const s=await Z.put("/users/me/icon",e,{headers:{"Content-Type":"multipart/form-data"}});if("is_error"in s)switch(s.error.message){case"Please upload JPEG or PNG image":I.error("JPEG または PNG 画像をアップロードしてください。");break;default:Z.showGenericError(s,"アイコン画像を更新できませんでした。");break}else;}static async deleteUser(){const t=await Z["delete"]("/users/me");"is_error"in t&&Z.showGenericError(t,"アカウントを削除できませんでした。")}}var z=$;class A{static async fetchClientSettings(){const t=await Z.get("/settings/client");return"is_error"in t?null:t.data}static async updateClientSettings(t){await Z.put("/settings/client",t)}}var D=A;class B{static getAccessToken(){return localStorage.getItem("KonomiTV-AccessToken")}static saveAccessToken(t){localStorage.setItem("KonomiTV-AccessToken",t)}static deleteAccessToken(){null!==localStorage.getItem("KonomiTV-AccessToken")&&localStorage.removeItem("KonomiTV-AccessToken")}static CtrlOrCmd(){return/iPhone|iPad|Macintosh/i.test(navigator.userAgent)?"Cmd":"Ctrl"}static downloadBlobData(t,e){const s=URL.createObjectURL(t),i=document.createElement("a");i.download=e,i.href=s,i.click(),URL.revokeObjectURL(s)}static escapeHTML(t){const e={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};return t.replace(/[&"'<>]/g,(t=>e[t]))}static getWindowFeatures(){const t=650,e=window.screen.height>=800?800:window.screen.height-100,s=(window.screen.height-e)/2,i=(window.screen.width-t)/2;return`toolbar=0,status=0,top=${s},left=${i},width=${t},height=${e},modal=yes,alwaysRaised=yes`}static hasActiveElementClass(t){return null!==document.activeElement&&document.activeElement.classList.contains(t)}static isMobileDevice(){return/iPhone|iPad|iPod|Macintosh|Android|Mobile/i.test(navigator.userAgent)&&"ontouchend"in document}static isSmartphoneHorizontal(){return window.matchMedia("(max-width: 1000px) and (max-height: 450px)").matches}static isSmartphoneVertical(){return window.matchMedia("(max-width: 600px) and (min-height: 450.01px)").matches}static isTabletHorizontal(){return window.matchMedia("(max-width: 1264px) and (max-height: 850px)").matches}static isTabletVertical(){return window.matchMedia("(max-width: 850px) and (min-height: 850.01px)").matches}static isTouchDevice(){return window.matchMedia("(hover: none)").matches}static mathFloor(t,e=0){return Math.floor(t*10**e)/10**e}static async sleep(t){return await new Promise((e=>setTimeout(e,1e3*t)))}static time(){return Date.now()/1e3}static typeof(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}static URLtoLink(t){t=B.escapeHTML(t);const e=/(https?:\/\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/gi;return t.replace(e,'<a href="$1" target="_blank">$1</a>')}}B.version="0.7.0-dev",B.api_base_url=(()=>`${window.location.protocol}//${window.location.host}/api`)();class K{static getChannelType(t){try{const e=t.match("(?<channel_type>[a-z]+)[0-9]+").groups.channel_type.toUpperCase();return e}catch(e){return"GR"}}static getChannelForceType(t){return null===t?"normal":t>=500?"festival":t>=200?"so-many":t>=100?"many":"normal"}}var N=s(8764);class E{static getCommentColor(t){return this.color_table[t]||null}static getCommentPosition(t){switch(t){case"ue":return"top";case"naka":return"right";case"shita":return"bottom";default:return null}}static getCommentSize(t){switch(t){case"big":case"medium":case"small":return t;default:return null}}static parseCommentCommand(t){let e="#FFEAEA",s="right",i="medium";if(void 0!==t&&null!==t){const a=t.replace("184","").split(" ");for(const t of a){const a=E.getCommentColor(t),n=E.getCommentPosition(t),r=E.getCommentSize(t);null!==a&&(e=a),null!==n&&(s=n),null!==r&&(i=r)}}return{color:e,position:s,size:i}}static isMutedComment(t,e,s,i,a){const n=it();if(n.settings.muted_niconico_user_ids.includes(a))return!0;if(E.special_command_comments_pattern.test(t))return!0;if(!0!==n.settings.mute_fixed_comments||"top"!==s&&"bottom"!==s)if(!0!==n.settings.mute_colored_comments||"#FFEAEA"===e){if(!0!==n.settings.mute_big_size_comments||"big"!==i){if(!0===n.settings.mute_vulgar_comments&&E.mute_vulgar_comments_pattern.test(t))return console.log("[CommentUtils] Muted comment (vulgar_comments): "+t),!0;if(!0===n.settings.mute_abusive_discriminatory_prejudiced_comments&&E.mute_abusive_discriminatory_prejudiced_comments_pattern.test(t))return console.log("[CommentUtils] Muted comment (abusive_discriminatory_prejudiced_comments): "+t),!0;if(!0===n.settings.mute_consecutive_same_characters_comments&&E.mute_consecutive_same_characters_comments_pattern.test(t))return console.log("[CommentUtils] Muted comment (consecutive_same_characters_comments): "+t),!0;for(const e of n.settings.muted_comment_keywords)if(""!==e.pattern)switch(e.match){case"partial":if(t.includes(e.pattern))return console.log("[CommentUtils] Muted comment (partial): "+t),!0;break;case"forward":if(t.startsWith(e.pattern))return console.log("[CommentUtils] Muted comment (forward): "+t),!0;break;case"backward":if(t.endsWith(e.pattern))return console.log("[CommentUtils] Muted comment (backward): "+t),!0;break;case"exact":if(t===e.pattern)return console.log("[CommentUtils] Muted comment (exact): "+t),!0;break;case"regex":if(new RegExp(e.pattern).test(t))return console.log("[CommentUtils] Muted comment (regex): "+t),!0;break}return!!E.annoying_statistical_comments_pattern.test(t)}console.log("[CommentUtils] Muted comment (big_size_comments): "+t)}else console.log("[CommentUtils] Muted comment (colored_comments): "+t);else console.log("[CommentUtils] Muted comment (fixed_comments): "+t)}static addMutedKeywords(t){const e=it();for(const s of e.settings.muted_comment_keywords)if("exact"===s.match&&s.pattern===t)return;e.settings.muted_comment_keywords.push({match:"exact",pattern:t})}static addMutedNiconicoUserIDs(t){const e=it();e.settings.muted_niconico_user_ids.includes(t)||e.settings.muted_niconico_user_ids.push(t)}}E.mute_vulgar_comments_pattern=new RegExp(N.lW.from("cHJwcnzvvZDvvZLvvZDvvZJ8U0VYfFPjgIdYfFPil69YfFPil4tYfFPil49YfO+8s++8pe+8uHzvvLPjgIfvvLh877yz4pev77y4fO+8s+KXi++8uHzvvLPil4/vvLh844Ki44OA44Or44OIfOOCouODiuOCpXzjgqLjg4rjg6t844Kk44Kr6IetfOOCpOOBj3zjgYbjgpPjgZN844Km44Oz44KzfOOBhuOCk+OBoXzjgqbjg7Pjg4F844Ko44Kt44ObfOOBiOOBoeOBiOOBoXzjgYjjgaPjgaF844Ko44OD44OBfOOBiOOBo+OCjXzjgqjjg4Pjg61844GI44KNfOOCqOODrXzlt6Xlj6N844GK44GV44KP44KK44G+44KTfOOBiuOBl+OBo+OBk3zjgqrjgrfjg4PjgrN844Kq44OD44K144OzfOOBiuOBo+OBseOBhHzjgqrjg4Pjg5HjgqR844Kq44OK44OL44O8fOOBiuOBquOBu3zjgqrjg4rjg5t844GK44Gx44GEfOOCquODkeOCpHzjgYpwfOOBiu+9kHzjgqrjg5Xjg5HjgrN844Ks44Kk44K444OzfOOCreODs+OCv+ODnnzjgY/jgbHjgYJ844GP44Gx44GBfOOCr+ODquODiOODquOCuXzjgq/jg7Pjg4t844GU44GP44GU44GP44GU44GP44GU44GPfOOCs+ODs+ODieODvOODoHzjgrbjg7zjg6Hjg7N844K344KzfOOBl+OBk+OBl+OBk3zjgrfjgrPjgrfjgrN844GZ44GR44GZ44GRfOOBm+OBhOOBiOOBjXzjgZnjgYXjgYXjgYXjgYXjgYV844GZ44GG44GG44GG44GG44GGfOOCu+OCr+ODreOCuXzjgrvjg4Pjgq/jgrl844K744OV44OsfOOBoeOBo+OBseOBhHzjgaHjgaPjg5HjgqR844OB44OD44OR44KkfOOBoeOCk+OBk3zjgaHjgIfjgZN844Gh4pev44GTfOOBoeKXi+OBk3zjgaHil4/jgZN844OB44Oz44KzfOODgeOAh+OCs3zjg4Hil6/jgrN844OB4peL44KzfOODgeKXj+OCs3zjgaHjgpPjgb1844Gh44CH44G9fOOBoeKXr+OBvXzjgaHil4vjgb1844Gh4peP44G9fOODgeODs+ODnXzjg4HjgIfjg51844OB4pev44OdfOODgeKXi+ODnXzjg4Hil4/jg51844Gh44KT44Gh44KTfOODgeODs+ODgeODs3zjgabjgYPjgpPjgabjgYPjgpN844OG44Kj44Oz44OG44Kj44OzfOODhuOCo+ODs+ODnXzjg4fjgqvjgYR844OH44Oq44OY44OrfOiEseOBknzjgbHjgYTjgoLjgb9844OR44OR5rS7fOOBteOBhuODu3zjgbXjgYbigKZ844G144GFfO++jO+9qXzjgbXjgY/jgonjgb/jgYvjgZF844G144GP44KJ44KT44GnfOOBuuOBo+OBn3zjgbrjgo3jgbrjgo1844Oa44Ot44Oa44OtfO++je++n+++m+++je++n+++m3zjg5Xjgqfjg6l844G844Gj44GNfOODneODq+ODjnzjgbzjgo3jgpN844Oc44Ot44OzfO++ju++nu++m+++nXzjgb3jgo3jgop844Od44Ot44OqfO++ju++n+++m+++mHzjg57jg7PjgY3jgaR844Oe44Oz44Kt44OEfOOBvuOCk+OBk3zjgb7jgIfjgZN844G+4pev44GTfOOBvuKXi+OBk3zjgb7il4/jgZN844Oe44Oz44KzfOODnuOAh+OCs3zjg57il6/jgrN844Oe4peL44KzfOODnuKXj+OCs3zjgb7jgpPjgZXjgpN844KC44Gj44GT44KKfOODouODg+OCs+ODqnzjgoLjgb/jgoLjgb9844Oi44Of44Oi44OffOODpOOBo+OBn3zjg6TjgaPjgaZ844Ok44KJfOOChOOCieOBm+OCjXzjg6Tjgop844Ok44KLfOODpOOCjHzjg6Tjgo1844Op44OW44ObfOODr+ODrOODoXzllph86Zmw5qC4fOmZsOiMjnzpmbDllId85rer5aSifOmZsOavm3znlKPjgoHjgot85aWz44Gu5a2Q44Gu5pelfOaxmuOBo+OBleOCk3zlp6Z86aiO5LmX5L2NfOmHkeeOiXzmnIjntYx85b6M6IOM5L2NfOWtkOS9nOOCinzlsITnsr585L+h6ICFfOeyvua2snzpgI/jgZF85oCn5LqkfOeyvuWtkHzmraPluLjkvY185oCn5b60fOaAp+eahHznlJ/nkIZ85a+45q2i44KBfOe0oOadkHzmirHjgYR85oqx44GLfOaKseOBjXzmirHjgY985oqx44GRfOaKseOBk3zkubPpppZ85oGl5Z6ifOS4reOBoOOBl3zkuK3lh7rjgZd85bC/fOaKnOOBhHzmipzjgZHjgarjgYR85oqc44GR44KLfOaKnOOBkeOCjHzohqjjgol85YuD6LW3fOaPieOBvnzmj4njgb985o+J44KAfOaPieOCgXzmvKvmuZZ844CH772efOKXr++9nnzil4vvvZ584peP772efOOAh+ODg+OCr+OCuXzil6/jg4Pjgq/jgrl84peL44OD44Kv44K5fOKXj+ODg+OCr+OCuQ==","base64").toString()),E.mute_abusive_discriminatory_prejudiced_comments_pattern=new RegExp(N.lW.from("44CCfOOCouOCueODmnzjgqTjgqvjgox844Kk44Op44Gk44GPfOOCpuOCuHzjgqbjg7zjg6h844Km44OofOOCpuODqOOCr3zjgqbjg7J844GN44KC44GEfOOCreODouOCpHzjgq3jg6LjgYR844KtL+ODoC/jg4F844Ks44Kk44K4fO+9tu++nu+9su+9vO++nnzjgqzjgq1844Kr44K5fOOCreODg+OCunzjgY3jgaHjgYzjgYR844Kt44OB44Ks44KkfOOCreODoOODgXzjg4Hjg6fjg7N85Y2D44On44OzfOOBpOOCk+OBvHzjg4Tjg7Pjg5x844ON44OI44Km44OofOOBq+OBoOOBguOBgnzjg4vjg4B8776G776A776efOODkeODvOODqHzjg5Hjg6h844OR44Oo44KvfOOBtuOBo+OBlXzjg5bjg4PjgrV844G244GV44GEfOODluOCteOCpHzjgb7jgazjgZF844Oh44Kv44OpfOODkOOCq3zjg6DjgqvjgaTjgY986bq755Sf44K744Oh44Oz44OIfOaFsOWuieWppnzlrrPlhZB85aSW5a2XfOWnpuWbvXzpn5Plm7186Z+T5LitfOmfk+aXpXzln7rlnLDlpJZ85rCX5oyB44Gh5oKqfOWbveS6pOaWree1tnzmrrp86aCD44GZfOWcqOaXpXzlj4LmlL/mqKl85q2744GtfOawj+OBrXzvvoDvvot85q255YyVfOatueODknzpmpzlrrN85pat5LqkfOS4remfk3zmnJ3prq585b6055So5belfOWjunzml6Xpn5N85pel5bidfOeymOedgHzlj43ml6V86aas6bm/fOeZuumBlHzmnLR85aOy5Zu9fOS4jeW/q3zplpPmipzjgZF86Z2W5Zu9","base64").toString()),E.mute_consecutive_same_characters_comments_pattern=/(.)\1{7,}/,E.special_command_comments_pattern=/\/[a-z]+ /,E.annoying_statistical_comments_pattern=/最高\d+米\/|計\d+ＩＤ|総\d+米/,E.color_table={white:"#FFEAEA",red:"#F02840",pink:"#FD7E80",orange:"#FDA708",yellow:"#FFE133",green:"#64DD17",cyan:"#00D4F5",blue:"#4763FF",purple:"#D500F9",black:"#1E1310",white2:"#CCCC99",niconicowhite:"#CCCC99",red2:"#CC0033",truered:"#CC0033",pink2:"#FF33CC",orange2:"#FF6600",passionorange:"#FF6600",yellow2:"#999900",madyellow:"#999900",green2:"#00CC66",elementalgreen:"#00CC66",cyan2:"#00CCCC",blue2:"#3399FF",marineblue:"#3399FF",purple2:"#6633CC",nobleviolet:"#6633CC",black2:"#666666"};class L{static generatePlayerBackgroundURL(){const t=12,e=Math.floor(Math.random()*t)+1;return`/assets/images/player-backgrounds/${e.toString().padStart(2,"0")}.jpg`}static isHEVCVideoSupported(){return"probably"===document.createElement("video").canPlayType('video/mp4; codecs="hvc1.1.6.L123.B0"')}}var H=s(7484),U=s.n(H),V=(s(6831),s(6607)),M=s.n(V),R=s(9212),F=s.n(R),G=s(7412),q=s.n(G);class W{static decorateProgramInfo(t,e){if(null!==t&&null!==t[e]){const s=Y.escapeHTML(t[e]),i="新|終|再|交|映|手|声|多|副|字|文|CC|OP|二|S|B|SS|無|無料C|S1|S2|S3|MV|双|デ|D|N|W|P|H|HV|SD|天|解|料|前|後初|生|販|吹|PPV|演|移|他|収|・|英|韓|中|字/日|字/日英|3D|2K|4K|8K|5.1|7.1|22.2|60P|120P|d|HC|HDR|SHV|UHD|VOD|配|初",a=new RegExp("\\((二|字|再)\\)","g"),n=new RegExp(`\\[(${i})\\]`,"g");return s.replace(a,'<span class="decorate-symbol">$1</span>').replace(n,'<span class="decorate-symbol">$1</span>')}{U().extend(F()),U().extend(q()),U().extend(M());const t=U()(),s=U()().hour(0).minute(0).second(0),i=U()().hour(6).minute(59).second(59),a=U()().hour(23).minute(0).second(0),n=U()().hour(23).minute(59).second(59);return t.isSameOrAfter(s)&&t.isSameOrBefore(i)||t.isSameOrAfter(a)&&t.isSameOrBefore(n)?"title"===e?"放送休止":"この時間は放送を休止しています。":"title"===e?"番組情報がありません":"この時間の番組情報を取得できませんでした。"}}static getAttribute(t,e,s){return null!==t&&void 0!==t[e]&&null!==t[e]?t[e]:s}static getProgramProgress(t){if(null!==t){const e=U()(U()()).diff(t.start_time,"second");return e/t.duration*100}return 0}static getProgramTime(t,e=!1){if(null!==t&&"2000-01-01T00:00:00+09:00"!==t.start_time){U().locale("ja");const s=U()(t.start_time),i=U()(t.end_time),a=t.duration/60;return!0===e?`${s.format("HH:mm")} ～ ${i.format("HH:mm")}`:`${s.format("YYYY/MM/DD (dd) HH:mm")} ～ ${i.format("HH:mm")} (${a}分)`}return!0===e?"--:-- ～ --:--":"----/--/-- (-) --:-- ～ --:-- (--分)"}}var Y=B;const X=["pinned_channel_ids","saved_twitter_hashtags","tv_show_superimpose","panel_display_state","tv_panel_active_tab","caption_font","always_border_caption_text","specify_caption_background_color","caption_background_color","capture_save_mode","capture_caption_mode","comment_speed_rate","comment_font_size","close_comment_form_after_sending","muted_comment_keywords","muted_niconico_user_ids","mute_vulgar_comments","mute_abusive_discriminatory_prejudiced_comments","mute_big_size_comments","mute_fixed_comments","mute_colored_comments","mute_consecutive_same_characters_comments","fold_panel_after_sending_tweet","reset_hashtag_when_program_switches","auto_add_watching_channel_hashtag","twitter_active_tab","tweet_hashtag_position","tweet_capture_watermark_position"],J={pinned_channel_ids:[],showed_panel_last_time:!0,selected_twitter_account_id:null,saved_twitter_hashtags:[],tv_streaming_quality:"1080p",tv_data_saver_mode:!1,tv_low_latency_mode:!0,tv_show_superimpose:!0,panel_display_state:"RestorePreviousState",tv_panel_active_tab:"Program",caption_font:"Windows TV MaruGothic",always_border_caption_text:!0,specify_caption_background_color:!1,caption_background_color:"#00000080",capture_copy_to_clipboard:!1,capture_save_mode:"Browser",capture_caption_mode:"Both",sync_settings:!1,comment_speed_rate:1,comment_font_size:34,close_comment_form_after_sending:!0,muted_comment_keywords:[],muted_niconico_user_ids:[],mute_vulgar_comments:!0,mute_abusive_discriminatory_prejudiced_comments:!0,mute_big_size_comments:!0,mute_fixed_comments:!1,mute_colored_comments:!1,mute_consecutive_same_characters_comments:!1,fold_panel_after_sending_tweet:!1,reset_hashtag_when_program_switches:!0,auto_add_watching_channel_hashtag:!0,twitter_active_tab:"Capture",tweet_hashtag_position:"Append",tweet_capture_watermark_position:"None"};function Q(){const t=localStorage.getItem("KonomiTV-Settings");return null!==t?JSON.parse(t):(tt(J),J)}function tt(t){localStorage.setItem("KonomiTV-Settings",JSON.stringify(t))}function et(t){const e={};for(const s of Object.keys(J))e[s]=s in t?t[s]:J[s];return e}const st=(0,a.Q_)("settings",{state:()=>{const t=Q(),e=et(t);return tt(e),{settings:e}},actions:{async importClientSettings(t){const e=await t.text();let s={};try{s=JSON.parse(e)}catch(a){return!1}const i=et(s);return tt(i),this.settings=i,await this.syncClientSettingsToServer(),!0},async resetClientSettings(){tt(J),this.settings=J,await this.syncClientSettingsToServer()},getSyncableClientSettings(){const t={};for(const e of X)e in this.settings?t[e]=this.settings[e]:t[e]=J[e];return t},async syncClientSettingsFromServer(t=!1){if(null===Y.getAccessToken()||!1===this.settings.sync_settings&&!1===t)return;const e=await D.fetchClientSettings();if(null!==e)for(const[s,i]of Object.entries(e))this.settings[s]=i},async syncClientSettingsToServer(t=!1){if(null===Y.getAccessToken()||!1===this.settings.sync_settings&&!1===t)return;const e=this.getSyncableClientSettings();await D.updateClientSettings(e)}}});var it=st;const at=(0,a.Q_)("user",{state:()=>({is_logged_in:!1,user:null,user_icon_url:null}),getters:{user_niconico_icon_url(){if(null===this.user||null===this.user.niconico_user_id)return null;const t=this.user.niconico_user_id.toString().slice(0,4);return`https://secure-dcdn.cdn.nimg.jp/nicoaccount/usericon/${t}/${this.user.niconico_user_id}.jpg`}},actions:{async register(t,e){const s=await z.createUser({username:t,password:e});return null===s?(console.log("Register failed."),!1):(await this.login(t,e,!0),console.log("Register successful."),I.success("アカウントを作成しました。"),!0)},async login(t,e,s=!1){const i=await z.createUserAccessToken(t,e);return null===i?(console.log("Login failed."),!1):(console.log("Login successful."),Y.saveAccessToken(i.access_token),this.is_logged_in=!0,await this.fetchUser(!0),!1===s&&I.success("ログインしました。"),!0)},logout(t=!1){const e=it();e.settings.sync_settings=!1,Y.deleteAccessToken(),this.is_logged_in=!1,this.user=null,this.user_icon_url="",!1===t&&I.success("ログアウトしました。")},async fetchUser(t=!1){if(null===Y.getAccessToken())return null;if(null!==this.user&&!1===t)return this.user;const e=await z.fetchUser();if(null===e)return null===Y.getAccessToken()&&this.logout(!0),null;this.is_logged_in=!0,this.user=e;const s=await z.fetchUserIcon();return null===s?null:(this.user_icon_url=s,this.user)},async updateUser(t){await z.updateUser(t),await this.fetchUser(!0),void 0!==t.username?I.show("ユーザー名を更新しました。"):void 0!==t.password&&I.show("パスワードを更新しました。")},async updateUserIcon(t){await z.updateUserIcon(t),await this.fetchUser(!0),I.show("アイコン画像を更新しました。")},async deleteUser(){await z.deleteUser(),this.logout(!0),I.show("アカウントを削除しました。")}}});var nt=at;const rt=j.ZP.create();rt.interceptors.request.use((t=>{void 0===t.baseURL&&(t.baseURL=Y.api_base_url),t.headers=t.headers||{};const e=Y.getAccessToken();return null!==e&&(t.headers["Authorization"]=`Bearer ${e}`),t.headers["X-KonomiTV-Version"]=Y.version,t.timeout=3e4,t})),rt.interceptors.response.use((t=>t),(t=>{if(j.ZP.isAxiosError(t)&&t.response&&401===t.response.status){const t=nt();t.logout(!0)}return Promise.reject(t)}));var ot=rt,lt=s(1858),ct=s(9258),_t=s(4562),dt=s(4324);r["default"].use(lt.Z),r["default"].component("v-snackbar",ct.Z),r["default"].component("v-btn",_t.Z),r["default"].component("v-icon",dt.Z);var ut=new lt.Z({theme:{dark:!0,themes:{dark:{primary:"#E64F97",secondary:"#E33157",twitter:{base:"#4F82E6",lighten1:"#799FEC",lighten2:"#41A5F1"},gray:"#66514C",black:"#110A09",background:{base:"#1E1310",lighten1:"#2F221F",lighten2:"#433532",lighten3:"#4c3c38"},text:{base:"#FFEAEA",darken1:"#D9C7C7",darken2:"#8E7F7E",darken3:"#786968"}}},options:{customProperties:!0}}}),mt=s(8345),ht=s(8718),pt=s(626),gt=s(7069),vt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"route-container"},[e("Header"),e("main",[e("Navigation"),e("div",{staticClass:"channels-container channels-container--home",class:{"channels-container--loading":t.is_loading}},[e("v-tabs-fix",{staticClass:"channels-tab",attrs:{centered:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(Array.from(t.channelsStore.channels_list_with_pinned),(function([s]){return e(pt.Z,{key:s,staticClass:"channels-tab__item"},[t._v(" "+t._s(s)+" ")])})),1),e("v-tabs-items-fix",{staticClass:"channels-list",model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(Array.from(t.channelsStore.channels_list_with_pinned),(function([s,i]){return e("v-tab-item-fix",{key:s,staticClass:"channels-tabitem"},[e("div",{staticClass:"channels",class:`channels--tab-${s} channels--length-${i.length}`},[t._l(i,(function(s){return e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],key:s.id,staticClass:"channel",attrs:{to:`/tv/watch/${s.channel_id}`}},[e("div",{staticClass:"channel__broadcaster"},[e("img",{staticClass:"channel__broadcaster-icon",attrs:{src:`${t.Utils.api_base_url}/channels/${s.channel_id}/logo`}}),e("div",{staticClass:"channel__broadcaster-content"},[e("span",{staticClass:"channel__broadcaster-name"},[t._v("Ch: "+t._s(s.channel_number)+" "+t._s(s.channel_name))]),e("div",{staticClass:"channel__broadcaster-status"},[e("div",{staticClass:"channel__broadcaster-status-force",class:`channel__broadcaster-status-force--${t.ChannelUtils.getChannelForceType(s.channel_force)}`},[e("Icon",{attrs:{icon:"fa-solid:fire-alt",height:"12px"}}),e("span",{staticClass:"ml-1"},[t._v("勢い:")]),e("span",{staticClass:"ml-1"},[t._v(t._s(t.ProgramUtils.getAttribute(s,"channel_force","--")))]),e("span",{staticStyle:{"margin-left":"3px"}},[t._v(" コメ/分")])],1),e("div",{staticClass:"channel__broadcaster-status-viewers ml-4"},[e("Icon",{attrs:{icon:"fa-solid:eye",height:"14px"}}),e("span",{staticClass:"ml-1"},[t._v("視聴数:")]),e("span",{staticClass:"ml-1"},[t._v(t._s(s.viewers))])],1)])]),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip",value:t.isPinnedChannel(s.channel_id)?"ピン留めを外す":"ピン留めする",expression:"isPinnedChannel(channel.channel_id) ? 'ピン留めを外す' : 'ピン留めする'"}],staticClass:"channel__broadcaster-pin",class:{"channel__broadcaster-pin--pinned":t.isPinnedChannel(s.channel_id)},on:{click:function(e){e.preventDefault(),e.stopPropagation(),t.isPinnedChannel(s.channel_id)?t.removePinnedChannel(s.channel_id):t.addPinnedChannel(s.channel_id)},mousedown:function(t){t.preventDefault(),t.stopPropagation()}}},[e("Icon",{attrs:{icon:"fluent:pin-20-filled",width:"24px"}})],1)]),e("div",{staticClass:"channel__program-present"},[e("div",{staticClass:"channel__program-present-title-wrapper"},[e("span",{staticClass:"channel__program-present-title",domProps:{innerHTML:t._s(t.ProgramUtils.decorateProgramInfo(s.program_present,"title"))}}),e("span",{staticClass:"channel__program-present-time"},[t._v(t._s(t.ProgramUtils.getProgramTime(s.program_present)))])]),e("span",{staticClass:"channel__program-present-description",domProps:{innerHTML:t._s(t.ProgramUtils.decorateProgramInfo(s.program_present,"description"))}})]),e(ht.Z),e("div",{staticClass:"channel__program-following"},[e("div",{staticClass:"channel__program-following-title"},[e("span",{staticClass:"channel__program-following-title-decorate"},[t._v("NEXT")]),e("Icon",{staticClass:"channel__program-following-title-icon",attrs:{icon:"fluent:fast-forward-20-filled",width:"16px"}}),e("span",{staticClass:"channel__program-following-title-text",domProps:{innerHTML:t._s(t.ProgramUtils.decorateProgramInfo(s.program_following,"title"))}})],1),e("span",{staticClass:"channel__program-following-time"},[t._v(t._s(t.ProgramUtils.getProgramTime(s.program_following)))])]),e("div",{staticClass:"channel__progressbar"},[e("div",{staticClass:"channel__progressbar-progress",style:`width:${t.ProgramUtils.getProgramProgress(s.program_present)}%;`})])],1)})),"ピン留め"===s&&0===i.length?e("div",{staticClass:"pinned-container d-flex justify-center align-center w-100"},[e("div",{staticClass:"d-flex justify-center align-center flex-column"},[e("h2",[t._v("ピン留めされているチャンネルが"),e("br"),t._v("ありません。")]),e("div",{staticClass:"mt-4 text--text text--darken-1"},[t._v("各チャンネルの "),e("Icon",{staticStyle:{position:"relative",bottom:"-5px"},attrs:{icon:"fluent:pin-20-filled",width:"22px"}}),t._v(" アイコンから、よくみる"),e("br"),t._v("チャンネルをこのタブにピン留めできます。")],1),e("div",{staticClass:"mt-2 text--text text--darken-1"},[t._v("チャンネルをピン留めすると、"),e("br"),t._v("このタブが最初に表示されます。")])])]):t._e()],2)])})),1)],1)],1)],1)},ft=[],wt=function(){var t=this,e=t._self._c;return e("header",{staticClass:"header"},[e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"konomitv-logo ml-3 ml-md-6",attrs:{to:"/tv/"}},[e("img",{staticClass:"konomitv-logo__image",attrs:{src:"/assets/images/logo.svg",height:"21"}})]),e(ht.Z)],1)},yt=[],bt={},Ct=(0,p.Z)(bt,wt,yt,!1,null,"84897154",null),kt=Ct.exports,xt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("div",{staticClass:"navigation-container elevation-8"},[e("nav",{staticClass:"navigation"},[e("div",{staticClass:"navigation-scroll"},[e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"navigation__link",attrs:{"active-class":"navigation__link--active",to:"/tv/"}},[e("Icon",{staticClass:"navigation__link-icon",attrs:{icon:"fluent:tv-20-regular",width:"26px"}}),e("span",{staticClass:"navigation__link-text"},[t._v("テレビをみる")])],1),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"navigation__link",attrs:{"active-class":"navigation__link--active",to:"/videos/"}},[e("Icon",{staticClass:"navigation__link-icon",attrs:{icon:"fluent:movies-and-tv-20-regular",width:"26px"}}),e("span",{staticClass:"navigation__link-text"},[t._v("ビデオをみる")])],1),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"navigation__link",attrs:{"active-class":"navigation__link--active",to:"/timetable/"}},[e("Icon",{staticClass:"navigation__link-icon",attrs:{icon:"fluent:calendar-ltr-20-regular",width:"26px"}}),e("span",{staticClass:"navigation__link-text"},[t._v("番組表")])],1),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"navigation__link",attrs:{"active-class":"navigation__link--active",to:"/captures/"}},[e("Icon",{staticClass:"navigation__link-icon",attrs:{icon:"fluent:image-multiple-24-regular",width:"26px"}}),e("span",{staticClass:"navigation__link-text"},[t._v("キャプチャ")])],1),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"navigation__link",attrs:{"active-class":"navigation__link--active",to:"/watchlists/"}},[e("Icon",{staticClass:"navigation__link-icon",attrs:{icon:"ic:round-playlist-play",width:"26px"}}),e("span",{staticClass:"navigation__link-text"},[t._v("ウォッチリスト")])],1),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"navigation__link",attrs:{"active-class":"navigation__link--active",to:"/histories/"}},[e("Icon",{staticClass:"navigation__link-icon",attrs:{icon:"fluent:history-16-regular",width:"26px"}}),e("span",{staticClass:"navigation__link-text"},[t._v("視聴履歴")])],1),e(ht.Z),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"navigation__link",attrs:{"active-class":"navigation__link--active",to:"/settings/"}},[e("Icon",{staticClass:"navigation__link-icon",attrs:{icon:"fluent:settings-20-regular",width:"26px"}}),e("span",{staticClass:"navigation__link-text"},[t._v("設定")])],1),e("a",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip.top",value:t.is_update_available?`アップデートがあります (version ${t.latest_version})`:"",expression:"is_update_available ? `アップデートがあります (version ${latest_version})` : ''",modifiers:{top:!0}}],staticClass:"navigation__link",class:{"navigation__link--version":t.Utils.version.includes("-dev"),"navigation__link--highlight":t.is_update_available},attrs:{"active-class":"navigation__link--active",href:"https://github.com/tsukumijima/KonomiTV"}},[e("Icon",{staticClass:"navigation__link-icon",attrs:{icon:"fluent:info-16-regular",width:"26px"}}),e("span",{staticClass:"navigation__link-text"},[t._v("version "+t._s(t.Utils.version))])],1)],1)])]),e("BottomNavigation")],1)},St=[],Ot=s(7458),Tt=function(){var t=this,e=t._self._c;return e(Ot.Z,{staticClass:"bottom-navigation-container elevation-12",attrs:{color:"primary",grow:""}},[e(_t.Z,{staticClass:"bottom-navigation-button",attrs:{to:"/tv/"}},[e("span",{staticClass:"mt-1"},[t._v("テレビをみる")]),e("Icon",{attrs:{icon:"fluent:tv-20-regular",width:"30px"}})],1),e(_t.Z,{staticClass:"bottom-navigation-button",attrs:{to:"/videos/"}},[e("span",{staticClass:"mt-1"},[t._v("ビデオをみる")]),e("Icon",{attrs:{icon:"fluent:movies-and-tv-20-regular",width:"30px"}})],1),e(_t.Z,{staticClass:"bottom-navigation-button",attrs:{to:"/settings/"}},[e("span",{staticClass:"mt-1"},[t._v("設定")]),e("Icon",{attrs:{icon:"fluent:settings-20-regular",width:"30px"}})],1)],1)},jt=[],It={},Pt=(0,p.Z)(It,Tt,jt,!1,null,"589d9d22",null),Zt=Pt.exports;class $t{static async fetchServerVersion(){const t=await Z.get("/version");return"is_error"in t?(Z.showGenericError(t,"バージョン情報を取得できませんでした。"),null):t.data}}var zt=$t,At=r["default"].extend({name:"Navigation",components:{BottomNavigation:Zt},data(){return{Utils:Y,latest_version:null,is_update_available:!1}},async created(){try{const t=await zt.fetchServerVersion();if(null===t)return;if(this.latest_version=t.latest_version,null===this.latest_version)return;(!1===t.version.includes("-dev")&&t.version!==t.latest_version||!0===t.version.includes("-dev")&&t.version.replace("-dev","")===t.latest_version)&&(this.is_update_available=!0)}catch(t){throw new Error(t)}}}),Dt=At,Bt=(0,p.Z)(Dt,xt,St,!1,null,"57371237",null),Kt=Bt.exports;const Nt={id:"NID0-SID0-EID0",network_id:0,service_id:0,event_id:0,channel_id:"gr000",title:"取得中…",description:"取得中…",detail:{},start_time:"2000-01-01T00:00:00+09:00",end_time:"2000-01-01T00:00:00+09:00",duration:0,is_free:!0,genre:[],video_type:"映像1080i(1125i)、アスペクト比16:9 パンベクトルなし",video_codec:"mpeg2",video_resolution:"1080i",primary_audio_type:"2/0モード(ステレオ)",primary_audio_language:"日本語",primary_audio_sampling_rate:"48kHz",secondary_audio_type:null,secondary_audio_language:null,secondary_audio_sampling_rate:null},Et={id:"NID0-SID0",network_id:0,service_id:0,transport_stream_id:null,remocon_id:null,channel_id:"gr000",channel_number:"---",channel_name:"取得中…",channel_type:"GR",channel_force:null,channel_comment:null,is_subchannel:!1,is_radiochannel:!1,is_display:!0,viewers:0,program_present:Nt,program_following:Nt};class Lt{static async fetchAll(){const t=await Z.get("/channels");return"is_error"in t?(Z.showGenericError(t,"チャンネル情報を取得できませんでした。"),null):t.data}static async fetch(t){const e=await Z.get(`/channels/${t}`);return"is_error"in e?(Z.showGenericError(e,"チャンネル情報を取得できませんでした。"),null):e.data}static async fetchJikkyoSession(t){const e=await Z.get(`/channels/${t}/jikkyo`);return"is_error"in e?(Z.showGenericError(e,"ニコニコ実況のセッション情報を取得できませんでした。"),null):e.data}}var Ht=Lt;const Ut=(0,a.Q_)("channels",{state:()=>({channel_id:"gr000",channels_list:{GR:[],BS:[],CS:[],CATV:[],SKY:[],STARDIGIO:[]},is_channels_list_initial_updated:!1,last_updated_at:0}),getters:{channel(){const t=this.channels_list[K.getChannelType(this.channel_id)];if(void 0===t||0===t.length)return{previous:Et,current:Et,next:Et};const e=t.findIndex((t=>t.channel_id===this.channel_id));if(-1===e){const t=Object.assign(Object.assign({},Et.program_present),{channel_id:"gr999",title:"チャンネル情報取得エラー",description:"このチャンネル ID のチャンネル情報は存在しません。"}),e=Object.assign(Object.assign({},Et),{channel_id:"gr999",channel_name:"ERROR",program_present:t,program_following:t});return{previous:e,current:e,next:e}}const s=(()=>{let s=e-1;while(t.length){if(s<=-1&&(s=t.length-1),t[s].is_display)return s;s--}return 0})(),i=(()=>{let s=e+1;while(t.length){if(s>=t.length&&(s=0),t[s].is_display)return s;s++}return 0})();return{previous:t[s],current:t[e],next:t[i]}},channels_list_with_pinned(){var t,e,s,i,a,n,r;const o=it(),l=new Map;if(l.set("ピン留め",[]),l.set("地デジ",[]),!1===this.is_channels_list_initial_updated)return l;l.set("BS",[]),l.set("CS",[]),l.set("CATV",[]),l.set("SKY",[]),l.set("StarDigio",[]);for(const[c,_]of Object.entries(this.channels_list))for(const d of _)if(!1!==d.is_display)switch(o.settings.pinned_channel_ids.includes(d.channel_id)&&(null===(t=l.get("ピン留め"))||void 0===t||t.push(d)),d.channel_type){case"GR":null===(e=l.get("地デジ"))||void 0===e||e.push(d);break;case"BS":null===(s=l.get("BS"))||void 0===s||s.push(d);break;case"CS":null===(i=l.get("CS"))||void 0===i||i.push(d);break;case"CATV":null===(a=l.get("CATV"))||void 0===a||a.push(d);break;case"SKY":null===(n=l.get("SKY"))||void 0===n||n.push(d);break;case"STARDIGIO":null===(r=l.get("StarDigio"))||void 0===r||r.push(d);break}for(const c of[...l.get("ピン留め")]){const t=o.settings.pinned_channel_ids.indexOf(c.channel_id);l.get("ピン留め")[t]=c}for(const[c,_]of l)"ピン留め"!==c&&0===_.length&&l.delete(c);return 1===l.size&&l.has("ピン留め")&&l.delete("ピン留め"),l},channels_list_with_pinned_for_watch(){var t;const e=this.channels_list_with_pinned;return 0===(null===(t=e.get("ピン留め"))||void 0===t?void 0:t.length)&&e.delete("ピン留め"),e}},actions:{getChannel(t){var e;const s=this.channels_list[K.getChannelType(t)];return void 0===s?null:null!==(e=s.find((e=>e.channel_id===t)))&&void 0!==e?e:null},getChannelByRemoconID(t,e){const s=this.channels_list[t],i=s.find((t=>t.remocon_id===e));return null!==i&&void 0!==i?i:null},updateChannel(t,e){const s=K.getChannelType(t);if(void 0===this.channels_list[s])return null;const i=this.channels_list[s].findIndex((e=>e.channel_id===t));-1!==i&&r["default"].set(this.channels_list[s],i,e)},async update(t=!1){const e=async()=>{const t=await Ht.fetchAll();null!==t&&(this.channels_list=t,this.is_channels_list_initial_updated=!0,this.last_updated_at=Y.time())};!0!==this.is_channels_list_initial_updated||!1!==t?await e():Y.time()-this.last_updated_at>60&&e()}}});var Vt=Ut,Mt=r["default"].extend({name:"TV-Home",components:{Header:kt,Navigation:Kt},data(){return{Utils:Y,ChannelUtils:K,ProgramUtils:W,tab:null,is_loading:!0,interval_ids:[]}},computed:Object.assign({},(0,a.Kc)(Vt,it)),async created(){0===this.settingsStore.settings.pinned_channel_ids.length&&(this.tab=1);const t=60-(new Date).getSeconds();this.interval_ids.push(window.setTimeout((()=>{this.channelsStore.update(!0),this.interval_ids.push(window.setInterval((()=>this.channelsStore.update(!0)),3e4))}),1e3*t)),await this.channelsStore.update(),await Y.sleep(.01),0===this.channelsStore.channels_list_with_pinned.get("ピン留め").length&&(this.tab=1),this.is_loading=!1},beforeDestroy(){for(const t of this.interval_ids)window.clearInterval(t)},methods:{addPinnedChannel(t){this.settingsStore.settings.pinned_channel_ids.push(t);const e=this.channelsStore.getChannel(t);this.$message.show(`${e.channel_name}をピン留めしました。`)},removePinnedChannel(t){this.settingsStore.settings.pinned_channel_ids.splice(this.settingsStore.settings.pinned_channel_ids.indexOf(t),1),0===this.channelsStore.channels_list_with_pinned.get("ピン留め").length&&(this.tab=1);const e=this.channelsStore.getChannel(t);this.$message.show(`${e.channel_name}のピン留めを外しました。`)},isPinnedChannel(t){return this.settingsStore.settings.pinned_channel_ids.includes(t)}}}),Rt=Mt,Ft=(0,p.Z)(Rt,vt,ft,!1,null,"89a818f6",null),Gt=Ft.exports,qt=s(9582),Wt=s(4886),Yt=s(266),Xt=s(4061),Jt=s(3305),Qt=s(1713),te=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"route-container"},[e("main",{staticClass:"watch-container",class:{"watch-container--control-display":t.is_control_display,"watch-container--panel-display":!!t.Utils.isSmartphoneVertical()||t.is_panel_display,"watch-container--fullscreen":t.is_fullscreen}},[e("nav",{staticClass:"watch-navigation",on:{mousemove:function(e){return t.controlDisplayTimer(e)},touchmove:function(e){return t.controlDisplayTimer(e)},click:function(e){return t.controlDisplayTimer(e)}}},[e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"watch-navigation__icon",attrs:{to:"/tv/"}},[e("img",{staticClass:"watch-navigation__icon-image",attrs:{src:"/assets/images/icon.svg",width:"23px"}})]),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip.right",value:"テレビをみる",expression:"'テレビをみる'",modifiers:{right:!0}}],staticClass:"watch-navigation__link",attrs:{"active-class":"watch-navigation__link--active",to:"/tv/"}},[e("Icon",{staticClass:"watch-navigation__link-icon",attrs:{icon:"fluent:tv-20-regular",width:"26px"}})],1),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip.right",value:"ビデオをみる",expression:"'ビデオをみる'",modifiers:{right:!0}}],staticClass:"watch-navigation__link",attrs:{"active-class":"watch-navigation__link--active",to:"/videos/"}},[e("Icon",{staticClass:"watch-navigation__link-icon",attrs:{icon:"fluent:movies-and-tv-20-regular",width:"26px"}})],1),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip.right",value:"番組表",expression:"'番組表'",modifiers:{right:!0}}],staticClass:"watch-navigation__link",attrs:{"active-class":"watch-navigation__link--active",to:"/timetable/"}},[e("Icon",{staticClass:"watch-navigation__link-icon",attrs:{icon:"fluent:calendar-ltr-20-regular",width:"26px"}})],1),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip.right",value:"キャプチャ",expression:"'キャプチャ'",modifiers:{right:!0}}],staticClass:"watch-navigation__link",attrs:{"active-class":"watch-navigation__link--active",to:"/captures/"}},[e("Icon",{staticClass:"watch-navigation__link-icon",attrs:{icon:"fluent:image-multiple-24-regular",width:"26px"}})],1),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip.right",value:"ウォッチリスト",expression:"'ウォッチリスト'",modifiers:{right:!0}}],staticClass:"watch-navigation__link",attrs:{"active-class":"watch-navigation__link--active",to:"/watchlists/"}},[e("Icon",{staticClass:"watch-navigation__link-icon",attrs:{icon:"ic:round-playlist-play",width:"26px"}})],1),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip.right",value:"視聴履歴",expression:"'視聴履歴'",modifiers:{right:!0}}],staticClass:"watch-navigation__link",attrs:{"active-class":"watch-navigation__link--active",to:"/histories/"}},[e("Icon",{staticClass:"watch-navigation__link-icon",attrs:{icon:"fluent:history-16-regular",width:"26px"}})],1),e(ht.Z),e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip.right",value:"設定",expression:"'設定'",modifiers:{right:!0}}],staticClass:"watch-navigation__link",attrs:{"active-class":"watch-navigation__link--active",to:"/settings/"}},[e("Icon",{staticClass:"watch-navigation__link-icon",attrs:{icon:"fluent:settings-20-regular",width:"26px"}})],1),e("a",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip.right",value:`version ${t.Utils.version}`,expression:"`version ${Utils.version}`",modifiers:{right:!0}}],staticClass:"watch-navigation__link",attrs:{"active-class":"watch-navigation__link--active",href:"https://github.com/tsukumijima/KonomiTV"}},[e("Icon",{staticClass:"watch-navigation__link-icon",attrs:{icon:"fluent:info-16-regular",width:"26px"}})],1)],1),e("div",{staticClass:"watch-content",on:{mousemove:function(e){return t.controlDisplayTimer(e,!0)},touchmove:function(e){return t.controlDisplayTimer(e,!0)},click:function(e){return t.controlDisplayTimer(e,!0)}}},[e("header",{staticClass:"watch-header"},[e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"watch-header__back-icon",attrs:{to:"/tv/"}},[e("Icon",{attrs:{icon:"fluent:arrow-left-12-filled",width:"25px"}})],1),e("img",{staticClass:"watch-header__broadcaster",attrs:{src:`${t.Utils.api_base_url}/channels/${t.channelsStore.channel_id}/logo`}}),e("span",{staticClass:"watch-header__program-title",domProps:{innerHTML:t._s(t.ProgramUtils.decorateProgramInfo(t.channelsStore.channel.current.program_present,"title"))}}),e("span",{staticClass:"watch-header__program-time"},[t._v(" "+t._s(t.ProgramUtils.getProgramTime(t.channelsStore.channel.current.program_present,!0))+" ")]),e(ht.Z),e("span",{staticClass:"watch-header__now"},[t._v(t._s(t.time))])],1),e("div",{staticClass:"watch-player",class:{"watch-player--loading":t.is_loading,"watch-player--virtual-keyboard-display":t.is_virtual_keyboard_display&&t.Utils.hasActiveElementClass("dplayer-comment-input")}},[e("div",{staticClass:"watch-player__background-wrapper"},[e("div",{staticClass:"watch-player__background",class:{"watch-player__background--display":t.is_background_display},style:{backgroundImage:`url(${t.background_url})`}},[e("img",{staticClass:"watch-player__background-logo",attrs:{src:"/assets/images/logo.svg"}})])]),e(Jt.Z,{staticClass:"watch-player__buffering",class:{"watch-player__buffering--display":t.is_video_buffering&&(t.is_loading||null!==t.player&&!t.player.video.paused)},attrs:{indeterminate:"",size:"60",width:"6"}}),e("div",{staticClass:"watch-player__dplayer"}),e("div",{staticClass:"watch-player__button",on:{mousemove:function(e){return t.controlDisplayTimer(e)},touchmove:function(e){return t.controlDisplayTimer(e)},click:function(e){return t.controlDisplayTimer(e)}}},[e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip.top",value:"前のチャンネル",expression:"'前のチャンネル'",modifiers:{top:!0}}],staticClass:"switch-button switch-button-up",on:{click:function(e){t.is_zapping=!0,t.$router.push({path:`/tv/watch/${t.channelsStore.channel.previous.channel_id}`})}}},[e("Icon",{staticClass:"switch-button-icon",attrs:{icon:"fluent:ios-arrow-left-24-filled",width:"32px",rotate:"1"}})],1),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"switch-button switch-button-panel switch-button-panel--open",on:{click:function(e){t.is_panel_display=!t.is_panel_display}}},[e("Icon",{staticClass:"switch-button-icon",attrs:{icon:"fluent:navigation-16-filled",width:"32px"}})],1),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"},{name:"tooltip",rawName:"v-tooltip.bottom",value:"次のチャンネル",expression:"'次のチャンネル'",modifiers:{bottom:!0}}],staticClass:"switch-button switch-button-down",on:{click:function(e){t.is_zapping=!0,t.$router.push({path:`/tv/watch/${t.channelsStore.channel.next.channel_id}`})}}},[e("Icon",{staticClass:"switch-button-icon",attrs:{icon:"fluent:ios-arrow-right-24-filled",width:"33px",rotate:"1"}})],1)])],1)]),e("div",{staticClass:"watch-panel",on:{mousemove:function(e){return t.controlDisplayTimer(e)}}},[e("div",{staticClass:"watch-panel__header"},[e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"panel-close-button",on:{click:function(e){t.is_panel_display=!1}}},[e("Icon",{staticClass:"panel-close-button__icon",attrs:{icon:"akar-icons:chevron-right",width:"25px"}}),e("span",{staticClass:"panel-close-button__text"},[t._v("閉じる")])],1),e(ht.Z),e("div",{staticClass:"panel-broadcaster"},[e("img",{staticClass:"panel-broadcaster__icon",attrs:{src:`${t.Utils.api_base_url}/channels/${t.channelsStore.channel_id}/logo`}}),e("div",{staticClass:"panel-broadcaster__number"},[t._v(t._s(t.channelsStore.channel.current.channel_number))]),e("div",{staticClass:"panel-broadcaster__name"},[t._v(t._s(t.channelsStore.channel.current.channel_name))])])],1),e("div",{staticClass:"watch-panel__content-container"},[e("Program",{staticClass:"watch-panel__content",class:{"watch-panel__content--active":"Program"===t.tv_panel_active_tab}}),e("Channel",{staticClass:"watch-panel__content",class:{"watch-panel__content--active":"Channel"===t.tv_panel_active_tab}}),e("Comment",{ref:"Comment",staticClass:"watch-panel__content",class:{"watch-panel__content--active":"Comment"===t.tv_panel_active_tab},attrs:{channel:t.channelsStore.channel.current,player:t.player}}),e("Twitter",{ref:"Twitter",staticClass:"watch-panel__content",class:{"watch-panel__content--active":"Twitter"===t.tv_panel_active_tab},attrs:{player:t.player,is_virtual_keyboard_display:t.is_virtual_keyboard_display},on:{panel_folding_requested:function(e){t.is_panel_display=!1}}})],1),e("div",{staticClass:"watch-panel__navigation"},[e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"panel-navigation-button",class:{"panel-navigation-button--active":"Program"===t.tv_panel_active_tab},on:{click:function(e){t.tv_panel_active_tab="Program"}}},[e("Icon",{staticClass:"panel-navigation-button__icon",attrs:{icon:"fa-solid:info-circle",width:"33px"}}),e("span",{staticClass:"panel-navigation-button__text"},[t._v("番組情報")])],1),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"panel-navigation-button",class:{"panel-navigation-button--active":"Channel"===t.tv_panel_active_tab},on:{click:function(e){t.tv_panel_active_tab="Channel"}}},[e("Icon",{staticClass:"panel-navigation-button__icon",attrs:{icon:"fa-solid:broadcast-tower",width:"34px"}}),e("span",{staticClass:"panel-navigation-button__text"},[t._v("チャンネル")])],1),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"panel-navigation-button",class:{"panel-navigation-button--active":"Comment"===t.tv_panel_active_tab},on:{click:function(e){t.tv_panel_active_tab="Comment"}}},[e("Icon",{staticClass:"panel-navigation-button__icon",attrs:{icon:"bi:chat-left-text-fill",width:"29px"}}),e("span",{staticClass:"panel-navigation-button__text"},[t._v("コメント")])],1),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"panel-navigation-button",class:{"panel-navigation-button--active":"Twitter"===t.tv_panel_active_tab},on:{click:function(e){t.tv_panel_active_tab="Twitter"}}},[e("Icon",{staticClass:"panel-navigation-button__icon",attrs:{icon:"fa-brands:twitter",width:"34px"}}),e("span",{staticClass:"panel-navigation-button__text"},[t._v("Twitter")])],1)])])]),e(Xt.Z,{attrs:{"max-width":"1000",transition:"slide-y-transition"},model:{value:t.shortcut_key_modal,callback:function(e){t.shortcut_key_modal=e},expression:"shortcut_key_modal"}},[e(qt.Z,[e(Wt.EB,{staticClass:"px-5 pt-4 pb-3 d-flex align-center font-weight-bold"},[e("Icon",{attrs:{icon:"fluent:keyboard-20-filled",height:"28px"}}),e("span",{staticClass:"ml-3"},[t._v("キーボードショートカット")]),e(ht.Z),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"d-flex align-center rounded-circle cursor-pointer px-2 py-2",on:{click:function(e){t.shortcut_key_modal=!1}}},[e("Icon",{attrs:{icon:"fluent:dismiss-12-filled",width:"23px",height:"23px"}})],1)],1),e("div",{staticClass:"px-5 pb-4"},[e(Qt.Z,t._l(t.shortcut_key_list,(function(s,i){return e(Yt.Z,{key:i,attrs:{cols:"6"}},t._l(s,(function(s){return e("div",{key:s.name,staticClass:"mt-3"},[e("div",{staticClass:"text-subtitle-1 d-flex align-center font-weight-bold"},[e("Icon",{attrs:{icon:s.icon,height:s.icon_height}}),e("span",{staticClass:"ml-2"},[t._v(t._s(s.name))])],1),t._l(s.shortcuts,(function(s){return e("div",{key:s.name,staticClass:"mt-3"},[e("div",{staticClass:"text-subtitle-2 mt-2 d-flex align-center font-weight-medium"},[e("span",{staticClass:"mr-2",domProps:{innerHTML:t._s(s.name)}}),e("div",{staticClass:"ml-auto d-flex align-center flex-shrink-0"},t._l(s.keys,(function(i,a){return e("div",{key:i.name,staticClass:"ml-auto d-flex align-center"},[e("span",{staticClass:"shortcut-key"},[t._l(i.name.split(";"),(function(t){return e("Icon",{directives:[{name:"show",rawName:"v-show",value:!0===i.icon,expression:"key.icon === true"}],key:t,attrs:{icon:t,height:"18px"}})})),!1===i.icon?e("span",{domProps:{innerHTML:t._s(i.name)}}):t._e()],2),a<s.keys.length-1?e("span",{staticClass:"shortcut-key-plus"},[t._v("+")]):t._e()])})),0)])])}))],2)})),0)})),1)],1)],1)],1),e("BottomNavigation")],1)},ee=[],se=s(5953),ie=s.n(se),ae=s(2527),ne=s.n(ae),re=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"channels-container channels-container--watch"},[e("v-tabs-fix",{staticClass:"channels-tab",attrs:{centered:"","show-arrows":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(Array.from(t.channelsStore.channels_list_with_pinned_for_watch),(function([s]){return e(pt.Z,{key:s,staticClass:"channels-tab__item"},[t._v(" "+t._s(s)+" ")])})),1),e("div",{staticClass:"channels-list-container"},[e("v-tabs-items-fix",{staticClass:"channels-list",model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(Array.from(t.channelsStore.channels_list_with_pinned_for_watch),(function([s,i]){return e("v-tab-item-fix",{key:s,staticClass:"channels"},t._l(i,(function(s){return e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],key:s.id,staticClass:"channel",attrs:{to:`/tv/watch/${s.channel_id}`}},[e("div",{staticClass:"channel__broadcaster"},[e("img",{staticClass:"channel__broadcaster-icon",attrs:{src:`${t.Utils.api_base_url}/channels/${s.channel_id}/logo`}}),e("div",{staticClass:"channel__broadcaster-content"},[e("span",{staticClass:"channel__broadcaster-name"},[t._v("Ch: "+t._s(s.channel_number)+" "+t._s(s.channel_name))]),e("div",{staticClass:"channel__broadcaster-force",class:`channel__broadcaster-force--${t.ChannelUtils.getChannelForceType(s.channel_force)}`},[e("Icon",{attrs:{icon:"fa-solid:fire-alt",height:"11px"}}),e("span",{staticClass:"ml-1"},[t._v(t._s(t.ProgramUtils.getAttribute(s,"channel_force","-")))])],1)])]),e("div",{staticClass:"channel__program-present"},[e("span",{staticClass:"channel__program-present-title",domProps:{innerHTML:t._s(t.ProgramUtils.decorateProgramInfo(s.program_present,"title"))}}),e("span",{staticClass:"channel__program-present-time"},[t._v(t._s(t.ProgramUtils.getProgramTime(s.program_present)))])]),e("div",{staticClass:"channel__program-following"},[e("div",{staticClass:"channel__program-following-title"},[e("span",{staticClass:"channel__program-following-title-decorate"},[t._v("NEXT")]),e("Icon",{staticClass:"channel__program-following-title-icon",attrs:{icon:"fluent:fast-forward-20-filled",width:"16px"}}),e("span",{staticClass:"channel__program-following-title-text",domProps:{innerHTML:t._s(t.ProgramUtils.decorateProgramInfo(s.program_following,"title"))}})],1),e("span",{staticClass:"channel__program-following-time"},[t._v(t._s(t.ProgramUtils.getProgramTime(s.program_following)))])]),e("div",{staticClass:"channel__progressbar"},[e("div",{staticClass:"channel__progressbar-progress",style:`width:${t.ProgramUtils.getProgramProgress(s.program_present)}%;`})])])})),1)})),1)],1)],1)},oe=[],le=r["default"].extend({name:"Panel-ChannelTab",data(){return{Utils:Y,ChannelUtils:K,ProgramUtils:W,tab:null}},computed:Object.assign({},(0,a.Kc)(Vt))}),ce=le,_e=(0,p.Z)(ce,re,oe,!1,null,"6d1fbf08",null),de=_e.exports,ue=s(5808),me=s(4525),he=s(60),pe=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"comment-container"},[e("section",{staticClass:"comment-header"},[e("h2",{staticClass:"comment-header__title"},[e("Icon",{staticClass:"comment-header__title-icon",attrs:{icon:"bi:chat-left-text-fill",height:"18.5px"}}),e("span",{staticClass:"comment-header__title-text"},[t._v("コメント")])],1),e("button",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"comment-header__button ml-auto",on:{click:function(e){t.comment_mute_settings_modal=!t.comment_mute_settings_modal}}},[e("Icon",{attrs:{icon:"heroicons-solid:filter",height:"11px"}}),e("span",{staticClass:"ml-1"},[t._v("ミュート設定")])],1)]),e("section",{ref:"comment_list_wrapper",staticClass:"comment-list-wrapper"},[e("div",{staticClass:"comment-list-dropdown",class:{"comment-list-dropdown--display":t.is_comment_list_dropdown_display},style:{"--comment-list-dropdown-top":`${t.comment_list_dropdown_top}px`}},[e(ue.Z,{staticStyle:{background:"var(--v-background-lighten1)"}},[e(me.Z,{staticStyle:{"min-height":"30px"},attrs:{dense:""},on:{click:function(e){t.CommentUtils.addMutedKeywords(t.comment_list_dropdown_comment.text),t.is_comment_list_dropdown_display=!1}}},[e(he.V9,{staticClass:"d-flex align-center"},[e("Icon",{attrs:{icon:"fluent:comment-dismiss-20-filled",width:"20px"}}),e("span",{staticClass:"ml-2"},[t._v("このコメントをミュート")])],1)],1),e(me.Z,{staticStyle:{"min-height":"30px"},attrs:{dense:""},on:{click:function(e){t.CommentUtils.addMutedNiconicoUserIDs(t.comment_list_dropdown_comment.user_id),t.is_comment_list_dropdown_display=!1}}},[e(he.V9,{staticClass:"d-flex align-center"},[e("Icon",{attrs:{icon:"fluent:person-prohibited-20-filled",width:"20px"}}),e("span",{staticClass:"ml-2"},[t._v("このコメントの投稿者をミュート")])],1)],1)],1)],1),e("div",{staticClass:"comment-list-cover",class:{"comment-list-cover--display":t.is_comment_list_dropdown_display},on:{click:function(e){t.is_comment_list_dropdown_display=!1}}}),e("DynamicScroller",{staticClass:"comment-list",attrs:{direction:"vertical",items:t.comment_list,"min-item-size":34},scopedSlots:t._u([{key:"default",fn:function({item:s,active:i}){return[e("DynamicScrollerItem",{attrs:{item:s,active:i,"size-dependencies":[s.text]}},[e("div",{staticClass:"comment",class:{"comment--my-post":s.my_post}},[e("span",{staticClass:"comment__text"},[t._v(t._s(s.text))]),e("span",{staticClass:"comment__time"},[t._v(t._s(s.time))]),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple",value:!t.Utils.isTouchDevice(),expression:"!Utils.isTouchDevice()"}],staticClass:"comment__icon",on:{mouseup:function(e){return t.displayCommentListDropdown(e,s)},touchend:function(e){return t.displayCommentListDropdown(e,s)}}},[e("Icon",{attrs:{icon:"fluent:more-vertical-20-filled",width:"20px"}})],1)])])]}}])}),null===t.initialize_failed_message&&0===t.comment_list.length?e("div",{staticClass:"comment-announce"},[e("div",{staticClass:"comment-announce__heading"},[t._v("まだコメントがありません。")]),t._m(0)]):t._e(),null!==t.initialize_failed_message&&0===t.comment_list.length?e("div",{staticClass:"comment-announce"},[e("div",{staticClass:"comment-announce__heading"},[t._v("コメントがありません。")]),e("div",{staticClass:"comment-announce__text"},[e("p",{staticClass:"mt-0 mb-0"},[t._v(t._s(t.initialize_failed_message))])])]):t._e()],1),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"comment-scroll-button elevation-5",class:{"comment-scroll-button--display":t.is_manual_scroll},on:{click:function(e){t.is_manual_scroll=!1,t.scrollCommentList(!0)}}},[e("Icon",{attrs:{icon:"fluent:arrow-down-12-filled",height:"29px"}})],1),e("CommentMuteSettings",{model:{value:t.comment_mute_settings_modal,callback:function(e){t.comment_mute_settings_modal=e},expression:"comment_mute_settings_modal"}})],1)},ge=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"comment-announce__text"},[e("p",{staticClass:"mt-0 mb-0"},[t._v("このチャンネルに対応するニコニコ実況のコメントが、リアルタイムで表示されます。")])])}],ve=s(5570),fe=s(1023),we=s(7808),ye=function(){var t=this,e=t._self._c;t._self._setupProxy;return e(Xt.Z,{attrs:{"max-width":"770",transition:"slide-y-transition"},model:{value:t.comment_mute_settings_modal,callback:function(e){t.comment_mute_settings_modal=e},expression:"comment_mute_settings_modal"}},[e(qt.Z,{staticClass:"comment-mute-settings"},[e(Wt.EB,{staticClass:"px-5 pt-5 pb-3 d-flex align-center font-weight-bold",staticStyle:{height:"60px"}},[e("Icon",{attrs:{icon:"heroicons-solid:filter",height:"26px"}}),e("span",{staticClass:"ml-3"},[t._v("コメントのミュート設定")]),e(ht.Z),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"d-flex align-center rounded-circle cursor-pointer px-2 py-2",on:{click:function(e){t.comment_mute_settings_modal=!1}}},[e("Icon",{attrs:{icon:"fluent:dismiss-12-filled",width:"23px",height:"23px"}})],1)],1),e("div",{staticClass:"px-5 pb-5"},[e("div",{staticClass:"text-subtitle-1 d-flex align-center font-weight-bold mt-4"},[e("Icon",{attrs:{icon:"fa-solid:sliders-h",width:"24px",height:"20px"}}),e("span",{staticClass:"ml-2"},[t._v("クイック設定")])],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"mute_vulgar_comments"}},[t._v(" 露骨な表現を含むコメントをミュートする ")]),e("label",{staticClass:"settings__item-label",attrs:{for:"mute_vulgar_comments"}},[t._v(" 性的な単語などの露骨・下品な表現を含むコメントを、一括でミュートするかを設定します。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"mute_vulgar_comments",inset:"","hide-details":""},model:{value:t.settingsStore.settings.mute_vulgar_comments,callback:function(e){t.$set(t.settingsStore.settings,"mute_vulgar_comments",e)},expression:"settingsStore.settings.mute_vulgar_comments"}})],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"mute_abusive_discriminatory_prejudiced_comments"}},[t._v(" ネガティブな表現、差別的な表現、政治的に偏った表現を含むコメントをミュートする ")]),e("label",{staticClass:"settings__item-label",attrs:{for:"mute_abusive_discriminatory_prejudiced_comments"}},[t._v(" 『死ね』『殺す』などのネガティブな表現、特定の国や人々への差別的な表現、政治的に偏った表現を含むコメントを、一括でミュートするかを設定します。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"mute_abusive_discriminatory_prejudiced_comments",inset:"","hide-details":""},model:{value:t.settingsStore.settings.mute_abusive_discriminatory_prejudiced_comments,callback:function(e){t.$set(t.settingsStore.settings,"mute_abusive_discriminatory_prejudiced_comments",e)},expression:"settingsStore.settings.mute_abusive_discriminatory_prejudiced_comments"}})],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"mute_big_size_comments"}},[t._v(" 文字サイズが大きいコメントをミュートする ")]),e("label",{staticClass:"settings__item-label",attrs:{for:"mute_big_size_comments"}},[t._v(" 通常より大きい文字サイズで表示されるコメントを、一括でミュートするかを設定します。"),e("br"),t._v(" 文字サイズが大きいコメントには迷惑なコメントが多いです。基本的にはオンにしておくのがおすすめです。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"mute_big_size_comments",inset:"","hide-details":""},model:{value:t.settingsStore.settings.mute_big_size_comments,callback:function(e){t.$set(t.settingsStore.settings,"mute_big_size_comments",e)},expression:"settingsStore.settings.mute_big_size_comments"}})],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"mute_fixed_comments"}},[t._v(" 映像の上下に固定表示されるコメントをミュートする ")]),e("label",{staticClass:"settings__item-label",attrs:{for:"mute_fixed_comments"}},[t._v(" 映像の上下に固定された状態で表示されるコメントを、一括でミュートするかを設定します。"),e("br"),t._v(" 固定表示されるコメントが煩わしい方におすすめです。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"mute_fixed_comments",inset:"","hide-details":""},model:{value:t.settingsStore.settings.mute_fixed_comments,callback:function(e){t.$set(t.settingsStore.settings,"mute_fixed_comments",e)},expression:"settingsStore.settings.mute_fixed_comments"}})],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"mute_colored_comments"}},[t._v(" 色付きのコメントをミュートする ")]),e("label",{staticClass:"settings__item-label",attrs:{for:"mute_colored_comments"}},[t._v(" 白以外の色で表示される色付きのコメントを、一括でミュートするかを設定します。"),e("br"),t._v(" この設定をオンにしておくと、目立つ色のコメントを一掃できます。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"mute_colored_comments",inset:"","hide-details":""},model:{value:t.settingsStore.settings.mute_colored_comments,callback:function(e){t.$set(t.settingsStore.settings,"mute_colored_comments",e)},expression:"settingsStore.settings.mute_colored_comments"}})],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"mute_consecutive_same_characters_comments"}},[t._v(" 8文字以上同じ文字が連続しているコメントをミュートする ")]),e("label",{staticClass:"settings__item-label",attrs:{for:"mute_consecutive_same_characters_comments"}},[t._v(" 『wwwwwwwwwww』『あばばばばばばばばば』など、8文字以上同じ文字が連続しているコメントを、一括でミュートするかを設定します。"),e("br"),t._v(" しばしばあるテンプレコメントが煩わしい方におすすめです。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"mute_consecutive_same_characters_comments",inset:"","hide-details":""},model:{value:t.settingsStore.settings.mute_consecutive_same_characters_comments,callback:function(e){t.$set(t.settingsStore.settings,"mute_consecutive_same_characters_comments",e)},expression:"settingsStore.settings.mute_consecutive_same_characters_comments"}})],1),e("div",{staticClass:"text-subtitle-1 d-flex align-center font-weight-bold mt-4"},[e("Icon",{attrs:{icon:"fluent:comment-dismiss-20-filled",width:"24px"}}),e("span",{staticClass:"ml-2 mr-2"},[t._v("ミュート済みのキーワード")]),e(_t.Z,{staticClass:"ml-auto",attrs:{depressed:""},on:{click:function(e){return t.settingsStore.settings.muted_comment_keywords.push({match:"partial",pattern:""})}}},[e("Icon",{attrs:{icon:"fluent:add-12-filled",height:"17px"}}),e("span",{staticClass:"ml-1"},[t._v("追加")])],1)],1),e("div",{staticClass:"muted-comment-items"},t._l(t.settingsStore.settings.muted_comment_keywords,(function(s,i){return e("div",{key:s.id,staticClass:"muted-comment-item"},[e(we.Z,{staticClass:"muted-comment-item__input",attrs:{type:"search",dense:"",outlined:"","hide-details":"",placeholder:"ミュートするキーワードを入力"},model:{value:t.settingsStore.settings.muted_comment_keywords[i].pattern,callback:function(e){t.$set(t.settingsStore.settings.muted_comment_keywords[i],"pattern",e)},expression:"settingsStore.settings.muted_comment_keywords[index].pattern"}}),e(ve.Z,{staticClass:"muted-comment-item__match-type",attrs:{dense:"",outlined:"","hide-details":"",items:t.muted_comment_keyword_match_type},model:{value:t.settingsStore.settings.muted_comment_keywords[i].match,callback:function(e){t.$set(t.settingsStore.settings.muted_comment_keywords[i],"match",e)},expression:"settingsStore.settings.muted_comment_keywords[index].match"}}),e("button",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"muted-comment-item__delete-button",on:{click:function(e){t.settingsStore.settings.muted_comment_keywords.splice(t.settingsStore.settings.muted_comment_keywords.indexOf(s),1)}}},[e("Icon",{attrs:{icon:"fluent:delete-16-filled",width:"20px"}})],1)],1)})),0),e("div",{staticClass:"text-subtitle-1 d-flex align-center font-weight-bold mt-4"},[e("Icon",{attrs:{icon:"fluent:person-prohibited-20-filled",width:"24px"}}),e("span",{staticClass:"ml-2 mr-2"},[t._v("ミュート済みのニコニコユーザー ID")]),e(_t.Z,{staticClass:"ml-auto",attrs:{depressed:""},on:{click:function(e){return t.settingsStore.settings.muted_niconico_user_ids.push("")}}},[e("Icon",{attrs:{icon:"fluent:add-12-filled",height:"17px"}}),e("span",{staticClass:"ml-1"},[t._v("追加")])],1)],1),e("div",{staticClass:"muted-comment-items"},t._l(t.settingsStore.settings.muted_niconico_user_ids,(function(s,i){return e("div",{key:s.id,staticClass:"muted-comment-item"},[e(we.Z,{staticClass:"muted-comment-item__input",attrs:{type:"search",dense:"",outlined:"","hide-details":"",placeholder:"ミュートするニコニコユーザー ID を入力"},model:{value:t.settingsStore.settings.muted_niconico_user_ids[i],callback:function(e){t.$set(t.settingsStore.settings.muted_niconico_user_ids,i,e)},expression:"settingsStore.settings.muted_niconico_user_ids[index]"}}),e("button",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"muted-comment-item__delete-button",on:{click:function(e){t.settingsStore.settings.muted_niconico_user_ids.splice(t.settingsStore.settings.muted_niconico_user_ids.indexOf(s),1)}}},[e("Icon",{attrs:{icon:"fluent:delete-16-filled",width:"20px"}})],1)],1)})),0)])],1)],1)},be=[],Ce=r["default"].extend({name:"CommentMuteSettings",model:{prop:"showing",event:"change"},props:{showing:{type:Boolean,required:!0}},data(){return{interval_timer_id:0,comment_mute_settings_modal:!1,muted_comment_keyword_match_type:[{text:"部分一致",value:"partial"},{text:"前方一致",value:"forward"},{text:"後方一致",value:"backward"},{text:"完全一致",value:"exact"},{text:"正規表現",value:"regex"}]}},computed:Object.assign({},(0,a.Kc)(it)),watch:{showing(){this.comment_mute_settings_modal=this.showing},comment_mute_settings_modal(){this.$emit("change",this.comment_mute_settings_modal)}}}),ke=Ce,xe=(0,p.Z)(ke,ye,be,!1,null,"fbd463ca",null),Se=xe.exports;class Oe{constructor(t,e,s,i){this.watch_session=null,this.comment_session=null,this.vpos_base_timestamp=0,this.keep_seat_interval_id=null,this.abort_controller=new AbortController,this.player=t,this.channel_id=e,this.on_initial_comments_received=s,this.on_comment_received=i}async initSession(){const t=await this.initWatchSession();return!1===t.is_success?{is_success:!1,detail:t.detail}:(this.initCommentSession(t),{is_success:!0,detail:"視聴セッションを初期化しました。"})}async initWatchSession(){let t=!1;const e=await Ht.fetchJikkyoSession(this.channel_id);return null===e?{is_success:!1,detail:"ニコニコ実況のセッション情報を取得できませんでした。"}:!1===e.is_success?(console.error(`[LiveCommentManager][WatchSession] Error: ${e.detail}`),"このチャンネルはニコニコ実況に対応していません。"!==e.detail&&"現在放送中のニコニコ実況がありません。"!==e.detail&&this.player.notice(e.detail),{is_success:!1,detail:e.detail}):(this.watch_session=new WebSocket(e.audience_token),this.watch_session.addEventListener("open",(()=>{var t;null===(t=this.watch_session)||void 0===t||t.send(JSON.stringify({type:"startWatching",data:{reconnect:!1}}))}),{signal:this.abort_controller.signal}),this.watch_session.addEventListener("close",(async e=>{!0!==t&&(console.error(`[LiveCommentManager][WatchSession] Connection closed. (Code: ${e.code})`),this.player.notice(`ニコニコ実況との接続が切断されました。(Code: ${e.code})`),await Y.sleep(10),await this.reconnect())}),{signal:this.abort_controller.signal}),this.watch_session.addEventListener("message",(async e=>{const s=JSON.parse(e.data);switch(s.type){case"seat":if(null!==this.keep_seat_interval_id)break;this.keep_seat_interval_id=window.setInterval((()=>{var t;this.watch_session&&this.watch_session.readyState===WebSocket.OPEN?this.watch_session.send(JSON.stringify({type:"keepSeat"})):window.clearInterval(null!==(t=this.keep_seat_interval_id)&&void 0!==t?t:0)}),1e3*s.data.keepIntervalSec);break;case"ping":this.watch_session.send(JSON.stringify({type:"pong"}));break;case"error":{if("COMMENT_POST_NOT_ALLOWED"===s.data.code||"INVALID_MESSAGE"===s.data.code)break;let t=`ニコニコ実況でエラーが発生しています。(Code: ${s.data.code})`;switch(s.data.code){case"CONNECT_ERROR":t="ニコニコ実況のコメントサーバーに接続できません。";break;case"CONTENT_NOT_READY":t="ニコニコ実況が配信できない状態です。";break;case"NO_THREAD_AVAILABLE":t="ニコニコ実況のコメントスレッドを取得できません。";break;case"NO_ROOM_AVAILABLE":t="ニコニコ実況のコメント部屋を取得できません。";break;case"NO_PERMISSION":t="ニコニコ実況の API にアクセスする権限がありません。";break;case"NOT_ON_AIR":t="ニコニコ実況が放送中ではありません。";break;case"BROADCAST_NOT_FOUND":t="ニコニコ実況の配信情報を取得できません。";break;case"INTERNAL_SERVERERROR":t="ニコニコ実況でサーバーエラーが発生しています。";break}console.error(`[LiveCommentManager][WatchSession] Error occurred. (Code: ${s.data.code})`),this.player.notice(t),await Y.sleep(5),await this.reconnect();break}case"reconnect":await this.reconnect();break;case"disconnect":{t=!0;let e=`ニコニコ実況との接続が切断されました。(${s.data.reason})`;switch(s.data.reason){case"TAKEOVER":e="ニコニコ実況の番組から追い出されました。";break;case"NO_PERMISSION":e="ニコニコ実況の番組の座席を取得できませんでした。";break;case"END_PROGRAM":e="ニコニコ実況がリセットされたか、コミュニティの番組が終了しました。";break;case"PING_TIMEOUT":e="コメントサーバーとの接続生存確認に失敗しました。";break;case"TOO_MANY_CONNECTIONS":e="ニコニコ実況の同一ユーザからの接続数上限を越えています。";break;case"TOO_MANY_WATCHINGS":e="ニコニコ実況の同一ユーザからの視聴番組数上限を越えています。";break;case"CROWDED":e="ニコニコ実況の番組が満席です。";break;case"MAINTENANCE_IN":e="ニコニコ実況はメンテナンス中です。";break;case"SERVICE_TEMPORARILY_UNAVAILABLE":e="ニコニコ実況で一時的にサーバーエラーが発生しています。";break}console.error(`[LiveCommentManager][WatchSession] Disconnected. (Reason: ${s.data.reason})`),this.player.notice(e),await Y.sleep(5),await this.reconnect();break}}}),{signal:this.abort_controller.signal}),new Promise((t=>{this.watch_session.addEventListener("message",(async e=>{const s=JSON.parse(e.data);if("room"===s.type)return this.vpos_base_timestamp=U()(s.data.vposBaseTime).valueOf(),console.log(`[LiveCommentManager][WatchSession] Connected.\nThread ID: ${s.data.threadId}\n`),t({is_success:!0,detail:"視聴セッションを取得しました。",message_server_url:s.data.messageServer.uri,thread_id:s.data.threadId,your_post_key:s.data.yourPostKey?s.data.yourPostKey:null})}),{signal:this.abort_controller.signal})})))}initCommentSession(t){const e=[];let s=!1;this.comment_session=new WebSocket(t.message_server_url),this.comment_session.addEventListener("open",(()=>{this.comment_session.send(JSON.stringify([{ping:{content:"rs:0"}},{ping:{content:"ps:0"}},{thread:{version:"20061206",thread:t.thread_id,threadkey:t.your_post_key,user_id:"",res_from:-50}},{ping:{content:"pf:0"}},{ping:{content:"rf:0"}}]))}),{signal:this.abort_controller.signal}),this.comment_session.addEventListener("message",(async t=>{const i=JSON.parse(t.data);if(void 0!==i.thread&&0!==i.thread.resultcode)return void console.error(`[LiveCommentManager][CommentSession] Connection failed. (Code: ${i.thread.resultcode})`);if(void 0!==i.ping&&"rf:0"===i.ping.content)return s=!0,void this.on_initial_comments_received(e);const a=i.chat;if(void 0===a||void 0===a.content||""===a.content||a.yourpost&&1===a.yourpost)return;const{color:n,position:r,size:o}=E.parseCommentCommand(a.mail);if(E.isMutedComment(a.content,n,r,o,a.user_id))return;const l={id:a.no,text:a.content,time:U()(1e3*a.date).format("HH:mm:ss"),user_id:a.user_id,my_post:!1};if(!1!==s){try{const t=this.player.video.buffered.end(0)-this.player.video.currentTime+.2;await Y.sleep(t)}catch(c){}this.on_comment_received(l),!1===this.player.video.paused&&this.player.danmaku.draw({text:a.content,color:n,type:r,size:o})}else e.push(l)}),{signal:this.abort_controller.signal})}sendComment(t){const e={"#FFEAEA":"white","#F02840":"red","#FD7E80":"pink","#FDA708":"orange","#FFE133":"yellow","#64DD17":"green","#00D4F5":"cyan","#4763FF":"blue"},s={top:"ue",right:"naka",bottom:"shita"},i=Math.round((U()().valueOf()-this.vpos_base_timestamp)/10);if(null===this.watch_session||this.watch_session.readyState!==WebSocket.OPEN)return console.error("[LiveCommentManager][WatchSession] Comment sending failed. (Connection is not established.)"),void t.error("コメントの送信に失敗しました。WebSocket 接続が確立されていません。");this.watch_session.send(JSON.stringify({type:"postComment",data:{text:t.data.text,color:e[t.data.color.toUpperCase()],position:s[t.data.type],size:t.data.size,vpos:i,isAnonymous:!0}}));const a=new AbortController;this.watch_session.addEventListener("message",(e=>{const s=JSON.parse(e.data);switch(s.type){case"postCommentResult":t.success(),a.abort();break;case"error":{let e=`コメントの送信に失敗しました。(${s.data.code})`;switch(s.data.code){case"COMMENT_POST_NOT_ALLOWED":e="コメントが許可されていません。";break;case"INVALID_MESSAGE":e="コメント内容が無効です。";break}console.error(`[LiveCommentManager][WatchSession] Comment sending failed. (Code: ${s.data.code})`),t.error(e),a.abort();break}}}),{signal:a.signal})}async reconnect(){console.warn("[LiveCommentManager][WatchSession] Reconnecting..."),this.player.notice("ニコニコ実況に再接続しています…"),this.destroy();const t=await this.initSession();!1===t.is_success&&(console.error("[LiveCommentManager][WatchSession] Reconnection failed."),this.player.notice(t.detail))}destroy(){this.abort_controller.abort(),this.abort_controller=new AbortController,null!==this.watch_session&&(this.watch_session.close(),this.watch_session=null),null!==this.comment_session&&(this.comment_session.close(),this.comment_session=null),window.clearInterval(this.keep_seat_interval_id),this.keep_seat_interval_id=null,this.vpos_base_timestamp=0,console.log("[LiveCommentManager][WatchSession] Destroyed.")}}var Te=Oe,je=r["default"].extend({name:"Panel-CommentTab",components:{CommentMuteSettings:Se},data(){return{Utils:Y,CommentUtils:E,is_manual_scroll:!1,is_auto_scrolling:!1,comment_list:[],comment_list_element:null,is_comment_list_dropdown_display:!1,comment_list_dropdown_top:0,comment_list_dropdown_comment:null,live_comment_manager:null,initialize_failed_message:null,visibilitychange_listener:null,resize_observer:null,resize_observer_element:null,comment_mute_settings_modal:!1}},computed:Object.assign({},(0,a.Kc)(nt)),created(){this.userStore.fetchUser()},mounted(){null===this.comment_list_element&&(this.comment_list_element=this.$el.querySelector(".comment-list"));let t=!1;this.comment_list_element.onmousedown=e=>{const s=e.clientX-this.comment_list_element.getBoundingClientRect().left;s>this.comment_list_element.clientWidth&&(t=!0)},this.comment_list_element.onmouseup=e=>{const s=e.clientX-this.comment_list_element.getBoundingClientRect().left;s>this.comment_list_element.clientWidth&&(t=!1)};const e=()=>{t=!0,window.setTimeout((()=>t=!1),100)};let s=!1;this.comment_list_element.ontouchstart=()=>s=!0,this.comment_list_element.ontouchend=()=>s=!1,this.comment_list_element.ontouchmove=()=>!0===s?e():"",this.comment_list_element.onwheel=e,this.comment_list_element.onscroll=async()=>{!1===this.is_auto_scrolling&&!0===t&&(this.is_manual_scroll=!0,await Y.sleep(.1),this.comment_list_element.scrollTop+this.comment_list_element.offsetHeight>this.comment_list_element.scrollHeight-10&&(this.is_manual_scroll=!1))}},beforeDestroy(){this.destroy(),null!==this.resize_observer&&this.resize_observer.unobserve(this.resize_observer_element)},methods:{displayCommentListDropdown(t,e){const s=this.$refs.comment_list_wrapper.getBoundingClientRect(),i=76,a=t.currentTarget.getBoundingClientRect();this.comment_list_dropdown_top=a.top-s.top,this.comment_list_dropdown_top+i>s.height&&(this.comment_list_dropdown_top=this.comment_list_dropdown_top-i+a.height),this.comment_list_dropdown_comment=e,this.is_comment_list_dropdown_display=!0},async scrollCommentList(t=!1){if(!0!==this.is_manual_scroll){this.is_auto_scrolling=!0;for(let e=0;e<3;e++)await Y.sleep(.01),!0===t?this.comment_list_element.scrollTo({top:this.comment_list_element.scrollHeight,left:0,behavior:"smooth"}):this.comment_list_element.scrollTo(0,this.comment_list_element.scrollHeight);await Y.sleep(.1),this.is_auto_scrolling=!1}},initReserveObserver(){null!==this.resize_observer&&this.resize_observer.unobserve(this.resize_observer_element),this.resize_observer_element=document.querySelector(".watch-player");let t=null;const e=()=>{const e=document.querySelector(".dplayer-video-wrap-aspect"),s=document.querySelector(".dplayer-danmaku");if(null===this.resize_observer_element||null===this.resize_observer_element.clientHeight)return;if(null===e||null===e.clientHeight)return;const i=(this.resize_observer_element.clientHeight-e.clientHeight)/2,a=Y.isSmartphoneVertical()?0:window.matchMedia("(max-height: 450px)").matches?50:66;if(i<a){const n=2*(a-i),r=e.clientWidth,o=e.clientHeight-n,l=(t,e)=>0===e?t:l(e,t%e),c=l(r,o),_=`${r/c} / ${o/c}`;s.style.transition="none",s.style.setProperty("--comment-area-aspect-ratio",_),s.style.setProperty("--comment-area-vertical-margin",`${n}px`),window.clearTimeout(t),window.setTimeout((()=>{s.style.transition=""}),200)}else s.style.removeProperty("--comment-area-aspect-ratio"),s.style.removeProperty("--comment-area-vertical-margin")};this.resize_observer=new ResizeObserver(e),this.resize_observer.observe(this.resize_observer_element),window.setTimeout(e,600)},async initSession(t,e){this.initReserveObserver();const s=[],i=500;this.live_comment_manager=new Te(t,e,(async t=>{this.comment_list.push(...t),this.scrollCommentList()}),(async t=>{"hidden"!==document.visibilityState?(this.comment_list.length>=i&&!1===this.is_manual_scroll&&this.comment_list.splice(0,Math.max(0,this.comment_list.length-i)),this.comment_list.push(t),this.scrollCommentList()):s.push(t)})),this.visibilitychange_listener=()=>{if("visible"===document.visibilityState){const t=this.comment_list.length+s.length;t>=i&&!1===this.is_manual_scroll&&this.comment_list.splice(0,Math.max(0,t-i)),this.comment_list.push(...s),s.length=0,this.scrollCommentList()}},document.addEventListener("visibilitychange",this.visibilitychange_listener);const a=await this.live_comment_manager.initSession();!1===a.is_success&&(this.initialize_failed_message=a.detail)},sendComment(t){null===this.initialize_failed_message?null!==this.userStore.user?null!==this.userStore.user.niconico_user_id?!1!==this.userStore.user.niconico_user_premium||"top"!==t.data.type&&"bottom"!==t.data.type?!1!==this.userStore.user.niconico_user_premium||"big"!==t.data.size?this.live_comment_manager.sendComment(t):t.error("コメントサイズを大きめに設定するには、ニコニコアカウントのプレミアム会員登録が必要です。"):t.error("コメントを上下に固定するには、ニコニコアカウントのプレミアム会員登録が必要です。"):t.error("コメントするには、ニコニコアカウントと連携してください。"):t.error("コメントするには、KonomiTV アカウントにログインしてください。"):t.error(this.initialize_failed_message)},destroy(){null!==this.visibilitychange_listener&&(document.removeEventListener("visibilitychange",this.visibilitychange_listener),this.visibilitychange_listener=null),null!==this.live_comment_manager&&(this.live_comment_manager.destroy(),this.live_comment_manager=null),this.initialize_failed_message=null,this.comment_list=[]}}}),Ie=je,Pe=(0,p.Z)(Ie,pe,ge,!1,null,"5a711f96",null),Ze=Pe.exports,$e=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"program-container"},[e("section",{staticClass:"program-broadcaster"},[e("img",{staticClass:"program-broadcaster__icon",attrs:{src:`${t.Utils.api_base_url}/channels/${t.channelsStore.channel_id}/logo`}}),e("div",{staticClass:"program-broadcaster__number"},[t._v("Ch: "+t._s(t.channelsStore.channel.current.channel_number))]),e("div",{staticClass:"program-broadcaster__name"},[t._v(t._s(t.channelsStore.channel.current.channel_name))])]),e("section",{staticClass:"program-info"},[e("h1",{staticClass:"program-info__title",domProps:{innerHTML:t._s(t.ProgramUtils.decorateProgramInfo(t.channelsStore.channel.current.program_present,"title"))}}),e("div",{staticClass:"program-info__time"},[t._v(" "+t._s(t.ProgramUtils.getProgramTime(t.channelsStore.channel.current.program_present))+" ")]),e("div",{staticClass:"program-info__description",domProps:{innerHTML:t._s(t.ProgramUtils.decorateProgramInfo(t.channelsStore.channel.current.program_present,"description"))}}),e("div",{staticClass:"program-info__genre-container"},t._l(t.ProgramUtils.getAttribute(t.channelsStore.channel.current.program_present,"genre",[]),(function(s,i){return e("div",{key:i,staticClass:"program-info__genre"},[t._v(" "+t._s(s.major)+" / "+t._s(s.middle)+" ")])})),0),e("div",{staticClass:"program-info__next"},[e("span",{staticClass:"program-info__next-decorate"},[t._v("NEXT")]),e("Icon",{staticClass:"program-info__next-icon",attrs:{icon:"fluent:fast-forward-20-filled",width:"16px"}})],1),e("span",{staticClass:"program-info__next-title",domProps:{innerHTML:t._s(t.ProgramUtils.decorateProgramInfo(t.channelsStore.channel.current.program_following,"title"))}}),e("div",{staticClass:"program-info__next-time"},[t._v(" "+t._s(t.ProgramUtils.getProgramTime(t.channelsStore.channel.current.program_following))+" ")]),e("div",{staticClass:"program-info__status"},[e("div",{staticClass:"program-info__status-force",class:`program-info__status-force--${t.ChannelUtils.getChannelForceType(t.channelsStore.channel.current.channel_force)}`},[e("Icon",{attrs:{icon:"fa-solid:fire-alt",height:"14px"}}),e("span",{staticClass:"ml-2"},[t._v("勢い:")]),e("span",{staticClass:"ml-2"},[t._v(t._s(t.ProgramUtils.getAttribute(t.channelsStore.channel.current,"channel_force","--"))+" コメ/分")])],1),e("div",{staticClass:"program-info__status-viewers ml-5"},[e("Icon",{attrs:{icon:"fa-solid:eye",height:"14px"}}),e("span",{staticClass:"ml-2"},[t._v("視聴数:")]),e("span",{staticClass:"ml-1"},[t._v(t._s(t.channelsStore.channel.current.viewers))])],1)])]),e("section",{staticClass:"program-detail-container"},t._l(t.ProgramUtils.getAttribute(t.channelsStore.channel.current.program_present,"detail",{}),(function(s,i){return e("div",{key:i,staticClass:"program-detail"},[e("h2",{staticClass:"program-detail__heading"},[t._v(t._s(i))]),e("div",{staticClass:"program-detail__text",domProps:{innerHTML:t._s(t.Utils.URLtoLink(s))}})])})),0)])},ze=[],Ae=r["default"].extend({name:"Panel-ProgramTab",data(){return{Utils:Y,ChannelUtils:K,ProgramUtils:W}},computed:Object.assign({},(0,a.Kc)(Vt))}),De=Ae,Be=(0,p.Z)(De,$e,ze,!1,null,"c9f3c3f2",null),Ke=Be.exports,Ne=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"twitter-container"},[e(Xt.Z,{attrs:{"content-class":"zoom-capture-modal-container","max-width":"980",transition:"slide-y-transition"},model:{value:t.zoom_capture_modal,callback:function(e){t.zoom_capture_modal=e},expression:"zoom_capture_modal"}},[e("div",{staticClass:"zoom-capture-modal"},[e("img",{staticClass:"zoom-capture-modal__image",attrs:{src:t.zoom_capture?t.zoom_capture.image_url:""}}),e("a",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"zoom-capture-modal__download",attrs:{href:t.zoom_capture?t.zoom_capture.image_url:"",download:t.zoom_capture?t.zoom_capture.filename:""}},[e("Icon",{attrs:{icon:"fa6-solid:download",width:"45px"}})],1)])]),e("div",{staticClass:"tab-container"},[e("div",{staticClass:"tab-content",class:{"tab-content--active":"Capture"===t.twitter_active_tab}},[e("div",{staticClass:"captures"},t._l(t.captures,(function(s){return e("div",{key:s.image_url,staticClass:"capture",class:{"capture--selected":s.selected,"capture--focused":s.focused,"capture--disabled":!s.selected&&t.tweet_captures.length>=4},on:{click:function(e){return t.clickCapture(s)}}},[e("img",{staticClass:"capture__image",attrs:{src:s.image_url}}),e("div",{staticClass:"capture__disabled-cover"}),e("div",{staticClass:"capture__selected-number"},[t._v(t._s(t.tweet_captures.findIndex((t=>t===s.blob))+1))]),e("Icon",{staticClass:"capture__selected-checkmark",attrs:{icon:"fluent:checkmark-circle-16-filled"}}),e("div",{staticClass:"capture__selected-border"}),e("div",{staticClass:"capture__focused-border"}),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"capture__zoom",on:{click:function(e){e.preventDefault(),e.stopPropagation(),t.zoom_capture_modal=!0,t.zoom_capture=s},mousedown:function(t){t.preventDefault(),t.stopPropagation()}}},[e("Icon",{attrs:{icon:"fluent:zoom-in-16-regular",width:"32px"}})],1)],1)})),0),e("div",{directives:[{name:"show",rawName:"v-show",value:0===t.captures.length,expression:"captures.length === 0"}],staticClass:"capture-announce"},[e("div",{staticClass:"capture-announce__heading"},[t._v("まだキャプチャがありません。")]),t._m(0)])])]),e("div",{staticClass:"tab-button-container"},[e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"tab-button",class:{"tab-button--active":"Search"===t.twitter_active_tab},on:{click:function(e){t.twitter_active_tab="Search"}}},[e("Icon",{attrs:{icon:"fluent:search-16-filled",height:"18px"}}),e("span",{staticClass:"tab-button__text"},[t._v("ツイート検索")])],1),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"tab-button",class:{"tab-button--active":"Timeline"===t.twitter_active_tab},on:{click:function(e){t.twitter_active_tab="Timeline"}}},[e("Icon",{attrs:{icon:"fluent:home-16-regular",height:"18px"}}),e("span",{staticClass:"tab-button__text"},[t._v("タイムライン")])],1),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"tab-button",class:{"tab-button--active":"Capture"===t.twitter_active_tab},on:{click:function(e){t.twitter_active_tab="Capture"}}},[e("Icon",{attrs:{icon:"fluent:image-copy-20-regular",height:"18px"}}),e("span",{staticClass:"tab-button__text"},[t._v("キャプチャ")])],1)]),e("div",{staticClass:"tweet-form",class:{"tweet-form--focused":t.is_tweet_hashtag_form_focused||t.is_tweet_text_form_focused,"tweet-form--virtual-keyboard-display":t.is_virtual_keyboard_display&&(t.Utils.hasActiveElementClass("tweet-form__hashtag-form")||t.Utils.hasActiveElementClass("tweet-form__textarea"))&&(()=>(t.is_hashtag_list_display=!1,!0))()}},[e("div",{staticClass:"tweet-form__hashtag"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.tweet_hashtag,expression:"tweet_hashtag"}],staticClass:"tweet-form__hashtag-form",attrs:{type:"search",placeholder:"#ハッシュタグ",spellcheck:"false"},domProps:{value:t.tweet_hashtag},on:{input:[function(e){e.target.composing||(t.tweet_hashtag=e.target.value)},function(e){return t.updateTweetLetterCount()}],focus:function(e){t.is_tweet_hashtag_form_focused=!0},blur:function(e){t.is_tweet_hashtag_form_focused=!1},change:function(e){t.tweet_hashtag=t.formatHashtag(t.tweet_hashtag)}}}),e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"tweet-form__hashtag-list-button",on:{click:function(e){return t.clickHashtagListButton()}}},[e("Icon",{attrs:{icon:"fluent:clipboard-text-ltr-32-regular",height:"22px"}})],1)]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tweet_text,expression:"tweet_text"}],ref:"tweet_text",staticClass:"tweet-form__textarea",attrs:{placeholder:"ツイート",spellcheck:"false"},domProps:{value:t.tweet_text},on:{input:[function(e){e.target.composing||(t.tweet_text=e.target.value)},function(e){return t.updateTweetLetterCount()}],paste:function(e){return t.pasteClipboardData(e)},focus:function(e){t.is_tweet_text_form_focused=!0},blur:function(e){t.is_tweet_text_form_focused=!1}}}),e("div",{staticClass:"tweet-form__control"},[e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"account-button",class:{"account-button--no-login":!t.is_logged_in_twitter},on:{click:function(e){return t.clickAccountButton()}}},[e("img",{staticClass:"account-button__icon",attrs:{src:t.is_logged_in_twitter?t.selected_twitter_account.icon_url:"/assets/images/account-icon-default.png"}}),e("span",{staticClass:"account-button__screen-name"},[t._v(" "+t._s(t.is_logged_in_twitter?`@${t.selected_twitter_account.screen_name}`:"連携されていません")+" ")]),e("Icon",{staticClass:"account-button__menu",attrs:{icon:"fluent:more-circle-20-regular",width:"22px"}})],1),e("div",{staticClass:"limit-meter"},[e("div",{staticClass:"limit-meter__content",class:{"limit-meter__content--yellow":t.tweet_letter_count<=20,"limit-meter__content--red":t.tweet_letter_count<=0}},[e("Icon",{staticStyle:{"margin-right":"-2px"},attrs:{icon:"fa-brands:twitter",width:"12px"}}),e("span",[t._v(t._s(t.tweet_letter_count))])],1),e("div",{staticClass:"limit-meter__content"},[e("Icon",{attrs:{icon:"fluent:image-16-filled",width:"14px"}}),e("span",[t._v(t._s(t.tweet_captures.length)+"/4")])],1)]),e("button",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"tweet-button",attrs:{disabled:!t.is_logged_in_twitter||t.tweet_letter_count<0||140===t.tweet_letter_count&&0===t.tweet_captures.length},on:{click:function(e){return t.sendTweet()}}},[e("Icon",{attrs:{icon:"fa-brands:twitter",height:"16px"}}),e("span",{staticClass:"ml-1"},[t._v("ツイート")])],1)])]),e("div",{staticClass:"hashtag-list",class:{"hashtag-list--display":t.is_hashtag_list_display,"hashtag-list--virtual-keyboard-display":t.is_virtual_keyboard_display&&t.Utils.hasActiveElementClass("hashtag__input")}},[e("div",{staticClass:"hashtag-heading"},[e("div",{staticClass:"hashtag-heading__text"},[e("Icon",{attrs:{icon:"charm:hash",width:"17px"}}),e("span",{staticClass:"ml-1"},[t._v("ハッシュタグリスト")])],1),e("button",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"hashtag-heading__add-button",on:{click:function(e){t.saved_twitter_hashtags.push({id:t.Utils.time(),text:"#ここにハッシュタグを入力",editing:!1})}}},[e("Icon",{attrs:{icon:"fluent:add-12-filled",width:"17px"}}),e("span",{staticClass:"ml-1"},[t._v("追加")])],1)]),e("draggable",{staticClass:"hashtag-container",attrs:{handle:".hashtag__sort-handle"},model:{value:t.saved_twitter_hashtags,callback:function(e){t.saved_twitter_hashtags=e},expression:"saved_twitter_hashtags"}},t._l(t.saved_twitter_hashtags,(function(s){return e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple",value:!s.editing,expression:"!hashtag.editing"}],key:s.id,staticClass:"hashtag",class:{"hashtag--editing":s.editing},on:{click:function(e){return t.clickHashtag(s)}}},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.text,expression:"hashtag.text"}],staticClass:"hashtag__input",attrs:{type:"search",spellcheck:"false",disabled:!s.editing},domProps:{value:s.text},on:{click:function(t){t.stopPropagation()},input:function(e){e.target.composing||t.$set(s,"text",e.target.value)}}}),e("button",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"hashtag__edit-button",on:{click:function(e){e.preventDefault(),e.stopPropagation(),s.editing=!s.editing,s.text=t.formatHashtag(s.text,!0)}}},[e("Icon",{attrs:{icon:s.editing?"fluent:checkmark-16-filled":"fluent:edit-16-filled",width:"17px"}})],1),e("button",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"hashtag__delete-button",on:{click:function(e){e.preventDefault(),e.stopPropagation(),t.saved_twitter_hashtags.splice(t.saved_twitter_hashtags.indexOf(s),1)}}},[e("Icon",{attrs:{icon:"fluent:delete-16-filled",width:"17px"}})],1),e("div",{staticClass:"hashtag__sort-handle"},[e("Icon",{attrs:{icon:"material-symbols:drag-handle-rounded",width:"17px"}})],1)])})),0)],1),e("div",{staticClass:"twitter-account-list",class:{"twitter-account-list--display":t.is_twitter_account_list_display}},t._l(t.userStore.user?t.userStore.user.twitter_accounts:[],(function(s){return e("div",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],key:s.id,staticClass:"twitter-account",on:{click:function(e){return t.updateSelectedTwitterAccount(s)}}},[e("img",{staticClass:"twitter-account__icon",attrs:{src:s.icon_url}}),e("div",{staticClass:"twitter-account__info"},[e("div",{staticClass:"twitter-account__name"},[t._v(t._s(s.name))]),e("div",{staticClass:"twitter-account__screen-name"},[t._v("@"+t._s(s.screen_name))])]),e("Icon",{directives:[{name:"show",rawName:"v-show",value:s.id===t.settingsStore.settings.selected_twitter_account_id,expression:"twitter_account.id === settingsStore.settings.selected_twitter_account_id"}],staticClass:"twitter-account__check",attrs:{icon:"fluent:checkmark-16-filled",width:"24px"}})],1)})),0)],1)},Ee=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"capture-announce__text"},[e("p",{staticClass:"mt-0 mb-0"},[t._v("プレイヤーのキャプチャボタンやショートカットキーでキャプチャを撮ると、ここに表示されます。")]),e("p",{staticClass:"mt-2 mb-0"},[t._v("表示されたキャプチャを選択してからツイートすると、キャプチャを付けてツイートできます。")])])}],Le=s(9980),He=s.n(Le);class Ue{static async fetchAuthorizationURL(){const t=await Z.get("/twitter/auth");return"is_error"in t?(Z.showGenericError(t,"Twitter アカウントとの連携用の認証 URL を取得できませんでした。"),null):t.data.authorization_url}static async logoutAccount(t){const e=await Z["delete"](`/twitter/accounts/${t}`);return!("is_error"in e)||(Z.showGenericError(e,"Twitter アカウントとの連携を解除できませんでした。"),!1)}static async sendTweet(t,e,s){const i=new FormData;i.append("tweet",e);for(const n of s)i.append("images",n);const a=await Z.post(`/twitter/accounts/${t}/tweets`,i,{headers:{"Content-Type":"multipart/form-data"}});return"is_error"in a?{message:"エラー: ツイートの送信に失敗しました。",is_error:!0}:!0===a.data.is_success?{message:a.data.detail,is_error:!1}:{message:`エラー: ${a.data.detail}`,is_error:!0}}}var Ve=Ue,Me=r["default"].extend({name:"Panel-TwitterTab",components:{draggable:He()},props:{player:{type:null,required:!0},is_virtual_keyboard_display:{type:Boolean,required:!0}},data(){return{Utils:Y,is_logged_in_twitter:!1,selected_twitter_account:null,is_twitter_account_list_display:!1,saved_twitter_hashtags:it().settings.saved_twitter_hashtags.map(((t,e)=>({id:Y.time()+e,text:t,editing:!1}))),is_hashtag_list_display:!1,twitter_active_tab:it().settings.twitter_active_tab,zoom_capture_modal:!1,zoom_capture:null,captures:[],captures_element:null,is_tweet_hashtag_form_focused:!1,is_tweet_text_form_focused:!1,tweet_hashtag:"",tweet_text:"",tweet_captures:[],tweet_letter_count:140}},computed:Object.assign({},(0,a.Kc)(Vt,it,nt)),async created(){if(await this.userStore.fetchUser(),!0===this.userStore.is_logged_in&&this.userStore.user.twitter_accounts.length>0){this.is_logged_in_twitter=!0,null!==this.settingsStore.settings.selected_twitter_account_id&&this.userStore.user.twitter_accounts.some((t=>t.id===this.settingsStore.settings.selected_twitter_account_id))||(this.settingsStore.settings.selected_twitter_account_id=this.userStore.user.twitter_accounts[0].id);const t=this.userStore.user.twitter_accounts.findIndex((t=>t.id===this.settingsStore.settings.selected_twitter_account_id));this.selected_twitter_account=this.userStore.user.twitter_accounts[t]}this.tweet_hashtag=this.formatHashtag(this.tweet_hashtag)},beforeDestroy(){for(const t of this.captures)URL.revokeObjectURL(t.image_url)},watch:{saved_twitter_hashtags:{deep:!0,handler(){this.settingsStore.settings.saved_twitter_hashtags=this.saved_twitter_hashtags.map((t=>t.text))}}},methods:{updateTweetLetterCount(){this.tweet_letter_count=140-[...this.tweet_hashtag].length-[...this.tweet_text].length},pasteClipboardData(t){for(const e of t.clipboardData.items)if(e.type.startsWith("image/")){const t=e.getAsFile();this.addCaptureList(t,t.name)}},clickHashtagListButton(){this.is_hashtag_list_display=!this.is_hashtag_list_display;for(const t of this.saved_twitter_hashtags)t.editing=!1},clickHashtag(t){this.tweet_hashtag=t.text,this.tweet_hashtag=this.formatHashtag(this.tweet_hashtag),this.updateTweetLetterCount(),window.setTimeout((()=>this.is_hashtag_list_display=!1),150)},clickAccountButton(){if(!this.is_logged_in_twitter)return document.fullscreenElement&&document.exitFullscreen(),void this.$router.push({path:"/settings/twitter"});this.is_twitter_account_list_display=!this.is_twitter_account_list_display,!0===this.is_twitter_account_list_display&&(this.is_hashtag_list_display=!1)},updateSelectedTwitterAccount(t){this.settingsStore.settings.selected_twitter_account_id=t.id,this.selected_twitter_account=t,window.setTimeout((()=>this.is_twitter_account_list_display=!1),150)},clickCapture(t){if(this.tweet_captures.length<4&&!1===t.selected)t.selected=!0,this.tweet_captures.push(t.blob);else{const e=this.tweet_captures.findIndex((e=>e===t.blob));e>-1&&this.tweet_captures.splice(e,1),t.selected=!1}},async addCaptureList(t,e){null===this.captures_element&&(this.captures_element=this.$el.querySelector(".tab-content")),this.captures.length>50&&(URL.revokeObjectURL(this.captures[0].image_url),this.captures.shift());const s=URL.createObjectURL(t);this.captures.push({blob:t,filename:e,image_url:s,selected:!1,focused:!1}),this.$nextTick((()=>{this.captures_element.scrollTo({top:this.captures_element.scrollHeight,behavior:"smooth"})}))},async drawProgramTitleOnCapture(t){const e=await createImageBitmap(t),s="OffscreenCanvas"in window?new OffscreenCanvas(e.width,e.height):document.createElement("canvas"),i=s.getContext("2d",{alpha:!1,desynchronized:!0,willReadFrequently:!1});i.drawImage(e,0,0),e.close(),i.font="bold 22px 'YakuHanJPs', 'Open Sans', 'Hiragino Sans', 'Noto Sans JP', sans-serif",i.fillStyle="rgba(255, 255, 255, 70%)",i.shadowColor="rgba(0, 0, 0, 100%)",i.shadowBlur=4,i.shadowOffsetX=0,i.shadowOffsetY=0;const a=this.channelsStore.channel.current.program_present.title;switch(this.settingsStore.settings.tweet_capture_watermark_position){case"TopLeft":i.textAlign="left",i.textBaseline="top",i.fillText(a,16,12);break;case"TopRight":i.textAlign="right",i.textBaseline="top",i.fillText(a,s.width-16,12);break;case"BottomLeft":i.textAlign="left",i.textBaseline="bottom",i.fillText(a,16,s.height-12);break;case"BottomRight":i.textAlign="right",i.textBaseline="bottom",i.fillText(a,s.width-16,s.height-12);break}return s instanceof OffscreenCanvas?await s.convertToBlob({type:"image/jpeg",quality:1}):new Promise((t=>s.toBlob((e=>t(e)),"image/jpeg",1)))},getChannelHashtag(t){return t.startsWith("NHK総合")?"#nhk":t.startsWith("NHKEテレ")?"#etv":t.startsWith("日テレ")?"#ntv":t.startsWith("読売テレビ")?"#ytv":t.startsWith("中京テレビ")?"#chukyotv":t.startsWith("テレビ朝日")?"#tvasahi":t.startsWith("ABCテレビ")?"#abc":t.startsWith("メ~テレ")?"#nagoyatv":t.startsWith("TBS")&&!t.includes("TBSチャンネル")?"#tbs":t.startsWith("MBS")?"#mbs":t.startsWith("CBC")?"#cbc":t.startsWith("テレビ東京")?"#tvtokyo":t.startsWith("テレビ大阪")?"#tvo":t.startsWith("テレビ愛知")?"#tva":t.startsWith("フジテレビ")?"#fujitv":t.startsWith("関西テレビ")?"#kantele":t.startsWith("東海テレビ")?"#tokaitv":t.startsWith("TOKYO MX")?"#tokyomx":t.startsWith("tvk")?"#tvk":t.startsWith("チバテレ")?"#chibatv":t.startsWith("テレ玉")?"#teletama":t.startsWith("サンテレビ")?"#suntv":t.startsWith("KBS京都")?"#kbs":t.startsWith("NHKBS1")?"#nhkbs1":t.startsWith("NHKBSプレミアム")?"#nhkbsp":t.startsWith("BS日テレ")?"#bsntv":t.startsWith("BS朝日")?"#bsasahi":t.startsWith("BS-TBS")?"#bstbs":t.startsWith("BSテレ東")?"#bstvtokyo":t.startsWith("BSフジ")?"#bsfuji":t.startsWith("BS11イレブン")?"#bs11":t.startsWith("BS12トゥエルビ")?"#bs12":t.startsWith("AT-X")?"#at_x":null},formatHashtag(t,e=!1){const s=t.trim().replaceAll("♯","#").replaceAll("＃","#").replace(/#{2,}/g,"#").replaceAll("　"," ").replaceAll(/ +/g," ").split(" ").filter((t=>""!==t));for(let i in s)s[i].startsWith("#")||(s[i]=`#${s[i]}`);if(!0===this.settingsStore.settings.auto_add_watching_channel_hashtag&&!1===e){const t=this.getChannelHashtag(this.channelsStore.channel.current.channel_name);null!==t&&!1===s.includes(t)&&s.push(t)}return s.join(" ")},async sendTweet(){this.tweet_hashtag=this.formatHashtag(this.tweet_hashtag);const t=this.tweet_hashtag;let e=this.tweet_text;if(""!==t)switch(this.settingsStore.settings.tweet_hashtag_position){case"Prepend":e=`${t} ${this.tweet_text}`;break;case"Append":e=`${this.tweet_text} ${t}`;break;case"PrependWithLineBreak":e=`${t}\n${this.tweet_text}`;break;case"AppendWithLineBreak":e=`${this.tweet_text}\n${t}`;break}const s=[];for(let i of this.tweet_captures)"None"!==this.settingsStore.settings.tweet_capture_watermark_position&&(i=await this.drawProgramTitleOnCapture(i)),s.push(i);Ve.sendTweet(this.selected_twitter_account.screen_name,e,s).then((t=>{this.player.notice(t.message)}));for(const i of this.captures)i.selected=!1,i.focused=!1;this.tweet_captures=[],this.tweet_text="",!0===this.settingsStore.settings.fold_panel_after_sending_tweet&&(this.$emit("panel_folding_requested"),this.$refs.tweet_text.blur())}}}),Re=Me,Fe=(0,p.Z)(Re,Ne,Ee,!1,null,"4d473ab3",null),Ge=Fe.exports,qe=(s(3462),s(9908)),We=s(8488);class Ye{static async uploadCapture(t,e){const s=new FormData;s.append("image",t,e);const i=await Z.post("/captures",s,{headers:{"Content-Type":"multipart/form-data"}});"is_error"in i&&Z.showGenericError(i,"キャプチャのアップロードに失敗しました。")}}var Xe=Ye;class Je{constructor(t,e){this.settings_store=it(),this.player=t,this.player_container=this.player.container,this.captured_callback=e,this.player_container.querySelector(".dplayer-icons.dplayer-icons-right").insertAdjacentHTML("afterbegin",'\n            <div class="dplayer-icon dplayer-comment-capture-icon" aria-label="コメントを付けてキャプチャ"\n                data-balloon-nofocus="" data-balloon-pos="up">\n                <span class="dplayer-icon-content">\n                    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z"></path></svg>\n                </span>\n            </div>\n        '),this.player_container.querySelector(".dplayer-icons.dplayer-icons-right").insertAdjacentHTML("afterbegin",'\n            <div class="dplayer-icon dplayer-capture-icon" aria-label="キャプチャ"\n                data-balloon-nofocus="" data-balloon-pos="up">\n                <span class="dplayer-icon-content">\n                    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z"></path></svg>\n                </span>\n            </div>\n        '),this.comment_capture_button=this.player_container.querySelector(".dplayer-comment-capture-icon"),this.capture_button=this.player_container.querySelector(".dplayer-capture-icon"),this.canvas="OffscreenCanvas"in window?new OffscreenCanvas(0,0):document.createElement("canvas"),this.canvas_context=this.canvas.getContext("2d",{alpha:!1,desynchronized:!0,willReadFrequently:!1}),this.canvas.width=0,this.canvas.height=0,t.on("loadedmetadata",(async()=>{this.canvas.width=t.video.videoWidth,this.canvas.height=t.video.videoHeight;while(0===this.canvas.width&&0===this.canvas.height)await Y.sleep(.1),this.canvas.width=t.video.videoWidth,this.canvas.height=t.video.videoHeight}))}async captureAndSave(t,e){const s=Y.time();if(!0===t.is_radiochannel)return void this.player.notice("ラジオチャンネルはキャプチャできません。");if(0===this.canvas.width&&0===this.canvas.height)return void this.player.notice("読み込み中はキャプチャできません。");if(!0===e&&!1===this.player.danmaku.showing)return void this.player.notice("コメントを付けてキャプチャするには、コメント表示をオンにしてください。");this.addHighlight(e);const i=`Capture_${U()().format("YYYYMMDD-HHmmss")}`,a=`${i}.jpg`,n=`${i}_caption.jpg`,r=this.player.plugins.aribb24Caption.getRawCanvas(),o=this.player.plugins.aribb24Superimpose.getRawCanvas(),l=!0===this.player.plugins.aribb24Caption.isShowing&&this.player.plugins.aribb24Caption.isPresent(),c=!0===this.player.plugins.aribb24Superimpose.isShowing&&this.player.plugins.aribb24Superimpose.isPresent(),_=l?this.player.plugins.aribb24Caption.getTextContent():null,d=async(t,e,s,i,a,n)=>{const r=Y.time();let o;try{o=await this.exportToBlob(t)}catch(l){return console.log(l),this.player.notice("キャプチャの保存に失敗しました…"),!1}return console.log("[PlayerCaptureHandler] Export to Blob:",Y.mathFloor(Y.time()-r,3),"sec"),o=await this.setEXIFDataToCapture(o,s,i,a,n),["Browser","Both"].includes(this.settings_store.settings.capture_save_mode)&&Y.downloadBlobData(o,e),["UploadServer","Both"].includes(this.settings_store.settings.capture_save_mode)&&Xe.uploadCapture(o,e),o};let u=null,m=null;const h=await createImageBitmap(this.player.video);if(!1!==e||!1!==c||!1!==l&&"VideoOnly"!==this.settings_store.settings.capture_caption_mode){const s=[];this.canvas_context.drawImage(h,0,0,this.canvas.width,this.canvas.height),!0===c&&this.canvas_context.drawImage(o,0,0,this.canvas.width,this.canvas.height);let i=null;!0===e&&(i=await this.createCommentsImage(),await this.drawComments(i)),(["VideoOnly","Both"].includes(this.settings_store.settings.capture_caption_mode)||!1===l)&&s.push((async()=>{const s="CompositingCaption"===this.settings_store.settings.capture_caption_mode?n:a,i=await d(this.canvas,s,t.program_present,_,!1,e);u=!1!==i&&{blob:i,filename:s},!1!==u&&this.captured_callback(u.blob,u.filename)})()),["CompositingCaption","Both"].includes(this.settings_store.settings.capture_caption_mode)&&!0===l&&s.push((async()=>{!0===e&&(this.canvas_context.drawImage(h,0,0,this.canvas.width,this.canvas.height),!0===c&&this.canvas_context.drawImage(o,0,0,this.canvas.width,this.canvas.height)),h.close(),this.canvas_context.drawImage(r,0,0,this.canvas.width,this.canvas.height),!0===e&&await this.drawComments(i);const s=await d(this.canvas,n,t.program_present,_,!0,e);if(m=!1!==s&&{blob:s,filename:n},!1!==m){if("Both"===this.settings_store.settings.capture_caption_mode)while(null===u)await Y.sleep(.01);this.captured_callback(m.blob,m.filename)}})()),await Promise.all(s)}else{const s="OffscreenCanvas"in window?new OffscreenCanvas(h.width,h.height):document.createElement("canvas");s.width=h.width,s.height=h.height;const i=s.getContext("bitmaprenderer",{alpha:!1});i.transferFromImageBitmap(h),h.close();const r="CompositingCaption"===this.settings_store.settings.capture_caption_mode?n:a,o=await d(s,r,t.program_present,_,!1,e);u=!1!==o&&{blob:o,filename:r},!1!==u&&this.captured_callback(u.blob,u.filename)}console.log("[PlayerCaptureHandler] Total:",Y.mathFloor(Y.time()-s,3),"sec"),this.removeHighlight(e);for(const g of[u,m])if(this.settings_store.settings.capture_copy_to_clipboard&&null!==g&&!1!==g)try{await(0,qe.FH)(await(0,qe.BD)(g.blob))}catch(p){this.player.notice("クリップボードへのキャプチャのコピーに失敗しました…"),console.error(p)}}addHighlight(t=!1){t?this.comment_capture_button.classList.add("dplayer-capturing"):this.capture_button.classList.add("dplayer-capturing")}removeHighlight(t=!1){t?this.comment_capture_button.classList.remove("dplayer-capturing"):this.capture_button.classList.remove("dplayer-capturing")}async commentsHTMLtoSVGImage(t,e,s){const i=`\n            <svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${s}">\n                <foreignObject width="100%" height="100%">\n                    <div xmlns="http://www.w3.org/1999/xhtml">\n                        <style>\n                        .dplayer-danmaku {\n                            position: absolute;\n                            top: 0;\n                            left: 0;\n                            right: 0;\n                            bottom: 0;\n                            color: #fff;\n                            font-size: 29px;\n                            font-family: 'YakuHanJPs', 'Open Sans', 'Hiragino Sans', 'Noto Sans JP', sans-serif;\n                        }\n                        .dplayer-danmaku .dplayer-danmaku-item {\n                            display: inline-block;\n                            line-height: 1;\n                            font-weight: bold;\n                            font-size: var(--dplayer-danmaku-font-size);\n                            opacity: var(--dplayer-danmaku-opacity);\n                            text-shadow: 1.2px 1.2px 4px rgba(0, 0, 0, 0.9);\n                            white-space: nowrap;\n                        }\n                        .dplayer-danmaku .dplayer-danmaku-item--demo {\n                            position: absolute;\n                            visibility: hidden;\n                        }\n                        .dplayer-danmaku .dplayer-danmaku-item span {\n                            box-decoration-break: clone;\n                            -webkit-box-decoration-break: clone;\n                        }\n                        .dplayer-danmaku .dplayer-danmaku-item.dplayer-danmaku-size-big {\n                            font-size: calc(var(--dplayer-danmaku-font-size) * 1.25);\n                        }\n                        .dplayer-danmaku .dplayer-danmaku-item.dplayer-danmaku-size-small {\n                            font-size: calc(var(--dplayer-danmaku-font-size) * 0.8);\n                        }\n                        .dplayer-danmaku .dplayer-danmaku-right {\n                            position: absolute;\n                            right: 0;\n                        }\n                        .dplayer-danmaku .dplayer-danmaku-top, .dplayer-danmaku .dplayer-danmaku-bottom {\n                            position: absolute;\n                            left: 50%;\n                            transform: translateX(-50%);\n                        }\n                        </style>\n                        ${t}\n                    </div>\n                </foreignObject>\n            </svg>\n        `.trim(),a=new Image;return a.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(i)}`,await a.decode(),a}async createCommentsImage(){let t=this.player.template.danmaku.outerHTML;for(const e of this.player_container.querySelectorAll(".dplayer-danmaku-move")){const s=e.getBoundingClientRect().left-this.player.video.getBoundingClientRect().left;t=t.replace(/transform: translateX\(.*?\);/,`left: ${s}px;`).replaceAll("border: 2px solid #E64F97;","")}return await this.commentsHTMLtoSVGImage(t,this.player.template.danmaku.offsetWidth,this.player.template.danmaku.offsetHeight)}async drawComments(t){const e=this.canvas.width/this.player.template.danmaku.offsetWidth,s=this.player.template.danmaku.offsetHeight*e;this.canvas_context.drawImage(t,0,0,this.canvas.width,s)}async exportToBlob(t){return"OffscreenCanvas"in window&&t instanceof OffscreenCanvas?await t.convertToBlob({type:"image/jpeg",quality:.99}):t instanceof HTMLCanvasElement?new Promise(((e,s)=>{t.toBlob((t=>{null!==t?e(t):s(new Error("Failed to convert canvas to blob"))}),"image/jpeg",.99)})):void 0}async setEXIFDataToCapture(t,e,s,i,a){const n=U()().diff(U()(e.start_time),"second",!0),r={captured_at:U()().format("YYYY-MM-DDTHH:mm:ss+09:00"),captured_playback_position:n,network_id:e.network_id,service_id:e.service_id,event_id:e.event_id,title:e.title,description:e.description,start_time:e.start_time,end_time:e.end_time,duration:e.duration,caption_text:s,is_caption_composited:i,is_comment_composited:a},o=U()().format("YYYY:MM:DD HH:mm:ss"),l={"0th":{[We.TagValues.ImageIFD.XResolution]:[72,1],[We.TagValues.ImageIFD.YResolution]:[72,1],[We.TagValues.ImageIFD.ResolutionUnit]:2,[We.TagValues.ImageIFD.YCbCrPositioning]:1,[We.TagValues.ImageIFD.DateTime]:o,[We.TagValues.ImageIFD.Software]:`KonomiTV version ${Y.version}`,[We.TagValues.ImageIFD.XPComment]:[...N.lW.from(JSON.stringify(r),"ucs2")]},Exif:{[We.TagValues.ExifIFD.ExifVersion]:"0230",[We.TagValues.ExifIFD.ComponentsConfiguration]:"\0",[We.TagValues.ExifIFD.FlashpixVersion]:"0100",[We.TagValues.ExifIFD.ColorSpace]:1,[We.TagValues.ExifIFD.DateTimeOriginal]:o,[We.TagValues.ExifIFD.DateTimeDigitized]:o}},c=We.dump(l),_=await new Promise(((e,s)=>{const i=new FileReader;i.onload=()=>e(i.result),i.onerror=s,i.readAsBinaryString(t)})),d=We.insert(c,_),u=new Uint8Array(d.length);for(let m=0;m<u.length;m++)u[m]=255&d.charCodeAt(m);return new Blob([u],{type:t.type})}}var Qe=Je;const ts=.6,es=5;var ss=r["default"].extend({name:"TV-Watch",components:{BottomNavigation:Zt,Channel:de,Comment:Ze,Program:Ke,Twitter:Ge},data(){return{Utils:Y,ProgramUtils:W,time:U()().format("YYYY/MM/DD HH:mm:ss"),tv_panel_active_tab:it().settings.tv_panel_active_tab,background_url:"",is_loading:!0,is_video_buffering:!0,is_background_display:!1,is_control_display:!0,is_panel_display:(()=>{const t=it();switch(t.settings.panel_display_state){case"AlwaysDisplay":return!0;case"AlwaysFold":return!1;case"RestorePreviousState":return t.settings.showed_panel_last_time}})(),is_fullscreen:!1,is_ime_composing:!1,is_virtual_keyboard_display:!1,is_comment_send_just_did:!1,interval_ids:[],control_interval_id:0,is_zapping:!1,is_zapping_continuously:!1,player:null,player_can_be_destroyed:!1,is_mpegts_supported:!0===ne().isSupported(),romsounds_context:null,romsounds_buffers:[],eventsource:null,fullscreen_handler:null,capture_handler:null,shortcut_key_handler:null,shortcut_key_pressed_at:Y.time(),shortcut_key_modal:!1,shortcut_key_list:{left_column:[{name:"全般",icon:"fluent:home-20-filled",icon_height:"22px",shortcuts:[{name:"数字キー・テンキーに対応するリモコン番号 (1~12) の地デジチャンネルに切り替える",keys:[{name:"1~9, 0, -(=), ^(~)",icon:!1}]},{name:"数字キー・テンキーに対応するリモコン番号 (1~12) の BS チャンネルに切り替える",keys:[{name:"Shift",icon:!1},{name:"1~9, 0, -(=), ^(~)",icon:!1}]},{name:"前のチャンネルに切り替える",keys:[{name:"fluent:arrow-up-12-filled",icon:!0}]},{name:"次のチャンネルに切り替える",keys:[{name:"fluent:arrow-down-12-filled",icon:!0}]},{name:"キーボードショートカットの一覧を表示する",keys:[{name:"／(？)",icon:!1}]}]},{name:"プレイヤー",icon:"fluent:play-20-filled",icon_height:"20px",shortcuts:[{name:"再生 / 一時停止の切り替え",keys:[{name:"Space",icon:!1}]},{name:"再生 / 一時停止の切り替え (キャプチャタブ表示時)",keys:[{name:"Shift",icon:!1},{name:"Space",icon:!1}]},{name:"プレイヤーの音量を上げる",keys:[{name:Y.CtrlOrCmd(),icon:!1},{name:"fluent:arrow-up-12-filled",icon:!0}]},{name:"プレイヤーの音量を下げる",keys:[{name:Y.CtrlOrCmd(),icon:!1},{name:"fluent:arrow-down-12-filled",icon:!0}]},{name:"停止して0.5秒早戻し",keys:[{name:Y.CtrlOrCmd(),icon:!1},{name:"fluent:arrow-left-12-filled",icon:!0}]},{name:"停止して0.5秒早送り",keys:[{name:Y.CtrlOrCmd(),icon:!1},{name:"fluent:arrow-right-12-filled",icon:!0}]},{name:"フルスクリーンの切り替え",keys:[{name:"F",icon:!1}]},{name:"ライブストリームの同期",keys:[{name:"W",icon:!1}]},{name:"Picture-in-Picture の表示切り替え",keys:[{name:"E",icon:!1}]},{name:"字幕の表示切り替え",keys:[{name:"S",icon:!1}]},{name:"コメントの表示切り替え",keys:[{name:"D",icon:!1}]},{name:"映像をキャプチャする",keys:[{name:"C",icon:!1}]},{name:"映像をコメントを付けてキャプチャする",keys:[{name:"V",icon:!1}]},{name:"コメント入力フォームにフォーカスする",keys:[{name:"M",icon:!1}]},{name:"コメント入力フォームを閉じる",keys:[{name:Y.CtrlOrCmd(),icon:!1},{name:"M",icon:!1}]}]}],right_column:[{name:"パネル",icon:"fluent:panel-right-20-filled",icon_height:"24px",shortcuts:[{name:"パネルの表示切り替え",keys:[{name:"P",icon:!1}]},{name:"番組情報タブを表示する",keys:[{name:"K",icon:!1}]},{name:"チャンネルタブを表示する",keys:[{name:"L",icon:!1}]},{name:"コメントタブを表示する",keys:[{name:"；(＋)",icon:!1}]},{name:"Twitter タブを表示する",keys:[{name:"：(＊)",icon:!1}]}]},{name:"Twitter",icon:"fa-brands:twitter",icon_height:"22px",shortcuts:[{name:"ツイート検索タブを表示する",keys:[{name:"［ (「)",icon:!1}]},{name:"タイムラインタブを表示する",keys:[{name:"］ (」)",icon:!1}]},{name:"キャプチャタブを表示する",keys:[{name:"＼(￥)",icon:!1}]},{name:"ツイート入力フォームにフォーカスを当てる/フォーカスを外す",keys:[{name:"Tab",icon:!1}]},{name:"キャプチャにフォーカスする",keys:[{name:"キャプチャタブを表示",icon:!1},{name:"fluent:arrow-up-12-filled;fluent:arrow-down-12-filled;fluent:arrow-left-12-filled;fluent:arrow-right-12-filled",icon:!0}]},{name:"キャプチャを拡大表示する/<br>キャプチャの拡大表示を閉じる",keys:[{name:"キャプチャにフォーカス",icon:!1},{name:"Enter",icon:!1}]},{name:"キャプチャを選択する/<br>キャプチャの選択を解除する",keys:[{name:"キャプチャにフォーカス",icon:!1},{name:"Space",icon:!1}]},{name:"クリップボード内の画像を<br>キャプチャとして取り込む",keys:[{name:"ツイート入力<br>フォームにフォーカス",icon:!1},{name:Y.CtrlOrCmd(),icon:!1},{name:"V",icon:!1}]},{name:"ツイートを送信する",keys:[{name:"Twitter タブを表示",icon:!1},{name:Y.CtrlOrCmd(),icon:!1},{name:"Enter",icon:!1}]}]}]}}},computed:Object.assign({},(0,a.Kc)(Vt,it)),async created(){this.channelsStore.channel_id=this.$route.params.channel_id,"virtualKeyboard"in navigator&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.ongeometrychange=t=>{0===t.target.boundingRect.width&&0===t.target.boundingRect.height?this.is_virtual_keyboard_display=!1:this.is_virtual_keyboard_display=!0}),this.init(),this.romsounds_context=new AudioContext;for(let t=1;t<=14;t++){const e=`/assets/romsounds/${t.toString().padStart(2,"0")}.wav`,s=await r["default"].axios.get(e,{baseURL:"",responseType:"arraybuffer"});this.romsounds_buffers.push(await this.romsounds_context.decodeAudioData(s.data))}},beforeDestroy(){"virtualKeyboard"in navigator&&(navigator.virtualKeyboard.overlaysContent=!1),"gr999"!==this.channelsStore.channel.current.channel_id&&this.destroy(!0),null!==this.romsounds_context&&this.romsounds_context.close(),this.channelsStore.channel_id="gr000"},beforeRouteUpdate(t,e,s){const i=this.destroy(!1,this.is_zapping_continuously);this.is_zapping_continuously=!0,this.channelsStore.channel_id=t.params.channel_id,!0===this.settingsStore.settings.reset_hashtag_when_program_switches&&(this.$refs.Twitter.tweet_hashtag=""),(async()=>{!0===this.is_zapping?(this.is_zapping=!1,this.interval_ids.push(window.setTimeout((()=>{this.is_zapping_continuously=!1,i.then((()=>this.init()))}),500))):(this.is_zapping_continuously=!1,i.then((()=>this.init())))})(),s()},watch:{"channelsStore.channel":{immediate:!0,handler(t,e){var s;if(void 0===e)return;const i=this.$refs.Twitter;if(t.current.channel_id!==e.current.channel_id){const t=null!==(s=i.getChannelHashtag(e.current.channel_name))&&void 0!==s?s:"";i.tweet_hashtag=i.formatHashtag(i.tweet_hashtag.replaceAll(t,""))}(t.current.id!==e.current.id||null!==t.current.program_present&&null===e.current.program_present||null===t.current.program_present&&null!==e.current.program_present||null!==t.current.program_present&&null!==e.current.program_present&&t.current.program_present.id!==e.current.program_present.id)&&!0===this.settingsStore.settings.reset_hashtag_when_program_switches&&(i.tweet_hashtag=i.formatHashtag(""))}},is_panel_display(){this.settingsStore.settings.showed_panel_last_time=this.is_panel_display}},methods:{async init(){this.background_url=L.generatePlayerBackgroundURL(),this.controlDisplayTimer(),this.interval_ids.push(window.setInterval((()=>this.time=U()().format("YYYY/MM/DD HH:mm:ss")),1e3));const t=60-(new Date).getSeconds();this.interval_ids.push(window.setTimeout((()=>{this.channelsStore.update(!0),this.update(),this.interval_ids.push(window.setInterval((()=>{this.channelsStore.update(!0),this.update()}),3e4))}),1e3*t)),await this.channelsStore.update(),this.update()},async update(){if(void 0!==this.$route.params.channel_id)if("gr999"!==this.channelsStore.channel.current.channel_id){if(null!==this.player&&!0!==this.player_can_be_destroyed||(this.initPlayer(),this.initEventHandler(),this.initCaptureHandler(),document.removeEventListener("keydown",this.shortcut_key_handler),this.initShortcutKeyHandler()),null!==this.player){if(null===this.channelsStore.channel.current.program_present||"1/0+1/0モード(デュアルモノ)"!==this.channelsStore.channel.current.program_present.primary_audio_type&&null===this.channelsStore.channel.current.program_present.secondary_audio_type){if(this.player.template.audioItem[1].classList.add("dplayer-setting-audio-item--disabled"),void 0!==this.player.plugins.mpegts||void 0!==this.player.plugins.liveLLHLSForKonomiTV){while(null===this.player)await Y.sleep(.1);this.player.template.audioItem[0].classList.add("dplayer-setting-audio-current"),this.player.template.audioItem[1].classList.remove("dplayer-setting-audio-current"),this.player.template.audioValue.textContent=this.player.tran("Primary audio");try{void 0!==this.player.plugins.mpegts&&this.player.plugins.mpegts instanceof ne().MSEPlayer&&this.player.plugins.mpegts.switchPrimaryAudio(),void 0!==this.player.plugins.liveLLHLSForKonomiTV&&this.player.plugins.liveLLHLSForKonomiTV.switchPrimaryAudio()}catch(t){}}}else this.player.template.audioItem[1].classList.remove("dplayer-setting-audio-item--disabled");if("mediaSession"in navigator){const t=[{src:"/assets/images/icons/icon-maskable-192px.png",sizes:"192x192",type:"image/png"},{src:"/assets/images/icons/icon-maskable-512px.png",sizes:"512x512",type:"image/png"}];navigator.mediaSession.metadata=new MediaMetadata({title:this.channelsStore.channel.current.program_present?this.channelsStore.channel.current.program_present.title:"放送休止",artist:this.channelsStore.channel.current.channel_name,artwork:t}),"setPositionState"in navigator.mediaSession&&navigator.mediaSession.setPositionState({duration:0,playbackRate:1}),navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("previoustrack",null),navigator.mediaSession.setActionHandler("nexttrack",null),navigator.mediaSession.setActionHandler("play",(()=>{var t;return null===(t=this.player)||void 0===t?void 0:t.play()})),navigator.mediaSession.setActionHandler("pause",(()=>{var t;return null===(t=this.player)||void 0===t?void 0:t.pause()})),navigator.mediaSession.setActionHandler("previoustrack",(async()=>{navigator.mediaSession.metadata=new MediaMetadata({title:this.channelsStore.channel.previous.program_present?this.channelsStore.channel.previous.program_present.title:"放送休止",artist:this.channelsStore.channel.previous.channel_name,artwork:t}),await this.$router.push({path:`/tv/watch/${this.channelsStore.channel.previous.channel_id}`})})),navigator.mediaSession.setActionHandler("nexttrack",(async()=>{navigator.mediaSession.metadata=new MediaMetadata({title:this.channelsStore.channel.next.program_present?this.channelsStore.channel.next.program_present.title:"放送休止",artist:this.channelsStore.channel.next.channel_name,artwork:t}),await this.$router.push({path:`/tv/watch/${this.channelsStore.channel.next.channel_id}`})}))}}}else this.$router.push({path:"/not-found/"})},controlDisplayTimer(t=null,e=!1){var s,i,a;const n=/iPhone|iPad|iPod|Windows|Macintosh|Android|Mobile/i.test(navigator.userAgent)&&"ontouchend"in document;if(1==n&&null!==t&&"mousemove"===t.type)return;if(0==n&&null!==t&&("touchmove"===t.type||"click"===t.type))return;window.clearTimeout(this.control_interval_id);const r=()=>{null!==this.player&&this.player.template.controller.classList.contains("dplayer-controller-comment")?this.control_interval_id=window.setTimeout(r,3e3):(this.is_control_display=!1,null!==this.player&&(this.player.controller.hide(),this.player.setting.hide()))};!0===n&&!0===e?(null===(s=this.player)||void 0===s?void 0:s.controller.isShow())?(this.is_control_display=!0,this.player.controller.show(),this.control_interval_id=window.setTimeout(r,3e3)):(this.is_control_display=!1,null===(i=this.player)||void 0===i||i.controller.hide(),null===(a=this.player)||void 0===a||a.setting.hide()):(this.is_control_display=!0,null!==this.player&&this.player.controller.show(),this.control_interval_id=window.setTimeout(r,3e3))},initPlayer(){if(window.mpegts=ne(),null!==this.player&&!0===this.player_can_be_destroyed){try{this.player.destroy()}catch(a){void 0!==this.player.plugins.mpegts&&this.player.plugins.mpegts.destroy()}this.player_can_be_destroyed=!1,this.player=null}const t=this.settingsStore.settings.tv_low_latency_mode?ts:es;this.player=new(ie())({container:this.$el.querySelector(".watch-player__dplayer"),theme:"#E64F97",lang:"ja-jp",live:!0,liveSyncMinBufferSize:this.is_mpegts_supported?t:0,loop:!1,airplay:!1,autoplay:!0,hotkey:!1,screenshot:!1,volume:1,video:{defaultQuality:this.channelsStore.channel.current.is_radiochannel?"48kHz/192kbps":this.settingsStore.settings.tv_streaming_quality,quality:(()=>{const t=[];if(this.channelsStore.channel.current.is_radiochannel)!0===this.is_mpegts_supported?t.push({name:"48kHz/192kbps",type:"mpegts",url:`${Y.api_base_url}/streams/live/${this.channelsStore.channel_id}/1080p/mpegts`}):t.push({name:"48kHz/192kbps",type:"live-llhls-for-KonomiTV",url:`${Y.api_base_url}/streams/live/${this.channelsStore.channel_id}/1080p/ll-hls`});else{let e="";L.isHEVCVideoSupported()&&!0===this.settingsStore.settings.tv_data_saver_mode&&(e="-hevc");for(const s of["1080p-60fps","1080p","810p","720p","540p","480p","360p","240p"])!0===this.is_mpegts_supported?t.push({name:"1080p-60fps"===s?"1080p (60fps)":s,type:"mpegts",url:`${Y.api_base_url}/streams/live/${this.channelsStore.channel_id}/${s}${e}/mpegts`}):t.push({name:"1080p-60fps"===s?"1080p (60fps)":s,type:"live-llhls-for-KonomiTV",url:`${Y.api_base_url}/streams/live/${this.channelsStore.channel_id}/${s}${e}/ll-hls`})}return t})()},danmaku:{user:"KonomiTV",speedRate:this.settingsStore.settings.comment_speed_rate,fontSize:this.settingsStore.settings.comment_font_size},apiBackend:{read:t=>{t.success([])},send:async t=>{this.$refs.Comment.sendComment(t)}},pluginOptions:{mpegts:{config:{enableWorker:!0,enableStashBuffer:!1,liveSync:this.settingsStore.settings.tv_low_latency_mode,liveSyncMaxLatency:3,liveSyncTargetLatency:t,liveSyncPlaybackRate:1.1}},aribb24:{normalFont:`"${this.settingsStore.settings.caption_font}", sans-serif`,forceStrokeColor:!!this.settingsStore.settings.always_border_caption_text,forceBackgroundColor:this.settingsStore.settings.specify_caption_background_color?this.settingsStore.settings.caption_background_color:null,drcsReplacement:!0,enableRawCanvas:!0,useStroke:!0,usePUA:(()=>{const t=this.settingsStore.settings.caption_font,e=document.createElement("canvas").getContext("2d");return e.font=`10px ${t}`,e.fillText("Test",0,0),!!t.startsWith("Windows TV")})(),PRACallback:async t=>{if(!1===this.settingsStore.settings.tv_show_superimpose)return;"suspended"===this.romsounds_context.state&&await this.romsounds_context.resume();const e=this.romsounds_context.createBufferSource();e.buffer=this.romsounds_buffers[t];const s=this.romsounds_context.createGain();e.connect(s),s.connect(this.romsounds_context.destination),s.gain.value=3,e.start(0)}}},subtitle:{type:"aribb24"}}),window.player=this.player,this.player.controller.setAutoHide=t=>{},this.$refs.Comment.initSession(this.player,this.channelsStore.channel_id),this.player.template.commentInput.addEventListener("keydown",(t=>{"Enter"===t.code&&(this.is_comment_send_just_did=!0,setTimeout((()=>this.is_comment_send_just_did=!1),100))})),this.player.comment.send=()=>{null!==this.player&&(!0===this.settingsStore.settings.close_comment_form_after_sending&&this.player.template.commentInput.blur(),this.player.template.commentInput.value.replace(/^\s+|\s+$/g,"")?(this.player.danmaku.send({text:this.player.template.commentInput.value,color:this.player.container.querySelector(".dplayer-comment-setting-color input:checked").value,type:this.player.container.querySelector(".dplayer-comment-setting-type input:checked").value,size:this.player.container.querySelector(".dplayer-comment-setting-size input:checked").value},(()=>{!0===this.settingsStore.settings.close_comment_form_after_sending&&null!==this.player&&this.player.comment.hide()}),!0),this.player.template.commentInput.value=""):this.player.notice(this.player.tran("Please input danmaku content!")))};const e=/iPhone|iPad|iPod|Macintosh|Android|Mobile/i.test(navigator.userAgent)&&"ontouchend"in document;if(!1===e){this.player.template.settingOriginPanel.insertAdjacentHTML("beforeend",'\n                <div class="dplayer-setting-item dplayer-setting-keyboard-shortcut">\n                    <span class="dplayer-label">キーボードショートカット</span>\n                    <div class="dplayer-toggle">\n                        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32">\n                            <path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"></path>\n                        </svg>\n                    </div>\n                </div>');const t=this.player.template.settingOriginPanel.scrollHeight;this.player.template.settingBox.style.clipPath=`inset(calc(100% - ${t}px) 0 0 round 7px)`,this.$el.querySelector(".dplayer-setting-keyboard-shortcut").addEventListener("click",(()=>{var t;null===(t=this.player)||void 0===t||t.setting.hide(),this.shortcut_key_modal=!0}))}const s=document.querySelector(".v-application");this.fullscreen_handler=()=>{var t;this.is_fullscreen=!0===(null===(t=this.player)||void 0===t?void 0:t.fullScreen.isFullScreen())},void 0!==s.onfullscreenchange?s.addEventListener("fullscreenchange",this.fullscreen_handler):s.addEventListener("webkitfullscreenchange",this.fullscreen_handler),this.player.fullScreen.isFullScreen=t=>!(!document.fullscreenElement&&!document.webkitFullscreenElement),this.player.fullScreen.request=t=>{null!==this.player&&(this.player.fullScreen.isFullScreen()?this.player.fullScreen.cancel():(s.requestFullscreen=s.requestFullscreen||s.webkitRequestFullscreen,s.requestFullscreen?(s.requestFullscreen(),screen.orientation&&screen.orientation.lock("landscape").catch((()=>{}))):this.player.notice("iPhone Safari は動画のフルスクリーン表示に対応していません。")))},this.player.fullScreen.cancel=t=>{document.exitFullscreen=document.exitFullscreen||document.webkitExitFullscreen,document.exitFullscreen&&document.exitFullscreen(),screen.orientation&&screen.orientation.unlock()};const i=()=>{var t;null===(t=this.player)||void 0===t||t.setting.hide(),this.controlDisplayTimer()};this.player.on("play",i),this.player.on("pause",i),this.player.on("quality_start",(()=>{this.background_url=L.generatePlayerBackgroundURL(),null!==this.eventsource&&(this.eventsource.close(),this.eventsource=null),this.initEventHandler()})),!0===this.is_mpegts_supported?this.interval_ids.push(window.setInterval((()=>{var t;(null===(t=this.player)||void 0===t?void 0:t.video.paused)&&this.player.video.buffered.end(0)-this.player.video.currentTime>30&&this.player.sync()}),6e4)):this.interval_ids.push(window.setInterval((()=>{var t;(null===(t=this.player)||void 0===t?void 0:t.video.paused)&&this.player.sync()}),3e4)),(async()=>{if(null!==this.player){while(void 0===this.player.plugins.aribb24Superimpose)await Y.sleep(.1);!0===this.settingsStore.settings.tv_show_superimpose?(this.player.plugins.aribb24Superimpose.show(),this.player.on("subtitle_hide",(()=>{var t;null===(t=this.player)||void 0===t||t.plugins.aribb24Superimpose.show()}))):(this.player.plugins.aribb24Superimpose.hide(),this.player.on("subtitle_show",(()=>{var t;null===(t=this.player)||void 0===t||t.plugins.aribb24Superimpose.hide()})))}})()},initEventHandler(){if(null===this.player)return;if(this.is_loading=!0,this.player.video.volume=0,this.player.video.crossOrigin="anonymous",!1===this.is_mpegts_supported){const t=()=>{var e,s;null===(e=this.player)||void 0===e||e.video.play().catch((()=>{console.warn("HTMLVideoElement.play() rejected. run fallback.");const t='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 17 32"><path d="M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z"></path></svg>';this.player.template.playButton.innerHTML=t,this.player.template.mobilePlayButton.innerHTML=t,this.player.container.classList.remove("dplayer-paused"),this.player.container.classList.add("dplayer-playing"),this.player.danmaku.play()})),!1!==this.is_loading||null===(s=this.player)||void 0===s||s.video.removeEventListener("pause",t)};this.player.video.addEventListener("pause",t)}const t=async()=>{if(null===this.player)return;if(this.player.video.oncanplay=null,this.player.video.oncanplaythrough=null,!0===this.is_mpegts_supported){this.player.video.playbackRate=0;const t=()=>{try{return Math.round(1e3*(this.player.video.buffered.end(0)-this.player.video.currentTime))/1e3}catch(t){return 0}},e=this.settingsStore.settings.tv_low_latency_mode?ts:es;let s=t();while(s<e)await Y.sleep(.1),s=t();this.player.video.playbackRate=1}this.player.video.addEventListener("waiting",(()=>this.is_video_buffering=!0)),this.player.video.addEventListener("playing",(()=>this.is_video_buffering=!1)),this.is_loading=!1,this.is_video_buffering=!1,this.channelsStore.channel.current.is_radiochannel?this.is_background_display=!0:this.is_background_display=!1;const t=this.player.user.get("volume");while(this.player.video.volume+.05<t)this.player.video.volume=Y.mathFloor(this.player.video.volume+.05,2),await Y.sleep(.02);this.player.video.volume=t};this.player.video.oncanplay=t,this.player.video.oncanplaythrough=t;const e=this.player.quality.url.replace("/mpegts","/events").replace(/\/ll-hls.*/,"/events");this.eventsource=new EventSource(e),this.eventsource.addEventListener("initial_update",(t=>{const e=JSON.parse(t.data);switch(console.log(`[initial_update] Status: ${e.status} / Detail: ${e.detail}`),e.status){case"Standby":this.is_video_buffering=!0,this.is_background_display=!0;break}})),this.eventsource.addEventListener("status_update",(e=>{var s,i;if(null===this.player)return;const a=JSON.parse(e.data);switch(console.log(`[status_update] Status: ${a.status} / Detail: ${a.detail}`),this.channelsStore.updateChannel(this.channelsStore.channel_id,Object.assign(Object.assign({},this.channelsStore.channel.current),{viewers:a.clients_count})),a.status){case"Standby":this.player.template.notice.textContent.includes("画質を")||this.player.notice(a.detail,-1),this.is_video_buffering=!0,this.is_background_display=!0;break;case"ONAir":this.player.template.notice.textContent.includes("画質を")||this.player.notice(this.player.template.notice.textContent,1e-6),!1===this.is_mpegts_supported&&(this.player.video.load(),this.player.video.play(),t()),document.pictureInPictureElement&&(document.exitPictureInPicture(),this.player.video.requestPictureInPicture());break;case"Restart":this.player.notice(a.detail,-1),this.player.switchVideo({url:this.player.quality.url,type:this.player.quality.type}),this.player.play(),this.is_video_buffering=!0,this.is_background_display=!0;break;case"Offline":null!==this.player&&(this.player.notice(a.detail,-1),this.player.video.onerror=()=>{this.player.notice(a.detail,-1),this.player.video.onerror=null},null===(i=null===(s=this.player)||void 0===s?void 0:s.danmaku)||void 0===i||i.clear(),this.player.video.pause()),null!==this.eventsource&&(this.eventsource.close(),this.eventsource=null),this.is_background_display=!0,this.is_loading=!1,this.is_video_buffering=!1;break}})),this.eventsource.addEventListener("detail_update",(t=>{if(null===this.player)return;const e=JSON.parse(t.data);switch(console.log(`[detail_update] Status: ${e.status} Detail:${e.detail}`),this.channelsStore.updateChannel(this.channelsStore.channel_id,Object.assign(Object.assign({},this.channelsStore.channel.current),{viewers:e.clients_count})),e.status){case"Standby":this.player.notice(e.detail,-1),this.is_background_display||(this.is_background_display=!0);break}})),this.eventsource.addEventListener("clients_update",(t=>{const e=JSON.parse(t.data);this.channelsStore.updateChannel(this.channelsStore.channel_id,Object.assign(Object.assign({},this.channelsStore.channel.current),{viewers:e.clients_count}))}))},initShortcutKeyHandler(){const t=this.$refs.Twitter,e=t.$el.querySelector(".tweet-form__textarea");for(const s of document.querySelectorAll("input[type=text],input[type=search],textarea"))s.addEventListener("compositionstart",(()=>this.is_ime_composing=!0)),s.addEventListener("compositionend",(()=>this.is_ime_composing=!1));this.shortcut_key_handler=async s=>{const i=document.activeElement.tagName.toUpperCase(),a=document.activeElement.getAttribute("contenteditable");["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(s.code)&&"INPUT"!==i&&"TEXTAREA"!==i&&""!==a&&"true"!==a&&s.preventDefault();let n=!1;s.repeat&&(n=!0);const r=Y.time();if(r-this.shortcut_key_pressed_at<.05)return;this.shortcut_key_pressed_at=r;const o=await(async()=>{if(("INPUT"!==i&&"TEXTAREA"!==i&&""!==a&&"true"!==a||document.activeElement===e)&&!1===this.is_ime_composing&&"Tab"===s.code)return document.activeElement===e?(e.blur(),!0):(this.is_panel_display=!0,this.tv_panel_active_tab="Twitter",e.focus(),this.$el.scrollLeft=0,window.setTimeout((()=>{e.focus(),this.$el.scrollLeft=0}),100),!0);if(("INPUT"!==i&&"TEXTAREA"!==i&&""!==a&&"true"!==a||document.activeElement===e)&&"Twitter"===this.tv_panel_active_tab&&!1===this.is_ime_composing&&(s.ctrlKey||s.metaKey||s.shiftKey)&&"Enter"===s.code)return t.$el.querySelector(".tweet-button").click(),!0;if(null!==this.player&&!s.shiftKey&&!s.altKey&&this.player.template.controller.classList.contains("dplayer-controller-comment")&&(s.ctrlKey||s.metaKey)&&"KeyM"===s.code)return this.player.comment.hide(),!0;if("INPUT"!==i&&"TEXTAREA"!==i&&""!==a&&"true"!==a){if(!1===n&&!s.ctrlKey&&!s.metaKey&&!s.altKey){const t=s.shiftKey?"BS":"GR";let e=null;if("Digit1"!==s.code&&"Digit2"!==s.code&&"Digit3"!==s.code&&"Digit4"!==s.code&&"Digit5"!==s.code&&"Digit6"!==s.code&&"Digit7"!==s.code&&"Digit8"!==s.code&&"Digit9"!==s.code||(e=Number(s.code.replace("Digit",""))),"Digit0"===s.code&&(e=10),"Minus"===s.code&&(e=11),"Equal"===s.code&&(e=12),"Numpad1"!==s.code&&"Numpad2"!==s.code&&"Numpad3"!==s.code&&"Numpad4"!==s.code&&"Numpad5"!==s.code&&"Numpad6"!==s.code&&"Numpad7"!==s.code&&"Numpad8"!==s.code&&"Numpad9"!==s.code||(e=Number(s.code.replace("Numpad",""))),"Numpad0"===s.code&&(e=10),null!==e){const s=this.channelsStore.getChannelByRemoconID(t,e);if(null!==s&&s.channel_id!==this.channelsStore.channel_id)return await this.$router.push({path:`/tv/watch/${s.channel_id}`}),!0}}if(!1===n&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey){if("Slash"===s.code)return this.shortcut_key_modal=!this.shortcut_key_modal,!0;if("KeyP"===s.code)return this.is_panel_display=!this.is_panel_display,!0;if("KeyK"===s.code)return this.tv_panel_active_tab="Program",!0;if("KeyL"===s.code)return this.tv_panel_active_tab="Channel",!0;if("Semicolon"===s.code)return this.tv_panel_active_tab="Comment",!0;if("Quote"===s.code)return this.tv_panel_active_tab="Twitter",!0;if("BracketRight"===s.code)return t.twitter_active_tab="Search",!0;if("Backslash"===s.code)return t.twitter_active_tab="Timeline",!0;if("IntlRo"===s.code)return t.twitter_active_tab="Capture",!0}if("Twitter"===this.tv_panel_active_tab&&"Capture"===t.twitter_active_tab&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey){if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(s.code)){if(0===t.captures.length)return!1;if(!1===t.captures.some((t=>!0===t.focused)))return t.captures[t.captures.length-1].focused=!0,!0;const e=t.captures.findIndex((t=>!0===t.focused));if("ArrowUp"===s.code){if(e-2<0)return!1;t.captures[e-2].focused=!0}if("ArrowDown"===s.code){if(e+2>t.captures.length-1)return!1;t.captures[e+2].focused=!0}if("ArrowLeft"===s.code){if(e-1<0)return!1;t.captures[e-1].focused=!0}if("ArrowRight"===s.code){if(e+1>t.captures.length-1)return!1;t.captures[e+1].focused=!0}t.captures[e].focused=!1;const i=t.captures.find((t=>!0===t.focused));!0===t.zoom_capture_modal&&(t.zoom_capture=i);const a=t.$el.querySelector(`img[src="${i.image_url}"]`).parentElement;return n?a.scrollIntoView({block:"nearest",inline:"nearest",behavior:"auto"}):a.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"}),!0}if("Enter"===s.code){if(this.is_comment_send_just_did)return!1;if(!0===t.zoom_capture_modal)return t.zoom_capture_modal=!1,!0;const e=t.captures.find((t=>!0===t.focused));return void 0!==e&&(t.zoom_capture=e,t.zoom_capture_modal=!0,!0)}if("Space"===s.code){const e=t.captures.find((t=>!0===t.focused));return void 0!==e&&(t.clickCapture(e),!0)}}if(!1===n&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey){if("ArrowUp"===s.code)return this.is_zapping=!0,await this.$router.push({path:`/tv/watch/${this.channelsStore.channel.previous.channel_id}`}),!0;if("ArrowDown"===s.code)return this.is_zapping=!0,await this.$router.push({path:`/tv/watch/${this.channelsStore.channel.next.channel_id}`}),!0}if(null!==this.player&&!s.shiftKey&&!s.altKey){if((s.ctrlKey||s.metaKey)&&"ArrowUp"===s.code)return this.player.volume(this.player.volume()+.05),!0;if((s.ctrlKey||s.metaKey)&&"ArrowDown"===s.code)return this.player.volume(this.player.volume()-.05),!0;if((s.ctrlKey||s.metaKey)&&"ArrowLeft"===s.code)return!1===this.player.video.paused&&this.player.video.pause(),this.player.video.currentTime=this.player.video.currentTime-.5,!0;if((s.ctrlKey||s.metaKey)&&"ArrowRight"===s.code)return!1===this.player.video.paused&&this.player.video.pause(),this.player.video.currentTime=this.player.video.currentTime+.5,!0}if(null!==this.player&&!s.ctrlKey&&!s.metaKey&&!s.altKey&&!0===s.shiftKey&&"Space"===s.code&&!1===n&&"Twitter"===this.tv_panel_active_tab&&"Capture"===t.twitter_active_tab)return this.player.toggle(),!0;if(null!==this.player&&!1===n&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey){if("Space"===s.code)return this.player.toggle(),!0;if("KeyF"===s.code)return this.player.fullScreen.toggle(),!0;if("KeyW"===s.code)return this.player.sync(),!0;if("KeyE"===s.code)return document.pictureInPictureEnabled&&this.player.template.pipButton.click(),!0;if("KeyS"===s.code)return this.player.subtitle.toggle(),this.player.subtitle.container.classList.contains("dplayer-subtitle-hide")?this.player.notice(`${this.player.tran("Hide subtitle")}`):this.player.notice(`${this.player.tran("Show subtitle")}`),!0;if("KeyD"===s.code)return this.player.template.showDanmaku.click(),this.player.template.showDanmakuToggle.checked?this.player.notice(`${this.player.tran("Show comment")}`):this.player.notice(`${this.player.tran("Hide comment")}`),!0;if("KeyC"===s.code)return await this.capture_handler.captureAndSave(this.channelsStore.channel.current,!1),!0;if("KeyV"===s.code)return await this.capture_handler.captureAndSave(this.channelsStore.channel.current,!0),!0;if("KeyM"===s.code)return this.player.controller.show(),this.player.comment.show(),this.controlDisplayTimer(),window.setTimeout((()=>this.player.template.commentInput.focus()),100),!0}}return!1})();!0===o&&s.preventDefault()},document.addEventListener("keydown",this.shortcut_key_handler)},initCaptureHandler(){this.capture_handler=new Qe(this.player,((t,e)=>{this.$refs.Twitter.addCaptureList(t,e)}));const t=this.$el.querySelector(".dplayer-icon.dplayer-capture-icon");t.addEventListener("click",(async()=>{await this.capture_handler.captureAndSave(this.channelsStore.channel.current,!1)}));const e=this.$el.querySelector(".dplayer-icon.dplayer-comment-capture-icon");e.addEventListener("click",(async()=>{await this.capture_handler.captureAndSave(this.channelsStore.channel.current,!0)}))},async destroy(t=!1,e=!1){this.$refs.Comment.destroy();for(const i of this.interval_ids)window.clearInterval(i);if(window.clearTimeout(this.control_interval_id),this.interval_ids=[],this.is_loading=!0,this.is_background_display=!1,null!==this.player&&(this.player_can_be_destroyed=!0),null!==this.eventsource&&(this.eventsource.close(),this.eventsource=null),!1===e){const t=this.player.user.get("volume");for(let e=0;e<20;e++)await Y.sleep(.01),this.player.video.volume=t*(1-(e+1)/20)}if(!0===t&&null!==this.player){try{this.player.destroy()}catch(s){void 0!==this.player.plugins.mpegts&&this.player.plugins.mpegts.destroy()}this.player_can_be_destroyed=!1,this.player=null}}}}),is=ss,as=(0,p.Z)(is,te,ee,!1,null,"6949105c",null),ns=as.exports,rs=s(4611),os=s(9709),ls=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"route-container"},[e("Header"),e("main",[e("Navigation"),e(qt.Z,{staticClass:"settings-container d-flex px-5 py-5 mx-auto background",attrs:{elevation:"0",width:"100%","max-width":"1000"}},[e(os.Z,{staticClass:"settings-navigation flex-shrink-0 background",attrs:{permanent:"",width:"100%",height:"auto"}},[e(me.Z,{staticClass:"px-1"},[e(he.km,[e("h1",[t._v("設定")])])],1),e(ue.Z,{staticClass:"mt-2 px-0",attrs:{nav:""}},[e(me.Z,{staticClass:"px-4",attrs:{link:"",color:"primary",to:"/settings/general"}},[e(rs.Z,{staticClass:"mr-4"},[e("Icon",{staticStyle:{padding:"0 3px"},attrs:{icon:"fa-solid:sliders-h",width:"26px"}})],1),e(he.km,[e(he.V9,[t._v("全般")])],1)],1),e(me.Z,{staticClass:"px-4",attrs:{link:"",color:"primary",to:"/settings/account"}},[e(rs.Z,{staticClass:"mr-4"},[e("Icon",{attrs:{icon:"fluent:person-20-filled",width:"26px"}})],1),e(he.km,[e(he.V9,[t._v("アカウント")])],1)],1),e(me.Z,{staticClass:"px-4",attrs:{link:"",color:"primary",to:"/settings/jikkyo"}},[e(rs.Z,{staticClass:"mr-4"},[e("Icon",{staticStyle:{padding:"0 2px"},attrs:{icon:"bi:chat-left-text-fill",width:"26px"}})],1),e(he.km,[e(he.V9,[t._v("ニコニコ実況")])],1)],1),e(me.Z,{staticClass:"px-4",attrs:{link:"",color:"primary",to:"/settings/twitter"}},[e(rs.Z,{staticClass:"mr-4"},[e("Icon",{staticStyle:{padding:"0 1px"},attrs:{icon:"fa-brands:twitter",width:"26px"}})],1),e(he.km,[e(he.V9,[t._v("Twitter")])],1)],1),e(me.Z,{staticClass:"px-4",attrs:{link:"",color:"primary",to:"/settings/environment"}},[e(rs.Z,{staticClass:"mr-4"},[e("Icon",{attrs:{icon:"fluent:toolbox-20-filled",width:"26px"}})],1),e(he.km,[e(he.V9,[t._v("環境設定")])],1)],1),e(me.Z,{staticClass:"px-4 settings-navigation-version",class:{"settings-navigation-version--highlight":t.is_update_available},attrs:{link:"",color:"primary",href:"https://github.com/tsukumijima/KonomiTV"}},[e(rs.Z,{staticClass:"mr-4"},[e("Icon",{attrs:{icon:"fluent:info-16-regular",width:"26px"}})],1),e(he.km,[e(he.V9,[t._v(" version "+t._s(t.Utils.version)+t._s(t.is_update_available?" (Update Available)":"")+" ")])],1)],1)],1)],1)],1)],1)],1)},cs=[],_s=r["default"].extend({name:"Settings-Index",components:{Header:kt,Navigation:Kt},data(){return{Utils:Y,latest_version:null,is_update_available:!1}},async created(){try{const t=await zt.fetchServerVersion();if(null===t)return;if(this.latest_version=t.latest_version,null===this.latest_version)return;(!1===t.version.includes("-dev")&&t.version!==t.latest_version||!0===t.version.includes("-dev")&&t.version.replace("-dev","")===t.latest_version)&&(this.is_update_available=!0)}catch(t){throw new Error(t)}}}),ds=_s,us=(0,p.Z)(ds,ls,cs,!1,null,"e9f56338",null),ms=us.exports,hs=s(3422),ps=s(9223),gs=s(1625),vs=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("Base",[e("h2",{staticClass:"settings__heading"},[e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"settings__back-button",attrs:{to:"/settings/"}},[e("Icon",{attrs:{icon:"fluent:arrow-left-12-filled",width:"25px"}})],1),e("Icon",{attrs:{icon:"fa-solid:sliders-h",width:"19px"}}),e("span",{staticClass:"ml-3"},[t._v("全般")])],1),e("div",{staticClass:"settings__content"},[e("div",{staticClass:"settings__item settings__item--sync-disabled"},[e("div",{staticClass:"settings__item-heading"},[t._v("テレビのデフォルトのストリーミング画質")]),e("div",{staticClass:"settings__item-label"},[t._v(" テレビをライブストリーミングするときのデフォルトの画質を設定します。"),e("br"),t._v(" ストリーミング画質はプレイヤーの設定からいつでも切り替えられます。"),e("br")]),e("div",{staticClass:"settings__item-label"},[t._v(" [1080p (60fps)] は、通常 30fps (60i) の映像を補間することで、ほかの画質よりも滑らか（ぬるぬる）な映像で再生できます。ただし、再生負荷が少し高くなります。"),e("br"),t._v(" [1080p (60fps)] で視聴するときは、QSVEncC などのハードウェアエンコーダーの利用をおすすめします。FFmpeg (ソフトウェアエンコーダー) では CPU 使用率が高くなり、再生に支障が出ることがあります。"),e("br")]),e(ve.Z,{staticClass:"settings__item-form",attrs:{outlined:"","hide-details":"",dense:t.is_form_dense,items:t.tv_streaming_quality},model:{value:t.settingsStore.settings.tv_streaming_quality,callback:function(e){t.$set(t.settingsStore.settings,"tv_streaming_quality",e)},expression:"settingsStore.settings.tv_streaming_quality"}})],1),e("div",{staticClass:"settings__item settings__item--switch settings__item--sync-disabled",class:{"settings__item--disabled":!1===t.PlayerUtils.isHEVCVideoSupported()}},[e("label",{staticClass:"settings__item-heading",attrs:{for:"tv_data_saver_mode"}},[t._v("テレビを通信節約モードで視聴する")]),e("label",{staticClass:"settings__item-label",attrs:{for:"tv_data_saver_mode"}},[t._v(" 通信節約モードでは、H.265 / HEVC という圧縮率の高いコーデックを使い、画質はほぼそのまま、通信量を通常の 2/3 程度に抑えながら視聴できます。ただし、再生負荷が高くなります。"),e("br"),t._v(" 通信節約モードで視聴するときは、QSVEncC などのハードウェアエンコーダーの利用をおすすめします。FFmpeg (ソフトウェアエンコーダー) ではまともに再生できない可能性が高いです。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"tv_data_saver_mode",inset:"","hide-details":"",disabled:!1===t.PlayerUtils.isHEVCVideoSupported()},model:{value:t.settingsStore.settings.tv_data_saver_mode,callback:function(e){t.$set(t.settingsStore.settings,"tv_data_saver_mode",e)},expression:"settingsStore.settings.tv_data_saver_mode"}})],1),e("div",{staticClass:"settings__item settings__item--switch settings__item--sync-disabled"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"tv_low_latency_mode"}},[t._v("テレビを低遅延で視聴する")]),e("label",{staticClass:"settings__item-label",attrs:{for:"tv_low_latency_mode"}},[t._v(" 低遅延ストリーミングをオンにすると、"),e("b",[t._v("放送波との遅延を最短 0.7 秒に抑えて視聴できます。")]),e("br"),t._v(" また、約 3 秒以上遅延したときに少しだけ再生速度を早める (1.1x) ことで、滑らかにストリーミングの遅れを取り戻します。"),e("br"),t._v(" 宅外視聴などのネットワークが不安定になりがちな環境では、低遅延ストリーミングをオフにしてみると、映像のカクつきを改善できるかもしれません。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"tv_low_latency_mode",inset:"","hide-details":""},model:{value:t.settingsStore.settings.tv_low_latency_mode,callback:function(e){t.$set(t.settingsStore.settings,"tv_low_latency_mode",e)},expression:"settingsStore.settings.tv_low_latency_mode"}})],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"tv_show_superimpose"}},[t._v("テレビをみるときに文字スーパーを表示する")]),e("label",{staticClass:"settings__item-label",attrs:{for:"tv_show_superimpose"}},[t._v(" 文字スーパーは、緊急地震速報の赤テロップや、NHK BS のニュース速報のテロップなどで利用されています。とくに理由がなければ、オンにしておくのがおすすめです。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"tv_show_superimpose",inset:"","hide-details":""},model:{value:t.settingsStore.settings.tv_show_superimpose,callback:function(e){t.$set(t.settingsStore.settings,"tv_show_superimpose",e)},expression:"settingsStore.settings.tv_show_superimpose"}})],1),e(ps.Z,{staticClass:"mt-6"}),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading"},[t._v("デフォルトのパネルの表示状態")]),e("div",{staticClass:"settings__item-label"},[t._v(" 視聴画面を開いたときに、右側のパネルをどう表示するかを設定します。"),e("br")]),e(ve.Z,{staticClass:"settings__item-form",attrs:{outlined:"","hide-details":"",dense:t.is_form_dense,items:t.panel_display_state},model:{value:t.settingsStore.settings.panel_display_state,callback:function(e){t.$set(t.settingsStore.settings,"panel_display_state",e)},expression:"settingsStore.settings.panel_display_state"}})],1),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading"},[t._v("テレビをみるときにデフォルトで表示されるパネルのタブ")]),e("div",{staticClass:"settings__item-label"},[t._v(" テレビの視聴画面を開いたときに、右側のパネルで最初に表示されるタブを設定します。"),e("br")]),e(ve.Z,{staticClass:"settings__item-form",attrs:{outlined:"","hide-details":"",dense:t.is_form_dense,items:t.tv_panel_active_tab},model:{value:t.settingsStore.settings.tv_panel_active_tab,callback:function(e){t.$set(t.settingsStore.settings,"tv_panel_active_tab",e)},expression:"settingsStore.settings.tv_panel_active_tab"}})],1),e(ps.Z,{staticClass:"mt-6"}),e("div",{staticClass:"settings__item"},[e("label",{staticClass:"settings__item-heading"},[t._v("字幕のフォント")]),e("label",{staticClass:"settings__item-label"},[t._v(" プレイヤーで字幕表示をオンにしているときの、字幕のフォントを設定します。"),e("br")]),e(ve.Z,{staticClass:"settings__item-form",attrs:{outlined:"","hide-details":"",dense:t.is_form_dense,items:t.caption_font},model:{value:t.settingsStore.settings.caption_font,callback:function(e){t.$set(t.settingsStore.settings,"caption_font",e)},expression:"settingsStore.settings.caption_font"}})],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"always_border_caption_text"}},[t._v("字幕の文字を常に縁取りする")]),e("label",{staticClass:"settings__item-label",attrs:{for:"always_border_caption_text"}},[t._v(" 字幕表示時、縁取りをオンにすると、字幕が見やすくきれいになります。とくに理由がなければ、オンにしておくのがおすすめです。"),e("br"),t._v(" この設定がオフのときも、字幕データ側で縁取りが指定されていれば、オンのときと同様に縁取り付きで描画されます。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"always_border_caption_text",inset:"","hide-details":""},model:{value:t.settingsStore.settings.always_border_caption_text,callback:function(e){t.$set(t.settingsStore.settings,"always_border_caption_text",e)},expression:"settingsStore.settings.always_border_caption_text"}})],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"specify_caption_background_color"}},[t._v("字幕の背景色を指定する")]),e("label",{staticClass:"settings__item-label",attrs:{for:"specify_caption_background_color"}},[t._v(" 字幕表示時、背景色を自分で指定するか設定できます。"),e("br"),t._v(" この設定をオフのときは、字幕データ側で指定されている背景色で描画します。とくに理由がなければ、オフにしておくのがおすすめです。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"specify_caption_background_color",inset:"","hide-details":""},model:{value:t.settingsStore.settings.specify_caption_background_color,callback:function(e){t.$set(t.settingsStore.settings,"specify_caption_background_color",e)},expression:"settingsStore.settings.specify_caption_background_color"}})],1),e("div",{staticClass:"settings__item",class:{"settings__item--disabled":!1===t.settingsStore.settings.specify_caption_background_color}},[e("label",{staticClass:"settings__item-heading"},[t._v("字幕の背景色")]),e("label",{staticClass:"settings__item-label"},[t._v(" 上の [字幕の背景色を指定する] をオンにしているときのみ有効です。透明度 (アルファチャンネル) を 0 に設定すれば、字幕の背景を非表示にできます。"),e("br")]),e("div",{ref:"caption_background_color",staticClass:"settings__item-label"},[e(hs.Z,{staticClass:"settings__item-form",attrs:{"hide-details":"",flat:!0,"show-alpha":!0,"show-swatches":!1,"hide-inputs":!1,width:690,"canvas-height":80,disabled:!1===t.settingsStore.settings.specify_caption_background_color},model:{value:t.settingsStore.settings.caption_background_color,callback:function(e){t.$set(t.settingsStore.settings,"caption_background_color",e)},expression:"settingsStore.settings.caption_background_color"}})],1)]),e(ps.Z,{staticClass:"mt-6"}),e("div",{staticClass:"settings__item settings__item--switch settings__item--sync-disabled"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"capture_copy_to_clipboard"}},[t._v("キャプチャをクリップボードにコピーする")]),e("label",{staticClass:"settings__item-label",attrs:{for:"capture_copy_to_clipboard"}},[t._v(" この設定をオンにすると、撮ったキャプチャ画像がクリップボードにもコピーされます。"),e("br"),t._v(" クリップボードの履歴をサポートしていない OS では、この設定をオンにしてキャプチャを撮ると、以前のクリップボードが上書きされます。注意してください。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"capture_copy_to_clipboard",inset:"","hide-details":""},model:{value:t.settingsStore.settings.capture_copy_to_clipboard,callback:function(e){t.$set(t.settingsStore.settings,"capture_copy_to_clipboard",e)},expression:"settingsStore.settings.capture_copy_to_clipboard"}})],1),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading"},[t._v("キャプチャの保存先")]),e("div",{staticClass:"settings__item-label"},[e("p",[t._v(" キャプチャした画像をブラウザでダウンロードするか、KonomiTV サーバーにアップロードするかを設定します。"),e("br"),t._v(" ブラウザでのダウンロードと、KonomiTV サーバーへのアップロードを両方同時に行うこともできます。"),e("br")]),e("p",[t._v(" ブラウザでダウンロードすると、視聴中のデバイスのダウンロードフォルダに保存されます。"),e("br"),t._v(" 視聴中のデバイスにそのまま保存されるためシンプルですが、保存先のフォルダを変更できないこと、PC 版 Chrome では毎回ダウンロードバーが表示されてしまうことがデメリットです。"),e("br")]),e("p",[t._v(" KonomiTV サーバーにアップロードすると、環境設定で指定されたキャプチャ保存フォルダに保存されます。視聴したデバイスにかかわらず、今までに撮ったキャプチャをひとつのフォルダにまとめて保存できます。"),e("br"),t._v(" 他のデバイスでキャプチャを見るにはキャプチャ保存フォルダをネットワークに共有する必要があること、スマホ・タブレットではネットワーク上のフォルダへのアクセスがやや面倒なことがデメリットです。"),e("br")])]),e(ve.Z,{staticClass:"settings__item-form",attrs:{outlined:"","hide-details":"",dense:t.is_form_dense,items:t.capture_save_mode},model:{value:t.settingsStore.settings.capture_save_mode,callback:function(e){t.$set(t.settingsStore.settings,"capture_save_mode",e)},expression:"settingsStore.settings.capture_save_mode"}})],1),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading"},[t._v("字幕表示時のキャプチャの保存モード")]),e("div",{staticClass:"settings__item-label"},[t._v(" 字幕表示時、キャプチャした画像に字幕を合成するかを設定します。"),e("br"),t._v(" 映像のみのキャプチャと、字幕を合成したキャプチャを両方同時に保存することもできます。"),e("br"),t._v(" なお、字幕非表示時は、常に映像のみ (+コメント付きキャプチャではコメントを合成して) 保存されます。"),e("br")]),e(ve.Z,{staticClass:"settings__item-form",attrs:{outlined:"","hide-details":"",dense:t.is_form_dense,items:t.capture_caption_mode},model:{value:t.settingsStore.settings.capture_caption_mode,callback:function(e){t.$set(t.settingsStore.settings,"capture_caption_mode",e)},expression:"settingsStore.settings.capture_caption_mode"}})],1),e(ps.Z,{staticClass:"mt-6"}),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading"},[t._v("設定をエクスポート")]),e("div",{staticClass:"settings__item-label"},[t._v(" このデバイス（ブラウザ）に保存されている設定データを、エクスポート（ダウンロード）できます。"),e("br"),t._v(" ダウンロードした設定データ (KonomiTV-Settings.json) は、[設定をインポート] からインポートできます。異なるサーバーの KonomiTV を同じ設定で使いたいときなどに使ってください。"),e("br")])]),e(_t.Z,{staticClass:"settings__save-button mt-4",attrs:{depressed:""},on:{click:function(e){return t.exportSettings()}}},[e("Icon",{staticClass:"mr-3",attrs:{icon:"fa6-solid:download",height:"19px"}}),t._v("設定をエクスポート ")],1),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading error--text text--lighten-1"},[t._v("設定をインポート")]),e("div",{staticClass:"settings__item-label"},[t._v(" [設定をエクスポート] でダウンロードした設定データを、このデバイス（ブラウザ）にインポートできます。"),e("br"),t._v(" 設定をインポートすると、"),e("b",[t._v("現在のデバイス設定はすべて上書きされます。")]),t._v("元に戻すことはできません。"),e("br"),t._v(" 設定のデバイス間同期がオンのときは、"),e("b",[t._v("同期が有効なすべてのデバイスに反映されます。")]),t._v("十分ご注意ください。"),e("br")]),e(gs.Z,{staticClass:"settings__item-form",attrs:{outlined:"","hide-details":"",placeholder:"設定データ (KonomiTV-Settings.json) を選択",dense:t.is_form_dense,accept:"application/json","prepend-icon":"","prepend-inner-icon":"mdi-paperclip"},model:{value:t.import_settings_file,callback:function(e){t.import_settings_file=e},expression:"import_settings_file"}})],1),e(_t.Z,{staticClass:"settings__save-button error mt-5",attrs:{depressed:""},on:{click:function(e){return t.importSettings()}}},[e("Icon",{staticClass:"mr-3",attrs:{icon:"fa6-solid:upload",height:"19px"}}),t._v("設定をインポート ")],1),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading error--text text--lighten-1"},[t._v("設定を初期状態にリセット")]),e("div",{staticClass:"settings__item-label"},[t._v(" このデバイス（ブラウザ）に保存されている設定データを、初期状態のデフォルト値にリセットできます。"),e("br"),t._v(" 設定をリセットすると、元に戻すことはできません。"),e("br"),t._v(" 設定のデバイス間同期がオンのときは、"),e("b",[t._v("同期が有効なすべてのデバイスに反映されます。")]),t._v("十分ご注意ください。"),e("br")])]),e(_t.Z,{staticClass:"settings__save-button error mt-5",attrs:{depressed:""},on:{click:function(e){return t.resetSettings()}}},[e("Icon",{staticClass:"mr-3",attrs:{icon:"fa6-solid:upload",height:"19px"}}),t._v("設定をリセット ")],1)],1)])},fs=[],ws=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"route-container"},[e("Header"),e("main",[e("Navigation"),e(qt.Z,{staticClass:"settings-container d-flex px-5 py-5 mx-auto background",attrs:{elevation:"0",width:"100%","max-width":"1000"}},[e("div",[e(os.Z,{staticClass:"settings-navigation flex-shrink-0 background",attrs:{permanent:"",width:"195",height:"auto"}},[e(me.Z,{staticClass:"px-4"},[e(he.km,[e("h1",[t._v("設定")])])],1),e(ue.Z,{staticClass:"mt-2 px-0",attrs:{nav:""}},[e(me.Z,{staticClass:"px-4",attrs:{link:"",color:"primary",to:"/settings/general"}},[e(rs.Z,{staticClass:"mr-4"},[e("Icon",{staticStyle:{padding:"0 3px"},attrs:{icon:"fa-solid:sliders-h",width:"26px"}})],1),e(he.km,[e(he.V9,[t._v("全般")])],1)],1),e(me.Z,{staticClass:"px-4",attrs:{link:"",color:"primary",to:"/settings/account"}},[e(rs.Z,{staticClass:"mr-4"},[e("Icon",{attrs:{icon:"fluent:person-20-filled",width:"26px"}})],1),e(he.km,[e(he.V9,[t._v("アカウント")])],1)],1),e(me.Z,{staticClass:"px-4",attrs:{link:"",color:"primary",to:"/settings/jikkyo"}},[e(rs.Z,{staticClass:"mr-4"},[e("Icon",{staticStyle:{padding:"0 2px"},attrs:{icon:"bi:chat-left-text-fill",width:"26px"}})],1),e(he.km,[e(he.V9,[t._v("ニコニコ実況")])],1)],1),e(me.Z,{staticClass:"px-4",attrs:{link:"",color:"primary",to:"/settings/twitter"}},[e(rs.Z,{staticClass:"mr-4"},[e("Icon",{staticStyle:{padding:"0 1px"},attrs:{icon:"fa-brands:twitter",width:"26px"}})],1),e(he.km,[e(he.V9,[t._v("Twitter")])],1)],1),e(me.Z,{staticClass:"px-4",attrs:{link:"",color:"primary",to:"/settings/environment"}},[e(rs.Z,{staticClass:"mr-4"},[e("Icon",{attrs:{icon:"fluent:toolbox-20-filled",width:"26px"}})],1),e(he.km,[e(he.V9,[t._v("環境設定")])],1)],1)],1)],1)],1),e(qt.Z,{staticClass:"settings ml-5 px-7 py-7 lighten-1",attrs:{width:"100%"}},[t._t("default")],2)],1)],1)],1)},ys=[],bs=r["default"].extend({name:"Settings-Base",components:{Header:kt,Navigation:Kt}}),Cs=bs,ks=(0,p.Z)(Cs,ws,ys,!1,null,"397293d6",null),xs=ks.exports,Ss=r["default"].extend({name:"Settings-General",components:{Base:xs},data(){return{PlayerUtils:L,is_form_dense:Y.isSmartphoneHorizontal(),tv_streaming_quality:[{text:"1080p (60fps) （約3.24GB/h / 平均7.2Mbps）",value:"1080p-60fps"},{text:"1080p （約2.31GB/h / 平均5.1Mbps）",value:"1080p"},{text:"810p （約1.92GB/h / 平均4.2Mbps）",value:"810p"},{text:"720p （約1.33GB/h / 平均3.0Mbps）",value:"720p"},{text:"540p （約1.00GB/h / 平均2.2Mbps）",value:"540p"},{text:"480p （約0.74GB/h / 平均1.6Mbps）",value:"480p"},{text:"360p （約0.40GB/h / 平均0.9Mbps）",value:"360p"},{text:"240p （約0.23GB/h / 平均0.5Mbps）",value:"240p"}],panel_display_state:[{text:"前回の状態を復元する",value:"RestorePreviousState"},{text:"常に表示する",value:"AlwaysDisplay"},{text:"常に折りたたむ",value:"AlwaysFold"}],tv_panel_active_tab:[{text:"番組情報タブ",value:"Program"},{text:"チャンネルタブ",value:"Channel"},{text:"コメントタブ",value:"Comment"},{text:"Twitter タブ",value:"Twitter"}],caption_font:[{text:"Windows TV ゴシック",value:"Windows TV Gothic"},{text:"Windows TV 丸ゴシック",value:"Windows TV MaruGothic"},{text:"Windows TV 太丸ゴシック",value:"Windows TV FutoMaruGothic"},{text:"ヒラギノTV丸ゴ",value:"Hiragino TV Sans Rd S"},{text:"新丸ゴ ARIB",value:"TT-ShinMGo-regular"},{text:"Rounded M+ 1m for ARIB",value:"Rounded M+ 1m for ARIB"},{text:"Noto Sans JP",value:"Noto Sans JP Caption"},{text:"デフォルトのフォント",value:"sans-serif"}],capture_save_mode:[{text:"ブラウザでダウンロード",value:"Browser"},{text:"KonomiTV サーバーにアップロード",value:"UploadServer"},{text:"ブラウザでのダウンロードと、KonomiTV サーバーへのアップロードを両方行う",value:"Both"}],capture_caption_mode:[{text:"映像のみのキャプチャを保存する",value:"VideoOnly"},{text:"字幕を合成したキャプチャを保存する",value:"CompositingCaption"},{text:"映像のみのキャプチャと、字幕を合成したキャプチャを両方保存する",value:"Both"}],import_settings_file:null}},computed:Object.assign({},(0,a.Kc)(it)),methods:{exportSettings(){const t=JSON.stringify(this.settingsStore.settings,null,4),e=new Blob([t],{type:"application/json"});Y.downloadBlobData(e,"KonomiTV-Settings.json"),this.$message.success("設定をエクスポートしました。")},async importSettings(){if(null===this.import_settings_file)return void this.$message.error("インポートする設定データを選択してください！");const t=await this.settingsStore.importClientSettings(this.import_settings_file);!0===t?(this.$message.success("設定をインポートしました。"),window.setTimeout((()=>this.$router.go(0)),300)):this.$message.error("設定データが不正なため、インポートできませんでした。")},async resetSettings(){await this.settingsStore.resetClientSettings(),this.$message.success("設定をリセットしました。"),window.setTimeout((()=>this.$router.go(0)),300)}}}),Os=Ss,Ts=(0,p.Z)(Os,vs,fs,!1,null,null,null),js=Ts.exports,Is=s(5125),Ps=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("Base",[e("h2",{staticClass:"settings__heading"},[e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"settings__back-button",attrs:{to:"/settings/"}},[e("Icon",{attrs:{icon:"fluent:arrow-left-12-filled",width:"25px"}})],1),e("Icon",{attrs:{icon:"fluent:person-20-filled",width:"25px"}}),e("span",{staticClass:"ml-2"},[t._v("アカウント")])],1),e("div",{staticClass:"settings__content",class:{"settings__content--loading":t.is_loading}},[null===t.userStore.user?e("div",{staticClass:"account"},[e("div",{staticClass:"account-wrapper"},[e("img",{staticClass:"account__icon",attrs:{src:"/assets/images/account-icon-default.png"}}),e("div",{staticClass:"account__info"},[e("div",{staticClass:"account__info-name"},[e("span",{staticClass:"account__info-name-text"},[t._v("ログインしていません")])]),e("span",{staticClass:"account__info-id"},[t._v("Not logged in")])])]),e(_t.Z,{staticClass:"account__login ml-auto",attrs:{color:"secondary",width:"140",height:"56",depressed:"",to:"/login/"}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fa:sign-in"}}),t._v("ログイン ")],1)],1):t._e(),null!==t.userStore.user?e("div",{staticClass:"account"},[e("div",{staticClass:"account-wrapper"},[e("img",{staticClass:"account__icon",attrs:{src:t.userStore.user_icon_url}}),e("div",{staticClass:"account__info"},[e("div",{staticClass:"account__info-name"},[e("span",{staticClass:"account__info-name-text"},[t._v(t._s(t.userStore.user.name))]),t.userStore.user.is_admin?e("span",{staticClass:"account__info-admin"},[t._v("管理者")]):t._e()]),e("span",{staticClass:"account__info-id"},[t._v("User ID: "+t._s(t.userStore.user.id))])])]),e(_t.Z,{staticClass:"account__login ml-auto",attrs:{color:"secondary",width:"140",height:"56",depressed:""},on:{click:function(e){return t.userStore.logout()}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fa:sign-out"}}),t._v("ログアウト ")],1)],1):t._e(),!1===t.userStore.is_logged_in?e("div",{staticClass:"account-register"},[e("div",{staticClass:"account-register__heading"},[t._v(" KonomiTV アカウントにログインすると、"),e("br"),t._v("より便利な機能が使えます！ ")]),e("div",{staticClass:"account-register__feature"},[e("div",{staticClass:"account-feature"},[e("Icon",{staticClass:"account-feature__icon",attrs:{icon:"bi:chat-left-text-fill"}}),e("div",{staticClass:"account-feature__info"},[e("span",{staticClass:"account-feature__info-heading"},[t._v("ニコニコ実況にコメントする")]),e("span",{staticClass:"account-feature__info-text"},[t._v("テレビを見ながらニコニコ実況にコメントできます。別途、ニコニコアカウントとの連携が必要です。")])])],1),e("div",{staticClass:"account-feature"},[e("Icon",{staticClass:"account-feature__icon",attrs:{icon:"fa-brands:twitter"}}),e("div",{staticClass:"account-feature__info"},[e("span",{staticClass:"account-feature__info-heading"},[t._v("Twitter 連携機能")]),e("span",{staticClass:"account-feature__info-text"},[t._v("テレビを見ながら Twitter にツイートしたり、検索したツイートをリアルタイムで表示できます。別途、Twitter アカウントとの連携が必要です。")])])],1),e("div",{staticClass:"account-feature"},[e("Icon",{staticClass:"account-feature__icon",attrs:{icon:"fluent:arrow-sync-20-filled"}}),e("div",{staticClass:"account-feature__info"},[e("span",{staticClass:"account-feature__info-heading"},[t._v("設定をデバイス間で同期")]),e("span",{staticClass:"account-feature__info-text"},[t._v("ピン留めしたチャンネルなど、ブラウザに保存されている各種設定をブラウザやデバイスをまたいで同期できます。")])])],1),e("div",{staticClass:"account-feature"},[e("Icon",{staticClass:"account-feature__icon",attrs:{icon:"fa-solid:sliders-h"}}),e("div",{staticClass:"account-feature__info"},[e("span",{staticClass:"account-feature__info-heading"},[t._v("環境設定をブラウザから変更")]),e("span",{staticClass:"account-feature__info-text"},[t._v("管理者権限があれば、環境設定をブラウザから変更できます。一番最初に作成されたアカウントには、自動で管理者権限が付与されます。")])])],1)]),e("div",{staticClass:"account-register__description"},[t._v(" KonomiTV アカウントの作成に必要なものは"),e("br",{staticClass:"smartphone-vertical-only"}),t._v("ユーザー名とパスワードだけです。"),e("br"),t._v(" アカウントはローカルにインストールした"),e("br",{staticClass:"smartphone-vertical-only"}),t._v(" KonomiTV サーバーごとに保存されます。"),e("br"),t._v(" 外部のサービスには保存されませんので、ご安心ください。"),e("br")]),e(_t.Z,{staticClass:"account-register__button",attrs:{color:"secondary",width:"100%","max-width":"250",height:"50",depressed:"",to:"/register/"}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:person-add-20-filled",height:"24"}}),t._v("アカウントを作成 ")],1)],1):t._e(),!0===t.userStore.is_logged_in?e("div",[e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"sync_settings"}},[t._v("設定をデバイス間で同期する")]),e("label",{staticClass:"settings__item-label",attrs:{for:"sync_settings"}},[t._v(" KonomiTV では、設定を同じアカウントでログインしているデバイス間で同期できます。"),e("br"),t._v(" 同期をオンにすると、同期をオンにしているすべてのデバイスで共通の設定が使えます。ピン留めチャンネルやハッシュタグリストなども同期されます。"),e("br"),t._v(" ただし、デバイス固有の設定（画質設定など）は、同期後も各デバイスで個別に反映されます。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"sync_settings",inset:"","hide-details":""},model:{value:t.sync_settings,callback:function(e){t.sync_settings=e},expression:"sync_settings"}})],1),e(Xt.Z,{attrs:{"max-width":"530"},model:{value:t.sync_settings_dialog,callback:function(e){t.sync_settings_dialog=e},expression:"sync_settings_dialog"}},[e(qt.Z,[e(Wt.EB,{staticClass:"justify-center"},[t._v("設定データの競合")]),e(Wt.ZB,[t._v(" このデバイスの設定と、サーバーに保存されている設定が競合しています。"),e("br"),t._v(" 一度上書きすると、元に戻すことはできません。慎重に選択してください。"),e("br")]),e("div",{staticClass:"d-flex flex-column px-4 pb-4 settings__conflict-dialog"},[e(_t.Z,{staticClass:"settings__save-button error--text text--lighten-1",attrs:{depressed:""},on:{click:function(e){return t.overrideServerSettingsFromClient()}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:document-arrow-up-16-filled",height:"22px"}}),t._v(" サーバーに保存されている設定を、"),e("br",{staticClass:"smartphone-vertical-only"}),t._v("このデバイスの設定で上書きする ")],1),e(_t.Z,{staticClass:"settings__save-button error--text text--lighten-1 mt-3",attrs:{depressed:""},on:{click:function(e){return t.overrideClientSettingsFromServer()}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:document-arrow-down-16-filled",height:"22px"}}),t._v(" このデバイスの設定を、"),e("br",{staticClass:"smartphone-vertical-only"}),t._v("サーバーに保存されている設定で上書きする ")],1),e(_t.Z,{staticClass:"settings__save-button mt-3",attrs:{depressed:""},on:{click:function(e){t.sync_settings_dialog=!1}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:dismiss-16-filled",height:"22px"}}),t._v(" キャンセル ")],1)],1)],1)],1),e(Is.Z,{ref:"settings_username",staticClass:"settings__item",on:{submit:function(t){t.preventDefault()}}},[e("div",{staticClass:"settings__item-heading"},[t._v("ユーザー名")]),e("div",{staticClass:"settings__item-label"},[t._v(" KonomiTV アカウントのユーザー名を設定します。アルファベットだけでなく日本語や記号も使えます。"),e("br"),t._v(" 同じ KonomiTV サーバー上の他のアカウントと同じユーザー名には変更できません。"),e("br")]),e(we.Z,{staticClass:"settings__item-form",attrs:{outlined:"",placeholder:"ユーザー名",dense:t.is_form_dense,rules:[t.settings_username_validation]},model:{value:t.settings_username,callback:function(e){t.settings_username=e},expression:"settings_username"}})],1),e(_t.Z,{staticClass:"settings__save-button",attrs:{depressed:""},on:{click:function(e){return t.updateAccountInfo("username")}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:save-16-filled",height:"24px"}}),t._v("ユーザー名を更新 ")],1),e(Is.Z,{staticClass:"settings__item",on:{submit:function(t){t.preventDefault()}}},[e("div",{staticClass:"settings__item-heading"},[t._v("アイコン画像")]),e("div",{staticClass:"settings__item-label"},[t._v(" KonomiTV アカウントのアイコン画像を設定します。"),e("br"),t._v(" アップロードされた画像は自動で 400×400 の正方形にリサイズされます。"),e("br")]),e(gs.Z,{staticClass:"settings__item-form",attrs:{outlined:"","hide-details":"",placeholder:"アイコン画像を選択",dense:t.is_form_dense,accept:"image/jpeg, image/png","prepend-icon":"","prepend-inner-icon":"mdi-paperclip"},model:{value:t.settings_icon,callback:function(e){t.settings_icon=e},expression:"settings_icon"}})],1),e(_t.Z,{staticClass:"settings__save-button mt-5",attrs:{depressed:""},on:{click:function(e){return t.updateAccountIcon()}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:save-16-filled",height:"24px"}}),t._v("アイコン画像を更新 ")],1),e(Is.Z,{ref:"settings_password",staticClass:"settings__item",on:{submit:function(t){t.preventDefault()}}},[e("div",{staticClass:"settings__item-heading"},[t._v("新しいパスワード")]),e("div",{staticClass:"settings__item-label"},[t._v(" KonomiTV アカウントの新しいパスワードを設定します。"),e("br")]),e(we.Z,{staticClass:"settings__item-form",attrs:{outlined:"",placeholder:"新しいパスワード",dense:t.is_form_dense,type:t.settings_password_showing?"text":"password","append-icon":t.settings_password_showing?"mdi-eye":"mdi-eye-off",rules:[t.settings_password_validation]},on:{"click:append":function(e){t.settings_password_showing=!t.settings_password_showing}},model:{value:t.settings_password,callback:function(e){t.settings_password=e},expression:"settings_password"}})],1),e(_t.Z,{staticClass:"settings__save-button",attrs:{depressed:""},on:{click:function(e){return t.updateAccountInfo("password")}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:save-16-filled",height:"24px"}}),t._v("パスワードを更新 ")],1),e(ps.Z,{staticClass:"mt-6"}),e("div",{staticClass:"settings__item mt-6"},[e("div",{staticClass:"settings__item-heading error--text text--lighten-1"},[t._v("アカウントを削除")]),e("div",{staticClass:"settings__item-label"},[t._v(" 現在ログインしている KonomiTV アカウントを削除します。"),e("br"),e("b",[t._v("アカウントに紐づくすべてのデータが削除されます。")]),t._v("元に戻すことはできません。"),e("br")])]),e(Xt.Z,{attrs:{"max-width":"385"},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:i}){return[e(_t.Z,t._g(t._b({staticClass:"settings__save-button error mt-5",attrs:{depressed:""}},"v-btn",i,!1),s),[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:delete-16-filled",height:"24px"}}),t._v("アカウントを削除 ")],1)]}}],null,!1,974850237),model:{value:t.account_delete_confirm_dialog,callback:function(e){t.account_delete_confirm_dialog=e},expression:"account_delete_confirm_dialog"}},[e(qt.Z,[e(Wt.EB,{staticClass:"justify-center"},[t._v("本当にアカウントを削除しますか？")]),e(Wt.ZB,[t._v(" アカウントに紐づくすべてのデータが削除されます。元に戻すことはできません。"),e("br"),t._v(" 本当にアカウントを削除しますか？ ")]),e(Wt.h7,[e(ht.Z),e(_t.Z,{attrs:{color:"text",text:""},on:{click:function(e){t.account_delete_confirm_dialog=!1}}},[t._v("キャンセル")]),e(_t.Z,{attrs:{color:"error",text:""},on:{click:function(e){return t.deleteAccount()}}},[t._v("削除")])],1)],1)],1)],1):t._e()])])},Zs=[],$s=r["default"].extend({name:"Settings-Account",components:{Base:xs},data(){return{is_form_dense:Y.isSmartphoneHorizontal(),is_loading:!0,settings_username:null,settings_username_validation:t=>""===t||null===t?"ユーザー名を入力してください。":!1!==/^.{2,}$/.test(t)||"ユーザー名は2文字以上で入力してください。",settings_password:null,settings_password_showing:!0,settings_password_validation:t=>""===t||null===t?"パスワードを入力してください。":!1!==/^[a-zA-Z0-9!-/:-@¥[-`{-~]{4,}$/.test(t)||"パスワードは4文字以上の半角英数記号を入力してください。",settings_icon:null,account_delete_confirm_dialog:null,sync_settings:it().settings.sync_settings,sync_settings_dialog:!1}},computed:Object.assign({},(0,a.Kc)(it,nt)),async created(){await this.userStore.fetchUser(),this.is_loading=!1},watch:{async sync_settings(){if(!0===this.sync_settings&&!1===this.sync_settings_dialog){const t=this.settingsStore.getSyncableClientSettings(),e=JSON.stringify(t),s=await D.fetchClientSettings();if(null===s)return void this.$message.error("サーバーから設定データを取得できませんでした。");const i=JSON.stringify(s);e!==i?(this.sync_settings_dialog=!0,this.sync_settings=!1):this.settingsStore.settings.sync_settings=!0}else!1===this.sync_settings&&!1===this.sync_settings_dialog&&(this.settingsStore.settings.sync_settings=!1)}},methods:{async overrideServerSettingsFromClient(){await this.settingsStore.syncClientSettingsToServer(!0),this.settingsStore.settings.sync_settings=!0,this.sync_settings=!0,this.sync_settings_dialog=!1},async overrideClientSettingsFromServer(){await this.settingsStore.syncClientSettingsFromServer(!0),this.settingsStore.settings.sync_settings=!0,this.sync_settings=!0,this.sync_settings_dialog=!1},async updateAccountInfo(t){if("username"===t){if(!1===this.$refs.settings_username.validate())return}else if(!1===this.$refs.settings_password.validate())return;if("username"===t){if(null===this.settings_username)return;await this.userStore.updateUser({username:this.settings_username})}else{if(null===this.settings_password)return;await this.userStore.updateUser({password:this.settings_password})}},async updateAccountIcon(){null!==this.settings_icon?await this.userStore.updateUserIcon(this.settings_icon):this.$message.error("アップロードする画像を選択してください！")},async deleteAccount(){this.account_delete_confirm_dialog=!1,await this.userStore.deleteUser()}}}),zs=$s,As=(0,p.Z)(zs,Ps,Zs,!1,null,"8c544aee",null),Ds=As.exports,Bs=s(7414),Ks=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("Base",[e("h2",{staticClass:"settings__heading"},[e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"settings__back-button",attrs:{to:"/settings/"}},[e("Icon",{attrs:{icon:"fluent:arrow-left-12-filled",width:"25px"}})],1),e("Icon",{attrs:{icon:"bi:chat-left-text-fill",width:"19px"}}),e("span",{staticClass:"ml-3"},[t._v("ニコニコ実況")])],1),e("div",{staticClass:"settings__content",class:{"settings__content--loading":t.is_loading}},[null===t.userStore.user||null===t.userStore.user.niconico_user_id?e("div",{staticClass:"niconico-account niconico-account--anonymous"},[e("div",{staticClass:"niconico-account-wrapper"},[e("Icon",{staticClass:"flex-shrink-0",attrs:{icon:"bi:chat-left-text-fill",width:"45px"}}),e("div",{staticClass:"niconico-account__info ml-4"},[e("div",{staticClass:"niconico-account__info-name"},[e("span",{staticClass:"niconico-account__info-name-text"},[t._v("ニコニコアカウントと連携していません")])]),e("span",{staticClass:"niconico-account__info-description"},[t._v(" ニコニコアカウントと連携すると、テレビを見ながらニコニコ実況にコメントできるようになります。 ")])])],1),e(_t.Z,{staticClass:"niconico-account__login ml-auto",attrs:{color:"secondary",width:"130",height:"56",depressed:""},on:{click:function(e){return t.loginNiconicoAccount()}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:plug-connected-20-filled",height:"26"}}),t._v("連携する ")],1)],1):t._e(),null!==t.userStore.user&&null!==t.userStore.user.niconico_user_id?e("div",{staticClass:"niconico-account"},[e("div",{staticClass:"niconico-account-wrapper"},[e("img",{staticClass:"niconico-account__icon",attrs:{src:t.userStore.user_niconico_icon_url}}),e("div",{staticClass:"niconico-account__info"},[e("div",{staticClass:"niconico-account__info-name"},[e("span",{staticClass:"niconico-account__info-name-text"},[t._v(t._s(t.userStore.user.niconico_user_name)+" と連携しています")])]),e("span",{staticClass:"niconico-account__info-description"},[e("span",{staticClass:"mr-2",staticStyle:{"white-space":"nowrap"}},[t._v("Niconico User ID:")]),e("a",{staticClass:"mr-2",attrs:{href:`https://www.nicovideo.jp/user/${t.userStore.user.niconico_user_id}`,target:"_blank"}},[t._v(t._s(t.userStore.user.niconico_user_id))]),1==t.userStore.user.niconico_user_premium?e("span",{staticClass:"secondary--text"},[t._v("(Premium)")]):t._e()])])]),e(_t.Z,{staticClass:"niconico-account__login ml-auto",attrs:{color:"secondary",width:"130",height:"56",depressed:""},on:{click:function(e){return t.logoutNiconicoAccount()}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:plug-disconnected-20-filled",height:"26"}}),t._v("連携解除 ")],1)],1):t._e(),e("div",{staticClass:"settings__item mt-7"},[e("div",{staticClass:"settings__item-heading"},[t._v("コメントのミュート設定")]),e("div",{staticClass:"settings__item-label"},[t._v(" 表示したくないコメントを、映像上やコメントリストに表示しないようにミュートできます。"),e("br")])]),e(_t.Z,{staticClass:"settings__save-button mt-4",attrs:{depressed:""},on:{click:function(e){t.comment_mute_settings_modal=!t.comment_mute_settings_modal}}},[e("Icon",{attrs:{icon:"heroicons-solid:filter",height:"19px"}}),e("span",{staticClass:"ml-1"},[t._v("コメントのミュート設定を開く")])],1),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading"},[t._v("コメントの速さ")]),e("div",{staticClass:"settings__item-label"},[t._v(" プレイヤーに流れるコメントの速さを設定します。"),e("br"),t._v(" たとえば 1.2 に設定すると、コメントが 1.2 倍速く流れます。"),e("br")]),e(Bs.Z,{staticClass:"settings__item-form",attrs:{ticks:"always","thumb-label":"","hide-details":"",step:.1,min:.5,max:2},model:{value:t.settingsStore.settings.comment_speed_rate,callback:function(e){t.$set(t.settingsStore.settings,"comment_speed_rate",e)},expression:"settingsStore.settings.comment_speed_rate"}})],1),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading"},[t._v("コメントの文字サイズ")]),e("div",{staticClass:"settings__item-label"},[t._v(" プレイヤーに流れるコメントの文字サイズの基準値を設定します。"),e("br"),t._v(" 実際の文字サイズは画面サイズに合わせて調整されます。デフォルトの文字サイズは 34px です。"),e("br")]),e(Bs.Z,{staticClass:"settings__item-form",attrs:{ticks:"always","thumb-label":"","hide-details":"",min:20,max:60},model:{value:t.settingsStore.settings.comment_font_size,callback:function(e){t.$set(t.settingsStore.settings,"comment_font_size",e)},expression:"settingsStore.settings.comment_font_size"}})],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"close_comment_form_after_sending"}},[t._v("コメント送信後にコメント入力フォームを閉じる")]),e("label",{staticClass:"settings__item-label",attrs:{for:"close_comment_form_after_sending"}},[t._v(" この設定をオンにすると、コメントを送信した後に、コメント入力フォームが自動で閉じるようになります。"),e("br"),t._v(" コメント入力フォームが表示されたままだと、大半のショートカットキーが文字入力と競合して使えなくなります。とくに理由がなければ、オンにしておくのがおすすめです。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"close_comment_form_after_sending",inset:"","hide-details":""},model:{value:t.settingsStore.settings.close_comment_form_after_sending,callback:function(e){t.$set(t.settingsStore.settings,"close_comment_form_after_sending",e)},expression:"settingsStore.settings.close_comment_form_after_sending"}})],1)],1),e("CommentMuteSettings",{model:{value:t.comment_mute_settings_modal,callback:function(e){t.comment_mute_settings_modal=e},expression:"comment_mute_settings_modal"}})],1)},Ns=[];class Es{static async fetchAuthorizationURL(){const t=await Z.get("/niconico/auth");return"is_error"in t?(Z.showGenericError(t,"ニコニコアカウントとの連携用の認証 URL を取得できませんでした。"),null):t.data.authorization_url}static async logoutAccount(){const t=await Z["delete"]("/niconico/logout");return!("is_error"in t)||(Z.showGenericError(t,"ニコニコアカウントとの連携を解除できませんでした。"),!1)}}var Ls=Es,Hs=r["default"].extend({name:"Settings-Jikkyo",components:{Base:xs,CommentMuteSettings:Se},data(){return{comment_mute_settings_modal:!1,is_loading:!0}},computed:Object.assign({},(0,a.Kc)(it,nt)),async created(){if(await this.userStore.fetchUser(),this.is_loading=!1,""!==location.hash){const t=new URLSearchParams(location.hash.replace("#",""));if(null!==t.get("status")&&null!==t.get("detail")){const e=parseInt(t.get("status")),s=t.get("detail");this.onOAuthCallbackReceived(e,s),history.replaceState(null,""," ")}}},methods:{async loginNiconicoAccount(){if(!1===this.userStore.is_logged_in)return void this.$message.warning("連携をはじめるには、KonomiTV アカウントにログインしてください。");const t=await Ls.fetchAuthorizationURL();if(null===t)return;if(!0===Y.isMobileDevice())return void(location.href=t);const e=window.open(t,"KonomiTV-OAuthPopup",Y.getWindowFeatures());if(null===e)return void this.$message.error("ポップアップウインドウを開けませんでした。");const s=async t=>{if(e.closed)return;if("object"!==Y["typeof"](t.data))return;if("KonomiTV-OAuthPopup"in t.data===!1)return;e&&e.close(),window.removeEventListener("message",s);const i=t.data["KonomiTV-OAuthPopup"]["status"],a=t.data["KonomiTV-OAuthPopup"]["detail"];this.onOAuthCallbackReceived(i,a)};window.addEventListener("message",s)},async onOAuthCallbackReceived(t,e){if(console.log(`NiconicoAuthCallbackAPI: Status: ${t} / Detail: ${e}`),200===t)await this.userStore.fetchUser(!0),this.$message.success("ニコニコアカウントと連携しました。");else if(e.startsWith("Authorization was denied (access_denied)"))this.$message.error("ニコニコアカウントとの連携がキャンセルされました。");else if(e.startsWith("Failed to get access token (HTTP Error ")){const t=e.replace("Failed to get access token ","");this.$message.error(`アクセストークンの取得に失敗しました。${t}`)}else if(e.startsWith("Failed to get access token (Connection Timeout)"))this.$message.error("アクセストークンの取得に失敗しました。ニコニコで障害が発生している可能性があります。");else if(e.startsWith("Failed to get user information (HTTP Error ")){const t=e.replace("Failed to get user information ","");this.$message.error(`ニコニコアカウントのユーザー情報の取得に失敗しました。${t}`)}else e.startsWith("Failed to get user information (Connection Timeout)")?this.$message.error("ニコニコアカウントのユーザー情報の取得に失敗しました。ニコニコで障害が発生している可能性があります。"):this.$message.error(`ニコニコアカウントとの連携に失敗しました。(${e})`)},async logoutNiconicoAccount(){const t=await Ls.logoutAccount();!1!==t&&(await this.userStore.fetchUser(!0),this.$message.success("ニコニコアカウントとの連携を解除しました。"))}}}),Us=Hs,Vs=(0,p.Z)(Us,Ks,Ns,!1,null,"7175a344",null),Ms=Vs.exports,Rs=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("Base",[e("h2",{staticClass:"settings__heading"},[e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"settings__back-button",attrs:{to:"/settings/"}},[e("Icon",{attrs:{icon:"fluent:arrow-left-12-filled",width:"25px"}})],1),e("Icon",{attrs:{icon:"fa-brands:twitter",width:"22px"}}),e("span",{staticClass:"ml-3"},[t._v("Twitter")])],1),e("div",{staticClass:"settings__content",class:{"settings__content--loading":t.is_loading}},[e("div",{staticClass:"twitter-accounts"},[null!==t.userStore.user&&t.userStore.user.twitter_accounts.length>0?e("div",{staticClass:"twitter-accounts__heading"},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:person-board-20-filled",height:"30"}}),t._v("連携中のアカウント ")],1):t._e(),null===t.userStore.user||0===t.userStore.user.twitter_accounts.length?e("div",{staticClass:"twitter-accounts__guide"},[e("Icon",{staticClass:"flex-shrink-0",attrs:{icon:"fa-brands:twitter",width:"45px"}}),e("div",{staticClass:"ml-4"},[e("div",{staticClass:"font-weight-bold text-h6"},[t._v("Twitter アカウントと連携していません")]),e("div",{staticClass:"text--text text--darken-1 text-subtitle-2 mt-1"},[t._v(" Twitter アカウントと連携すると、テレビを見ながら Twitter にツイートしたり、ほかの実況ツイートをリアルタイムで表示できるようになります。 ")])])],1):t._e(),t._l(null!==t.userStore.user?t.userStore.user.twitter_accounts:[],(function(s){return e("div",{key:s.id,staticClass:"twitter-account"},[e("img",{staticClass:"twitter-account__icon",attrs:{src:s.icon_url}}),e("div",{staticClass:"twitter-account__info"},[e("div",{staticClass:"twitter-account__info-name"},[e("span",{staticClass:"twitter-account__info-name-text"},[t._v(t._s(s.name))])]),e("span",{staticClass:"twitter-account__info-screen-name"},[t._v("@"+t._s(s.screen_name))])]),e(_t.Z,{staticClass:"twitter-account__logout ml-auto",attrs:{width:"124",height:"52",depressed:""},on:{click:function(e){return t.logoutTwitterAccount(s.screen_name)}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:plug-disconnected-20-filled",height:"24"}}),t._v("連携解除 ")],1)],1)})),e(_t.Z,{staticClass:"twitter-account__login",attrs:{color:"secondary","max-width":"250",height:"50",depressed:""},on:{click:function(e){return t.loginTwitterAccount()}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:plug-connected-20-filled",height:"24"}}),t._v("連携するアカウントを追加 ")],1)],2),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"fold_panel_after_sending_tweet"}},[t._v("ツイート送信後にパネルを折りたたむ")]),e("label",{staticClass:"settings__item-label",attrs:{for:"fold_panel_after_sending_tweet"}},[t._v(" この設定をオンにすると、ツイートを送信した後に、パネルが自動で折りたたまれます。"),e("br"),t._v(" ツイートするとき以外はできるだけ映像を大きくして見たい方におすすめです。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"fold_panel_after_sending_tweet",inset:"","hide-details":""},model:{value:t.settingsStore.settings.fold_panel_after_sending_tweet,callback:function(e){t.$set(t.settingsStore.settings,"fold_panel_after_sending_tweet",e)},expression:"settingsStore.settings.fold_panel_after_sending_tweet"}})],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"reset_hashtag_when_program_switches"}},[t._v("番組が切り替わったときにハッシュタグフォームをリセットする")]),e("label",{staticClass:"settings__item-label",attrs:{for:"reset_hashtag_when_program_switches"}},[t._v(" チャンネルを切り替えたときや、視聴中の番組が終了し次の番組の放送が開始されたときに、ハッシュタグフォームをリセットするかを設定します。"),e("br"),t._v(" この設定をオンにしておけば、「誤って前番組のハッシュタグをつけたまま次番組の実況ツイートをしてしまう」といったミスを回避できます。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"reset_hashtag_when_program_switches",inset:"","hide-details":""},model:{value:t.settingsStore.settings.reset_hashtag_when_program_switches,callback:function(e){t.$set(t.settingsStore.settings,"reset_hashtag_when_program_switches",e)},expression:"settingsStore.settings.reset_hashtag_when_program_switches"}})],1),e("div",{staticClass:"settings__item settings__item--switch"},[e("label",{staticClass:"settings__item-heading",attrs:{for:"auto_add_watching_channel_hashtag"}},[t._v("視聴中のチャンネルに対応する局タグを自動で追加する")]),e("label",{staticClass:"settings__item-label",attrs:{for:"auto_add_watching_channel_hashtag"}},[t._v(" この設定をオンにすると、視聴中のチャンネルに対応する局タグ (#nhk, #tokyomx など) がハッシュタグフォームに自動で追加されます。"),e("br"),t._v(" 現時点で、局タグは三大首都圏の地上波・BS の一部チャンネル・AT-X にのみ対応しています。"),e("br")]),e(fe.Z,{staticClass:"settings__item-switch",attrs:{id:"auto_add_watching_channel_hashtag",inset:"","hide-details":""},model:{value:t.settingsStore.settings.auto_add_watching_channel_hashtag,callback:function(e){t.$set(t.settingsStore.settings,"auto_add_watching_channel_hashtag",e)},expression:"settingsStore.settings.auto_add_watching_channel_hashtag"}})],1),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading"},[t._v("デフォルトで表示される Twitter タブ内のタブ")]),e("div",{staticClass:"settings__item-label"},[t._v(" 視聴画面を開いたときに、パネルの Twitter タブの中で最初に表示されるタブを設定します。"),e("br")]),e(ve.Z,{staticClass:"settings__item-form",attrs:{outlined:"","hide-details":"",dense:t.is_form_dense,items:t.twitter_active_tab},model:{value:t.settingsStore.settings.twitter_active_tab,callback:function(e){t.$set(t.settingsStore.settings,"twitter_active_tab",e)},expression:"settingsStore.settings.twitter_active_tab"}})],1),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading"},[t._v("ツイートにつけるハッシュタグの位置")]),e("div",{staticClass:"settings__item-label"},[t._v(" ツイート本文から見て、ハッシュタグをどの位置につけてツイートするかを設定します。"),e("br")]),e(ve.Z,{staticClass:"settings__item-form",attrs:{outlined:"","hide-details":"",dense:t.is_form_dense,items:t.tweet_hashtag_position},model:{value:t.settingsStore.settings.tweet_hashtag_position,callback:function(e){t.$set(t.settingsStore.settings,"tweet_hashtag_position",e)},expression:"settingsStore.settings.tweet_hashtag_position"}})],1),e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading"},[t._v("ツイートするキャプチャに番組タイトルの透かしを描画する")]),e("div",{staticClass:"settings__item-label"},[t._v(" ツイートするキャプチャに、透かしとして視聴中の番組タイトルを描画するかを設定します。"),e("br"),t._v(" 透かしの描画位置は 左上・右上・左下・右下 から選択できます。"),e("br")]),e(ve.Z,{staticClass:"settings__item-form",attrs:{outlined:"","hide-details":"",dense:t.is_form_dense,items:t.tweet_capture_watermark_position},model:{value:t.settingsStore.settings.tweet_capture_watermark_position,callback:function(e){t.$set(t.settingsStore.settings,"tweet_capture_watermark_position",e)},expression:"settingsStore.settings.tweet_capture_watermark_position"}})],1)])])},Fs=[],Gs=r["default"].extend({name:"Settings-Twitter",components:{Base:xs},data(){return{is_form_dense:Y.isSmartphoneHorizontal(),twitter_active_tab:[{text:"ツイート検索タブ",value:"Search"},{text:"タイムラインタブ",value:"Timeline"},{text:"キャプチャタブ",value:"Capture"}],tweet_hashtag_position:[{text:"ツイート本文の前に追加する",value:"Prepend"},{text:"ツイート本文の後に追加する",value:"Append"},{text:"ツイート本文の前に追加してから改行する",value:"PrependWithLineBreak"},{text:"ツイート本文の後に改行してから追加する",value:"AppendWithLineBreak"}],tweet_capture_watermark_position:[{text:"透かしを描画しない",value:"None"},{text:"透かしをキャプチャの左上に描画する",value:"TopLeft"},{text:"透かしをキャプチャの右上に描画する",value:"TopRight"},{text:"透かしをキャプチャの左下に描画する",value:"BottomLeft"},{text:"透かしをキャプチャの右下に描画する",value:"BottomRight"}],is_loading:!0}},computed:Object.assign({},(0,a.Kc)(it,nt)),async created(){if(await this.userStore.fetchUser(),this.is_loading=!1,""!==location.hash){const t=new URLSearchParams(location.hash.replace("#",""));if(null!==t.get("status")&&null!==t.get("detail")){const e=parseInt(t.get("status")),s=t.get("detail");this.onOAuthCallbackReceived(e,s),history.replaceState(null,""," ")}}},methods:{async loginTwitterAccount(){if(!1===this.userStore.is_logged_in)return void this.$message.warning("連携をはじめるには、KonomiTV アカウントにログインしてください。");const t=await Ve.fetchAuthorizationURL();if(null===t)return;if(!0===Y.isMobileDevice())return void(location.href=t);const e=window.open(t,"KonomiTV-OAuthPopup",Y.getWindowFeatures());if(null===e)return void this.$message.error("ポップアップウインドウを開けませんでした。");const s=async t=>{if(e.closed)return;if("object"!==Y["typeof"](t.data))return;if("KonomiTV-OAuthPopup"in t.data===!1)return;e&&e.close(),window.removeEventListener("message",s);const i=t.data["KonomiTV-OAuthPopup"]["status"],a=t.data["KonomiTV-OAuthPopup"]["detail"];this.onOAuthCallbackReceived(i,a)};window.addEventListener("message",s)},async onOAuthCallbackReceived(t,e){if(console.log(`TwitterAuthCallbackAPI: Status: ${t} / Detail: ${e}`),200!==t)return void(e.startsWith("Authorization was denied by user")?this.$message.error("Twitter アカウントとの連携がキャンセルされました。"):e.startsWith("Failed to get access token")?this.$message.error("アクセストークンの取得に失敗しました。"):e.startsWith("Failed to get user information")?this.$message.error("Twitter アカウントのユーザー情報の取得に失敗しました。"):this.$message.error(`Twitter アカウントとの連携に失敗しました。(${e})`));if(await this.userStore.fetchUser(!0),null===this.userStore.user)return void this.$message.error("アカウント情報を取得できませんでした。");const s=[...this.userStore.user.twitter_accounts].sort(((t,e)=>t.updated_at<e.updated_at?1:t.updated_at>e.updated_at?-1:0))[0];this.$message.success(`Twitter @${s.screen_name} と連携しました。`)},async logoutTwitterAccount(t){const e=await Ve.logoutAccount(t);!1!==e&&(await this.userStore.fetchUser(!0),this.$message.success(`Twitter @${t} との連携を解除しました。`))}}}),qs=Gs,Ws=(0,p.Z)(qs,Rs,Fs,!1,null,"a887f710",null),Ys=Ws.exports,Xs=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("Base",[e("h2",{staticClass:"settings__heading"},[e("router-link",{directives:[{def:gt.Z,name:"ripple",rawName:"v-ripple"}],staticClass:"settings__back-button",attrs:{to:"/settings/"}},[e("Icon",{attrs:{icon:"fluent:arrow-left-12-filled",width:"25px"}})],1),e("Icon",{attrs:{icon:"fluent:toolbox-20-filled",width:"22px"}}),e("span",{staticClass:"ml-3"},[t._v("環境設定")])],1),e("div",{staticClass:"settings__content"},[e("div",{staticClass:"settings__item"},[e("div",{staticClass:"settings__item-heading"},[t._v("鋭意開発中…")])])])])},Js=[],Qs=r["default"].extend({name:"Settings-Environment",components:{Base:xs}}),ti=Qs,ei=(0,p.Z)(ti,Xs,Js,!1,null,null,null),si=ei.exports,ii=s(5495),ai=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"route-container"},[e("Header"),e("main",[e("Navigation"),e("div",{staticClass:"login-container-wrapper d-flex align-center w-100 mb-13"},[e(qt.Z,{staticClass:"login-container px-10 pt-8 pb-11 mx-auto background lighten-1",attrs:{elevation:"10",width:"100%","max-width":"450"}},[e(Wt.EB,{staticClass:"login__logo flex-column justify-center"},[e(ii.Z,{attrs:{"max-width":"250",src:"/assets/images/logo.svg"}}),e("h4",{staticClass:"mt-10"},[t._v("ログイン")])],1),e(ps.Z),e(Is.Z,{ref:"login",on:{submit:function(t){t.preventDefault()}}},[e(we.Z,{staticClass:"mt-12",attrs:{outlined:"",placeholder:"ユーザー名","hide-details":"",autofocus:"",dense:t.is_form_dense},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),e(we.Z,{staticClass:"mt-8",attrs:{outlined:"",placeholder:"パスワード","hide-details":"",dense:t.is_form_dense,type:t.password_showing?"text":"password","append-icon":t.password_showing?"mdi-eye":"mdi-eye-off"},on:{"click:append":function(e){t.password_showing=!t.password_showing}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),e(_t.Z,{staticClass:"login-button mt-5",attrs:{color:"secondary",depressed:"",width:"100%",height:"56"},on:{click:function(e){return t.login()}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fa:sign-in"}}),t._v("ログイン ")],1)],1)],1)],1)],1)],1)},ni=[],ri=r["default"].extend({name:"Login",components:{Header:kt,Navigation:Kt},data(){return{is_form_dense:Y.isSmartphoneHorizontal(),username:"",password:"",password_showing:!1}},computed:Object.assign({},(0,a.Kc)(nt)),methods:{async login(){if(""===this.username||""===this.password)return void this.$message.error("ユーザー名またはパスワードが空です。");const t=await this.userStore.login(this.username,this.password);!1!==t&&await this.$router.replace({path:"/settings/account"})}}}),oi=ri,li=(0,p.Z)(oi,ai,ni,!1,null,"0e510f6a",null),ci=li.exports,_i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"route-container"},[e("Header"),e("main",[e("Navigation"),e("div",{staticClass:"register-container-wrapper d-flex align-center w-100 mb-13"},[e(qt.Z,{staticClass:"register-container px-10 pt-8 pb-11 mx-auto background lighten-1",attrs:{elevation:"10",width:"100%","max-width":"450"}},[e(Wt.EB,{staticClass:"register__logo flex-column justify-center"},[e(ii.Z,{attrs:{"max-width":"250",src:"/assets/images/logo.svg"}}),e("h4",{staticClass:"mt-10"},[t._v("アカウントを作成")])],1),e(ps.Z),e(Is.Z,{ref:"register",on:{submit:function(t){t.preventDefault()}}},[e(we.Z,{staticClass:"mt-12",attrs:{outlined:"",placeholder:"ユーザー名",autofocus:"",dense:t.is_form_dense,rules:[t.username_validation]},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),e(we.Z,{staticStyle:{"margin-top":"2px"},attrs:{outlined:"",placeholder:"パスワード",dense:t.is_form_dense,type:t.password_showing?"text":"password","append-icon":t.password_showing?"mdi-eye":"mdi-eye-off",rules:[t.password_validation]},on:{"click:append":function(e){t.password_showing=!t.password_showing}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),e(_t.Z,{staticClass:"register-button mt-5",attrs:{color:"secondary",depressed:"",width:"100%",height:"56"},on:{click:function(e){return t.register()}}},[e("Icon",{staticClass:"mr-2",attrs:{icon:"fluent:person-add-20-filled",height:"24"}}),t._v("アカウントを作成 ")],1)],1)],1)],1)],1)],1)},di=[],ui=r["default"].extend({name:"Register",components:{Header:kt,Navigation:Kt},data(){return{is_form_dense:Y.isSmartphoneHorizontal(),username:null,username_validation:t=>""===t||null===t?"ユーザー名を入力してください。":!1!==/^.{2,}$/.test(t)||"ユーザー名は2文字以上で入力してください。",password:null,password_showing:!0,password_validation:t=>""===t||null===t?"パスワードを入力してください。":!1!==/^[a-zA-Z0-9!-/:-@¥[-`{-~]{4,}$/.test(t)||"パスワードは4文字以上の半角英数記号を入力してください。"}},computed:Object.assign({},(0,a.Kc)(nt)),methods:{async register(){if(!1===this.$refs.register.validate())return;if(null===this.username||null===this.password)return;const t=await this.userStore.register(this.username,this.password);!1!==t&&(this.$message.success("アカウントを作成しました。"),await this.$router.replace({path:"/settings/account"}))}}}),mi=ui,hi=(0,p.Z)(mi,_i,di,!1,null,"7fcaaa8e",null),pi=hi.exports,gi=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"route-container"},[e("Header"),e("main",[e("Navigation"),t._m(0)],1)],1)},vi=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"d-flex justify-center align-center w-100"},[e("div",{staticClass:"d-flex justify-center align-center flex-column"},[e("h1",[t._v("Not Found, or Under Development...")]),e("span",{staticClass:"mt-4 text--text text--darken-1"},[t._v("お探しのページは存在しないか、鋭意開発中です。")])])])}],fi=r["default"].extend({name:"NotFound",components:{Header:kt,Navigation:Kt}}),wi=fi,yi=(0,p.Z)(wi,gi,vi,!1,null,"1310cfee",null),bi=yi.exports;r["default"].use(mt.ZP);const Ci=new mt.ZP({mode:"history",base:"/",routes:[{path:"/",redirect:"/tv/"},{path:"/tv/",name:"TV Home",component:Gt},{path:"/tv/watch/:channel_id",name:"TV Watch",component:ns},{path:"/settings/",name:"Settings Index",component:ms,beforeEnter:(t,e,s)=>{Y.isSmartphoneVertical()||Y.isSmartphoneHorizontal()||Y.isTabletVertical()?s():s({path:"/settings/general/"})}},{path:"/settings/general",name:"Settings General",component:js},{path:"/settings/account",name:"Settings Account",component:Ds},{path:"/settings/jikkyo",name:"Settings Jikkyo",component:Ms},{path:"/settings/twitter",name:"Settings Twitter",component:Ys},{path:"/settings/environment",name:"Settings Environment",component:si},{path:"/login/",name:"Login",component:ci},{path:"/register/",name:"Register",component:pi},{path:"*",name:"NotFound",component:bi}],scrollBehavior(t,e,s){return s||{x:0,y:0}}});var ki=Ci,xi=s(5205);(0,xi.z)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}}),(0,n.OK)(),r["default"].config.productionTip=!1,r["default"].config.devtools=!0,r["default"].use(o.Z,ot),r["default"].use(a.og);const Si=(0,a.WB)();r["default"].use(l.ZP),r["default"].use(_(),{top:!1,bottom:!0,color:"#433532",dark:!0,elevation:8,timeout:2500,autoRemove:!0,closeButtonContent:"閉じる",vuetifyInstance:ut});const Oi=Y.isTouchDevice()?[]:["hover","focus","touch"];d.ZP.options.themes.tooltip.showTriggers=Oi,d.ZP.options.themes.tooltip.hideTriggers=Oi,d.ZP.options.themes.tooltip.delay.show=0,d.ZP.options.offset=[0,7],r["default"].use(d.ZP),r["default"].component("Icon",i.JO),r["default"].component("v-tab-item-fix",y),r["default"].component("v-tabs-fix",S),r["default"].component("v-tabs-items-fix",T),window.KonomiTVVueInstance=new r["default"]({pinia:Si,router:ki,vuetify:ut,render:t=>t(f)}).$mount("#app");let Ti=!1;const ji=it();ji.$subscribe((async()=>{!0!==Ti&&(console.log("Client Settings Changed:",ji.settings),tt(ji.settings),await ji.syncClientSettingsToServer())}),{detached:!0}),window.setInterval((async()=>{null!==Y.getAccessToken()&&!0===ji.settings.sync_settings&&(Ti=!0,await ji.syncClientSettingsFromServer(),Ti=!1,tt(ji.settings))}),3e3)}},e={};function s(i){var a=e[i];if(void 0!==a)return a.exports;var n=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=t,function(){s.amdO={}}(),function(){var t=[];s.O=function(e,i,a,n){if(!i){var r=1/0;for(_=0;_<t.length;_++){i=t[_][0],a=t[_][1],n=t[_][2];for(var o=!0,l=0;l<i.length;l++)(!1&n||r>=n)&&Object.keys(s.O).every((function(t){return s.O[t](i[l])}))?i.splice(l--,1):(o=!1,n<r&&(r=n));if(o){t.splice(_--,1);var c=a();void 0!==c&&(e=c)}}return e}n=n||0;for(var _=t.length;_>0&&t[_-1][2]>n;_--)t[_]=t[_-1];t[_]=[i,a,n]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,i){var a,n,r=i[0],o=i[1],l=i[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(a in o)s.o(o,a)&&(s.m[a]=o[a]);if(l)var _=l(s)}for(e&&e(i);c<r.length;c++)n=r[c],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(_)},i=self["webpackChunkKonomiTV"]=self["webpackChunkKonomiTV"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998],(function(){return s(6960)}));i=s.O(i)})();
//# sourceMappingURL=app.82f6554a.js.map